
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Creating a basic Cluster Expansion &#8212; smol 0.0.0 documentation</title>
    
    <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/smol.css" />
    
    <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/banner.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../getting_started.html">
  Getting Started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../user_guide/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../api_reference/index.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../citing.html">
  Citing
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../developer_guide/index.html">
  Developing
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/CederGroupHub/smol/blob/master/CHANGES.md">Changes<i class="fas fa-external-link-alt"></i></a>
    </li>
    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/CederGroupHub/smol/issues">Issues<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        0.0.0  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables notebooks/advanced-cluster-expansion-fitting/create_LMTO_CE and {'json_url': 'https://pydata-sphinx-theme.readthedocs.io/en/latest/_static/switcher.json', 'url_template': 'https://pydata-sphinx-theme.readthedocs.io/en/v{version}/', 'version_match': '0.0.0'}.
-->

<script type="text/javascript">
// Construct the target URL from the JSON components
function buildURL(entry) {
    var template = "https://pydata-sphinx-theme.readthedocs.io/en/v{version}/";  // supplied by jinja
    template = template.replace("{version}", entry.version);
    return template;
}

// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "notebooks/advanced-cluster-expansion-fitting/create_LMTO_CE.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("https://pydata-sphinx-theme.readthedocs.io/en/latest/_static/switcher.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "notebooks/advanced-cluster-expansion-fitting/create_LMTO_CE.html";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            // get the base URL for that doc version, add the current page's
            // path to it, and set as `href`
            entry.url = buildURL(entry);
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's 0.0.0 variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "0.0.0") {
                node.classList.add("active");
                $("#version_switcher_button").text(entry.name);
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/CederGroupHub/smol" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#0)-The-prim-structure">
   0) The prim structure
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#1)-Create-a-cluster-subspace">
   1) Create a cluster subspace
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#1.1)-Computing-a-correlation-vector.">
     1.1) Computing a correlation vector.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#2)-Create-a-structure-wrangler">
   2) Create a structure wrangler
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#3.1)-Check-the-quality-of-the-fit">
     3.1) Check the quality of the fit
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#4)-Create-a-cluster-expansion">
   4) Create a cluster expansion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#5)-Saving-your-work">
   5) Saving your work
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#5.1)-Loading-previously-saved-work">
     5.1) Loading previously saved work
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/CederGroupHub/smol/edit/master/docs/notebooks/advanced-cluster-expansion-fitting/create_LMTO_CE.ipynb">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Creating-a-basic-Cluster-Expansion">
<h1>Creating a basic Cluster Expansion<a class="headerlink" href="#Creating-a-basic-Cluster-Expansion" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">monty.serialization</span> <span class="kn">import</span> <span class="n">loadfn</span>
<span class="kn">from</span> <span class="nn">smol.cofe</span> <span class="kn">import</span> <span class="n">ClusterSubspace</span><span class="p">,</span> <span class="n">StructureWrangler</span><span class="p">,</span> \
    <span class="n">ClusterExpansion</span><span class="p">,</span> <span class="n">RegressionData</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">prim</span> <span class="o">=</span> <span class="n">loadfn</span><span class="p">(</span><span class="s1">&#39;../data/lmto_prim.json&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Loading the DFT data of Li-Mn-Ti-O system</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">computed_entries</span> <span class="o">=</span> <span class="n">loadfn</span><span class="p">(</span><span class="s1">&#39;../data/lmto_entries.json&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">computed_entries</span><span class="p">)</span><span class="si">}</span><span class="s2"> structures in dataset.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
630 structures in dataset.
</pre></div></div>
</div>
<section id="0)-The-prim-structure">
<h2>0) The prim structure<a class="headerlink" href="#0)-The-prim-structure" title="Permalink to this headline">¶</a></h2>
<p>Active sites have fractional compositions. Vacancies are allowed in sites where the composition does not sum to one.</p>
<ol class="arabic simple" start="0">
<li><p>Is active. The allowed species are: Li+, Ti4+ and Mn3+.</p></li>
<li><p>Is not active. Only O2- is allowed.</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">prim</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Full Formula (Li0.33333333 Ti0.33333333 Mn0.33333333 O1)
Reduced Formula: Li0.33333333Ti0.33333333Mn0.33333333O1
abc   :   2.969848   2.969848   2.969848
angles:  60.000000  60.000000  60.000000
Sites (2)
  #  SP                                   a    b    c
---  ---------------------------------  ---  ---  ---
  0  Li+:0.333, Ti4+:0.333, Mn3+:0.333  0    0    0
  1  O2-                                0.5  0.5  0.5
</pre></div></div>
</div>
</section>
<section id="1)-Create-a-cluster-subspace">
<h2>1) Create a cluster subspace<a class="headerlink" href="#1)-Create-a-cluster-subspace" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">ClusterSubspace</span></code> represents all the orbits (groups of equivalent clusters) that will be considered when fitting the cluster expansion. Its main purpose is to compute the <strong>correlations functions</strong> for each included orbit given a structure in the compositional space defined by the prim.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">subspace</span> <span class="o">=</span> <span class="n">ClusterSubspace</span><span class="o">.</span><span class="n">from_cutoffs</span><span class="p">(</span><span class="n">prim</span><span class="p">,</span>
                                        <span class="n">cutoffs</span><span class="o">=</span><span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mf">7.1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
                                        <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sinusoid&#39;</span><span class="p">,</span>
                                        <span class="n">supercell_size</span><span class="o">=</span><span class="s1">&#39;volume&#39;</span><span class="p">)</span>
<span class="c1"># subspace.add_external_term(EwaldTerm(eta=None))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">subspace</span><span class="p">)</span> <span class="c1"># single site and empty orbits are always included.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ClusterBasis: [Prim Composition] Li+0.33333333 Mn3+0.33333333 Ti4+0.33333333 O2-1
    [Size] 0
      [Orbit] id: 0  orderings: 1
    [Size] 1
      [Orbit] id: 1  orderings: 2   multiplicity: 1    no. symops: 48
              [Base Cluster] Radius: 0.0   Centroid: [0. 0. 0.]         Points: [[0. 0. 0.]]
    [Size] 2
      [Orbit] id: 2  orderings: 3   multiplicity: 6    no. symops: 8
              [Base Cluster] Radius: 1.48  Centroid: [0.  0.  0.5]      Points: [[0. 0. 1.]  [0. 0. 0.]]
      [Orbit] id: 3  orderings: 3   multiplicity: 3    no. symops: 16
              [Base Cluster] Radius: 2.1   Centroid: [0.5 0.5 0.5]      Points: [[1. 1. 0.]  [0. 0. 1.]]
      [Orbit] id: 4  orderings: 3   multiplicity: 12   no. symops: 4
              [Base Cluster] Radius: 2.57  Centroid: [0.  0.5 0.5]      Points: [[0. 1. 1.]  [0. 0. 0.]]
      [Orbit] id: 5  orderings: 3   multiplicity: 6    no. symops: 8
              [Base Cluster] Radius: 2.97  Centroid: [0. 0. 0.]         Points: [[ 0.  0.  1.]  [ 0.  0. -1.]]
      [Orbit] id: 6  orderings: 3   multiplicity: 12   no. symops: 4
              [Base Cluster] Radius: 3.32  Centroid: [0.5 0.  0.5]      Points: [[ 1.  1.  0.]  [ 0. -1.  1.]]
    [Size] 3
      [Orbit] id: 7  orderings: 4   multiplicity: 8    no. symops: 6
              [Base Cluster] Radius: 1.48  Centroid: [0.   0.67 0.67]   Points: [[0. 1. 1.]  [0. 1. 0.]  [0. 0. 1.]]
    [Size] 4
      [Orbit] id: 8  orderings: 5   multiplicity: 2    no. symops: 24
              [Base Cluster] Radius: 1.48  Centroid: [0.75 0.75 0.75]   Points: [[1. 1. 1.]  [1. 1. 0.]  [1. 0. 1.]  [0. 1. 1.]]

</pre></div></div>
</div>
<section id="1.1)-Computing-a-correlation-vector.">
<h3>1.1) Computing a correlation vector.<a class="headerlink" href="#1.1)-Computing-a-correlation-vector." title="Permalink to this headline">¶</a></h3>
<p>A correlation vector for a specific structure (represents the feature vector) used to train and predict target values.</p>
</section>
</section>
<section id="2)-Create-a-structure-wrangler">
<h2>2) Create a structure wrangler<a class="headerlink" href="#2)-Create-a-structure-wrangler" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">StructureWrangler</span></code> is a class that will is used to create and organize the data that will be used to train (and possibly test) the cluster expansion. It makes sure that all the supplied structures appropriately match the prim structure, and obtains the necessary information to correctly normalize target properties (such as energy) necessary for training.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wrangler</span> <span class="o">=</span> <span class="n">StructureWrangler</span><span class="p">(</span><span class="n">subspace</span><span class="p">)</span>

<span class="c1"># you can add any number of properties and name them</span>
<span class="c1"># whatever you want. You should use something descriptive.</span>
<span class="c1"># In this case we&#39;ll call it &#39;total_energy&#39;.</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">computed_entries</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;processed: </span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">computed_entries</span><span class="p">)))</span>
    <span class="n">wrangler</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span>
                      <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;total_energy&#39;</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">energy</span><span class="p">},</span>
                      <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># The verbose flag will print structures that fail to match.</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Total structures that match </span><span class="si">{</span><span class="n">wrangler</span><span class="o">.</span><span class="n">num_structures</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">computed_entries</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 0/630
processed: 1/630
processed: 2/630
processed: 3/630
processed: 4/630
processed: 5/630
processed: 6/630
processed: 7/630
processed: 8/630
processed: 9/630
processed: 10/630
processed: 11/630
processed: 12/630
processed: 13/630
processed: 14/630
processed: 15/630
processed: 16/630
processed: 17/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 13 - Li+16 Mn3+16 O2-32{&#39;total_energy&#39;: -422.52336463}
Index 16 - Mn3+6 Li+6 O2-12{&#39;total_energy&#39;: -157.651775}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 18/630
processed: 19/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 13 - Li+16 Mn3+16 O2-32{&#39;total_energy&#39;: -422.52336463}
Index 16 - Mn3+6 Li+6 O2-12{&#39;total_energy&#39;: -157.651775}
Index 19 - Mn3+6 Li+6 O2-12{&#39;total_energy&#39;: -157.61200258}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 20/630
processed: 21/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 13 - Li+16 Mn3+16 O2-32{&#39;total_energy&#39;: -422.52336463}
Index 16 - Mn3+6 Li+6 O2-12{&#39;total_energy&#39;: -157.651775}
Index 19 - Mn3+6 Li+6 O2-12{&#39;total_energy&#39;: -157.61200258}
Index 21 - Mn3+6 Li+6 O2-12{&#39;total_energy&#39;: -157.86858139999998}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 22/630
processed: 23/630
processed: 24/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 13 - Li+16 Mn3+16 O2-32{&#39;total_energy&#39;: -422.52336463}
Index 16 - Mn3+6 Li+6 O2-12{&#39;total_energy&#39;: -157.651775}
Index 19 - Mn3+6 Li+6 O2-12{&#39;total_energy&#39;: -157.61200258}
Index 21 - Mn3+6 Li+6 O2-12{&#39;total_energy&#39;: -157.86858139999998}
Index 23 - Mn3+6 Li+6 O2-12{&#39;total_energy&#39;: -157.88582681999998}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 25/630
processed: 26/630
processed: 27/630
processed: 28/630
processed: 29/630
processed: 30/630
processed: 31/630
processed: 32/630
processed: 33/630
processed: 34/630
processed: 35/630
processed: 36/630
processed: 37/630
processed: 38/630
processed: 39/630
processed: 40/630
processed: 41/630
processed: 42/630
processed: 43/630
processed: 44/630
processed: 45/630
processed: 46/630
processed: 47/630
processed: 48/630
processed: 49/630
processed: 50/630
processed: 51/630
processed: 52/630
processed: 53/630
processed: 54/630
processed: 55/630
processed: 56/630
processed: 57/630
processed: 58/630
processed: 59/630
processed: 60/630
processed: 61/630
processed: 62/630
processed: 63/630
processed: 64/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 43 - Li+4 Mn3+4 O2-8{&#39;total_energy&#39;: -104.09167402}
Index 60 - Mn3+4 Li+4 O2-8{&#39;total_energy&#39;: -104.11239212999999}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 65/630
processed: 66/630
processed: 67/630
processed: 68/630
processed: 69/630
processed: 70/630
processed: 71/630
processed: 72/630
processed: 73/630
processed: 74/630
processed: 75/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 53 - Mn3+4 Li+4 O2-8{&#39;total_energy&#39;: -104.93106644999999}
Index 65 - Li+4 Mn3+4 O2-8{&#39;total_energy&#39;: -105.05485193}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 51 - Mn3+4 Li+4 O2-8{&#39;total_energy&#39;: -103.79666542}
Index 72 - Li+4 Mn3+4 O2-8{&#39;total_energy&#39;: -103.27479317999999}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 61 - Li+4 Mn3+4 O2-8{&#39;total_energy&#39;: -104.07207165999999}
Index 74 - Li+4 Mn3+4 O2-8{&#39;total_energy&#39;: -104.0335375}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 76/630
processed: 77/630
processed: 78/630
processed: 79/630
processed: 80/630
processed: 81/630
processed: 82/630
processed: 83/630
processed: 84/630
processed: 85/630
processed: 86/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 66 - Mn3+4 Li+4 O2-8{&#39;total_energy&#39;: -104.90261661}
Index 81 - Mn3+4 Li+4 O2-8{&#39;total_energy&#39;: -104.76946991}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 76 - Li+4 Mn3+4 O2-8{&#39;total_energy&#39;: -104.39110529}
Index 83 - Mn3+4 Li+4 O2-8{&#39;total_energy&#39;: -104.45155711}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 85 - Mn3+3 Li+3 O2-6{&#39;total_energy&#39;: -78.95606344}
Index 86 - Li+3 Mn3+3 O2-6{&#39;total_energy&#39;: -79.08766976999999}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 48 - Mn3+4 Li+4 O2-8{&#39;total_energy&#39;: -104.93574505999999}
Index 92 - Li+2 Mn3+2 O2-4{&#39;total_energy&#39;: -52.29711425}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 87/630
processed: 88/630
processed: 89/630
processed: 90/630
processed: 91/630
processed: 92/630
processed: 93/630
processed: 94/630
processed: 95/630
processed: 96/630
processed: 97/630
processed: 98/630
processed: 99/630
processed: 100/630
processed: 101/630
processed: 102/630
processed: 103/630
processed: 104/630
processed: 105/630
processed: 106/630
processed: 107/630
processed: 108/630
processed: 109/630
processed: 110/630
processed: 111/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 13 - Li+16 Mn3+16 O2-32{&#39;total_energy&#39;: -422.52336463}
Index 16 - Mn3+6 Li+6 O2-12{&#39;total_energy&#39;: -157.651775}
Index 19 - Mn3+6 Li+6 O2-12{&#39;total_energy&#39;: -157.61200258}
Index 21 - Mn3+6 Li+6 O2-12{&#39;total_energy&#39;: -157.86858139999998}
Index 23 - Mn3+6 Li+6 O2-12{&#39;total_energy&#39;: -157.88582681999998}
Index 108 - Li+4 Mn3+4 O2-8{&#39;total_energy&#39;: -105.63097}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 85 - Mn3+3 Li+3 O2-6{&#39;total_energy&#39;: -78.95606344}
Index 86 - Li+3 Mn3+3 O2-6{&#39;total_energy&#39;: -79.08766976999999}
Index 109 - Li+18 Mn3+18 O2-36{&#39;total_energy&#39;: -473.68233}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 112/630
processed: 113/630
processed: 114/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 85 - Mn3+3 Li+3 O2-6{&#39;total_energy&#39;: -78.95606344}
Index 86 - Li+3 Mn3+3 O2-6{&#39;total_energy&#39;: -79.08766976999999}
Index 109 - Li+18 Mn3+18 O2-36{&#39;total_energy&#39;: -473.68233}
Index 112 - Li+18 Mn3+18 O2-36{&#39;total_energy&#39;: -474.24243}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 85 - Mn3+3 Li+3 O2-6{&#39;total_energy&#39;: -78.95606344}
Index 86 - Li+3 Mn3+3 O2-6{&#39;total_energy&#39;: -79.08766976999999}
Index 109 - Li+18 Mn3+18 O2-36{&#39;total_energy&#39;: -473.68233}
Index 112 - Li+18 Mn3+18 O2-36{&#39;total_energy&#39;: -474.24243}
Index 115 - Mn3+18 Li+18 O2-36{&#39;total_energy&#39;: -473.80347}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 115/630
processed: 116/630
processed: 117/630
processed: 118/630
processed: 119/630
processed: 120/630
processed: 121/630
processed: 122/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 85 - Mn3+3 Li+3 O2-6{&#39;total_energy&#39;: -78.95606344}
Index 86 - Li+3 Mn3+3 O2-6{&#39;total_energy&#39;: -79.08766976999999}
Index 109 - Li+18 Mn3+18 O2-36{&#39;total_energy&#39;: -473.68233}
Index 112 - Li+18 Mn3+18 O2-36{&#39;total_energy&#39;: -474.24243}
Index 115 - Mn3+18 Li+18 O2-36{&#39;total_energy&#39;: -473.80347}
Index 120 - Mn3+18 Li+18 O2-36{&#39;total_energy&#39;: -473.90453}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 123/630
processed: 124/630
processed: 125/630
processed: 126/630
processed: 127/630
processed: 128/630
processed: 129/630
processed: 130/630
processed: 131/630
processed: 132/630
processed: 133/630
processed: 134/630
processed: 135/630
processed: 136/630
processed: 137/630
processed: 138/630
processed: 139/630
processed: 140/630
processed: 141/630
processed: 142/630
processed: 143/630
processed: 144/630
processed: 145/630
processed: 146/630
processed: 147/630
processed: 148/630
processed: 149/630
processed: 150/630
processed: 151/630
processed: 152/630
processed: 153/630
processed: 154/630
processed: 155/630
processed: 156/630
processed: 157/630
processed: 158/630
processed: 159/630
processed: 160/630
processed: 161/630
processed: 162/630
processed: 163/630
processed: 164/630
processed: 165/630
processed: 166/630
processed: 167/630
processed: 168/630
processed: 169/630
processed: 170/630
processed: 171/630
processed: 172/630
processed: 173/630
processed: 174/630
processed: 175/630
processed: 176/630
processed: 177/630
processed: 178/630
processed: 179/630
processed: 180/630
processed: 181/630
processed: 182/630
processed: 183/630
processed: 184/630
processed: 185/630
processed: 186/630
processed: 187/630
processed: 188/630
processed: 189/630
processed: 190/630
processed: 191/630
processed: 192/630
processed: 193/630
processed: 194/630
processed: 195/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 96 - Li+18 Ti4+9 O2-27{&#39;total_energy&#39;: -377.54954127}
Index 194 - Li+24 Ti4+12 O2-36{&#39;total_energy&#39;: -503.42615}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 195 - Li+24 Ti4+12 O2-36{&#39;total_energy&#39;: -504.6361}
Index 198 - Li+4 Ti4+2 O2-6{&#39;total_energy&#39;: -84.105641}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 196/630
processed: 197/630
processed: 198/630
processed: 199/630
processed: 200/630
processed: 201/630
processed: 202/630
processed: 203/630
processed: 204/630
processed: 205/630
processed: 206/630
processed: 207/630
processed: 208/630
processed: 209/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 96 - Li+18 Ti4+9 O2-27{&#39;total_energy&#39;: -377.54954127}
Index 194 - Li+24 Ti4+12 O2-36{&#39;total_energy&#39;: -503.42615}
Index 203 - Li+2 Ti4+1 O2-3{&#39;total_energy&#39;: -41.919018}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 96 - Li+18 Ti4+9 O2-27{&#39;total_energy&#39;: -377.54954127}
Index 194 - Li+24 Ti4+12 O2-36{&#39;total_energy&#39;: -503.42615}
Index 203 - Li+2 Ti4+1 O2-3{&#39;total_energy&#39;: -41.919018}
Index 205 - Li+6 Ti4+3 O2-9{&#39;total_energy&#39;: -125.91502}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 210/630
processed: 211/630
processed: 212/630
processed: 213/630
processed: 214/630
processed: 215/630
processed: 216/630
processed: 217/630
processed: 218/630
processed: 219/630
processed: 220/630
processed: 221/630
processed: 222/630
processed: 223/630
processed: 224/630
processed: 225/630
processed: 226/630
processed: 227/630
processed: 228/630
processed: 229/630
processed: 230/630
processed: 231/630
processed: 232/630
processed: 233/630
processed: 234/630
processed: 235/630
processed: 236/630
processed: 237/630
processed: 238/630
processed: 239/630
processed: 240/630
processed: 241/630
processed: 242/630
processed: 243/630
processed: 244/630
processed: 245/630
processed: 246/630
processed: 247/630
processed: 248/630
processed: 249/630
processed: 250/630
processed: 251/630
processed: 252/630
processed: 253/630
processed: 254/630
processed: 255/630
processed: 256/630
processed: 257/630
processed: 258/630
processed: 259/630
processed: 260/630
processed: 261/630
processed: 262/630
processed: 263/630
processed: 264/630
processed: 265/630
processed: 266/630
processed: 267/630
processed: 268/630
processed: 269/630
processed: 270/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 266 - Mn3+15 Li+19 Ti4+2 O2-36{&#39;total_energy&#39;: -478.20534}
Index 267 - Mn3+15 Li+19 Ti4+2 O2-36{&#39;total_energy&#39;: -478.14156}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 268 - Li+19 Mn3+15 Ti4+2 O2-36{&#39;total_energy&#39;: -478.19176}
Index 269 - Li+19 Ti4+2 Mn3+15 O2-36{&#39;total_energy&#39;: -478.54775}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 271/630
processed: 272/630
processed: 273/630
processed: 274/630
processed: 275/630
processed: 276/630
processed: 277/630
processed: 278/630
processed: 279/630
processed: 280/630
processed: 281/630
processed: 282/630
processed: 283/630
processed: 284/630
processed: 285/630
processed: 286/630
processed: 287/630
processed: 288/630
processed: 289/630
processed: 290/630
processed: 291/630
processed: 292/630
processed: 293/630
processed: 294/630
processed: 295/630
processed: 296/630
processed: 297/630
processed: 298/630
processed: 299/630
processed: 300/630
processed: 301/630
processed: 302/630
processed: 303/630
processed: 304/630
processed: 305/630
processed: 306/630
processed: 307/630
processed: 308/630
processed: 309/630
processed: 310/630
processed: 311/630
processed: 312/630
processed: 313/630
processed: 314/630
processed: 315/630
processed: 316/630
processed: 317/630
processed: 318/630
processed: 319/630
processed: 320/630
processed: 321/630
processed: 322/630
processed: 323/630
processed: 324/630
processed: 325/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 96 - Li+18 Ti4+9 O2-27{&#39;total_energy&#39;: -377.54954127}
Index 194 - Li+24 Ti4+12 O2-36{&#39;total_energy&#39;: -503.42615}
Index 203 - Li+2 Ti4+1 O2-3{&#39;total_energy&#39;: -41.919018}
Index 205 - Li+6 Ti4+3 O2-9{&#39;total_energy&#39;: -125.91502}
Index 323 - Ti4+12 Li+24 O2-36{&#39;total_energy&#39;: -503.49035}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 326/630
processed: 327/630
processed: 328/630
processed: 329/630
processed: 330/630
processed: 331/630
processed: 332/630
processed: 333/630
processed: 334/630
processed: 335/630
processed: 336/630
processed: 337/630
processed: 338/630
processed: 339/630
processed: 340/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 151 - Mn3+18 Li+18 O2-36{&#39;total_energy&#39;: -473.16304}
Index 340 - Li+18 Mn3+18 O2-36{&#39;total_energy&#39;: -473.18089}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 151 - Mn3+18 Li+18 O2-36{&#39;total_energy&#39;: -473.16304}
Index 340 - Li+18 Mn3+18 O2-36{&#39;total_energy&#39;: -473.18089}
Index 341 - Mn3+18 Li+18 O2-36{&#39;total_energy&#39;: -473.08014}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 341/630
processed: 342/630
processed: 343/630
processed: 344/630
processed: 345/630
processed: 346/630
processed: 347/630
processed: 348/630
processed: 349/630
processed: 350/630
processed: 351/630
processed: 352/630
processed: 353/630
processed: 354/630
processed: 355/630
processed: 356/630
processed: 357/630
processed: 358/630
processed: 359/630
processed: 360/630
processed: 361/630
processed: 362/630
processed: 363/630
processed: 364/630
processed: 365/630
processed: 366/630
processed: 367/630
processed: 368/630
processed: 369/630
processed: 370/630
processed: 371/630
processed: 372/630
processed: 373/630
processed: 374/630
processed: 375/630
processed: 376/630
processed: 377/630
processed: 378/630
processed: 379/630
processed: 380/630
processed: 381/630
processed: 382/630
processed: 383/630
processed: 384/630
processed: 385/630
processed: 386/630
processed: 387/630
processed: 388/630
processed: 389/630
processed: 390/630
processed: 391/630
processed: 392/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 380 - Mn3+6 Li+22 Ti4+8 O2-36{&#39;total_energy&#39;: -493.32099}
Index 390 - Li+22 Mn3+6 Ti4+8 O2-36{&#39;total_energy&#39;: -493.33222}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 380 - Mn3+6 Li+22 Ti4+8 O2-36{&#39;total_energy&#39;: -493.32099}
Index 390 - Li+22 Mn3+6 Ti4+8 O2-36{&#39;total_energy&#39;: -493.33222}
Index 392 - Li+22 Mn3+6 Ti4+8 O2-36{&#39;total_energy&#39;: -493.38501}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 380 - Mn3+6 Li+22 Ti4+8 O2-36{&#39;total_energy&#39;: -493.32099}
Index 390 - Li+22 Mn3+6 Ti4+8 O2-36{&#39;total_energy&#39;: -493.33222}
Index 392 - Li+22 Mn3+6 Ti4+8 O2-36{&#39;total_energy&#39;: -493.38501}
Index 393 - Li+22 Ti4+8 Mn3+6 O2-36{&#39;total_energy&#39;: -493.33785}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 393/630
processed: 394/630
processed: 395/630
processed: 396/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 391 - Li+22 Ti4+8 Mn3+6 O2-36{&#39;total_energy&#39;: -493.20104}
Index 394 - Li+22 Ti4+8 Mn3+6 O2-36{&#39;total_energy&#39;: -493.20144}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 397/630
processed: 398/630
processed: 399/630
processed: 400/630
processed: 401/630
processed: 402/630
processed: 403/630
processed: 404/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 395 - Li+23 Mn3+3 Ti4+10 O2-36{&#39;total_energy&#39;: -498.74487}
Index 402 - Li+23 Ti4+10 Mn3+3 O2-36{&#39;total_energy&#39;: -498.74407}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 405/630
processed: 406/630
processed: 407/630
processed: 408/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 395 - Li+23 Mn3+3 Ti4+10 O2-36{&#39;total_energy&#39;: -498.74487}
Index 402 - Li+23 Ti4+10 Mn3+3 O2-36{&#39;total_energy&#39;: -498.74407}
Index 408 - Li+23 Ti4+10 Mn3+3 O2-36{&#39;total_energy&#39;: -498.73567}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 395 - Li+23 Mn3+3 Ti4+10 O2-36{&#39;total_energy&#39;: -498.74487}
Index 402 - Li+23 Ti4+10 Mn3+3 O2-36{&#39;total_energy&#39;: -498.74407}
Index 408 - Li+23 Ti4+10 Mn3+3 O2-36{&#39;total_energy&#39;: -498.73567}
Index 410 - Li+23 Ti4+10 Mn3+3 O2-36{&#39;total_energy&#39;: -498.74938}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 409/630
processed: 410/630
processed: 411/630
processed: 412/630
processed: 413/630
processed: 414/630
processed: 415/630
processed: 416/630
processed: 417/630
processed: 418/630
processed: 419/630
processed: 420/630
processed: 421/630
processed: 422/630
processed: 423/630
processed: 424/630
processed: 425/630
processed: 426/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 184 - Mn3+18 Li+18 O2-36{&#39;total_energy&#39;: -472.72205}
Index 425 - Mn3+18 Li+18 O2-36{&#39;total_energy&#39;: -473.1071}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 427/630
processed: 428/630
processed: 429/630
processed: 430/630
processed: 431/630
processed: 432/630
processed: 433/630
processed: 434/630
processed: 435/630
processed: 436/630
processed: 437/630
processed: 438/630
processed: 439/630
processed: 440/630
processed: 441/630
processed: 442/630
processed: 443/630
processed: 444/630
processed: 445/630
processed: 446/630
processed: 447/630
processed: 448/630
processed: 449/630
processed: 450/630
processed: 451/630
processed: 452/630
processed: 453/630
processed: 454/630
processed: 455/630
processed: 456/630
processed: 457/630
processed: 458/630
processed: 459/630
processed: 460/630
processed: 461/630
processed: 462/630
processed: 463/630
processed: 464/630
processed: 465/630
processed: 466/630
processed: 467/630
processed: 468/630
processed: 469/630
processed: 470/630
processed: 471/630
processed: 472/630
processed: 473/630
processed: 474/630
processed: 475/630
processed: 476/630
processed: 477/630
processed: 478/630
processed: 479/630
processed: 480/630
processed: 481/630
processed: 482/630
processed: 483/630
processed: 484/630
processed: 485/630
processed: 486/630
processed: 487/630
processed: 488/630
processed: 489/630
processed: 490/630
processed: 491/630
processed: 492/630
processed: 493/630
processed: 494/630
processed: 495/630
processed: 496/630
processed: 497/630
processed: 498/630
processed: 499/630
processed: 500/630
processed: 501/630
processed: 502/630
processed: 503/630
processed: 504/630
processed: 505/630
processed: 506/630
processed: 507/630
processed: 508/630
processed: 509/630
processed: 510/630
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/lbluque/Develop/smol/smol/cofe/wrangling/wrangler.py:652: UserWarning: The following structures have duplicated correlation vectors:
 Index 506 - Li+23 Ti4+10 Mn3+3 O2-36{&#39;total_energy&#39;: -498.01167}
Index 507 - Li+23 Mn3+3 Ti4+10 O2-36{&#39;total_energy&#39;: -497.84187}
 Consider adding more terms to the clustersubspace or filtering duplicates.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
processed: 511/630
processed: 512/630
processed: 513/630
processed: 514/630
processed: 515/630
processed: 516/630
processed: 517/630
processed: 518/630
processed: 519/630
processed: 520/630
processed: 521/630
processed: 522/630
processed: 523/630
processed: 524/630
processed: 525/630
processed: 526/630
processed: 527/630
processed: 528/630
processed: 529/630
processed: 530/630
processed: 531/630
processed: 532/630
processed: 533/630
processed: 534/630
processed: 535/630
processed: 536/630
processed: 537/630
processed: 538/630
processed: 539/630
processed: 540/630
processed: 541/630
processed: 542/630
processed: 543/630
processed: 544/630
processed: 545/630
processed: 546/630
processed: 547/630
processed: 548/630
processed: 549/630
processed: 550/630
processed: 551/630
processed: 552/630
processed: 553/630
processed: 554/630
processed: 555/630
processed: 556/630
processed: 557/630
processed: 558/630
processed: 559/630
processed: 560/630
processed: 561/630
processed: 562/630
processed: 563/630
processed: 564/630
processed: 565/630
processed: 566/630
processed: 567/630
processed: 568/630
processed: 569/630
processed: 570/630
processed: 571/630
processed: 572/630
processed: 573/630
processed: 574/630
processed: 575/630
processed: 576/630
processed: 577/630
processed: 578/630
processed: 579/630
processed: 580/630
processed: 581/630
processed: 582/630
processed: 583/630
processed: 584/630
processed: 585/630
processed: 586/630
processed: 587/630
processed: 588/630
processed: 589/630
processed: 590/630
processed: 591/630
processed: 592/630
processed: 593/630
processed: 594/630
processed: 595/630
processed: 596/630
processed: 597/630
processed: 598/630
processed: 599/630
processed: 600/630
processed: 601/630
processed: 602/630
processed: 603/630
processed: 604/630
processed: 605/630
processed: 606/630
processed: 607/630
processed: 608/630
processed: 609/630
processed: 610/630
processed: 611/630
processed: 612/630
processed: 613/630
processed: 614/630
processed: 615/630
processed: 616/630
processed: 617/630
processed: 618/630
processed: 619/630
processed: 620/630
processed: 621/630
processed: 622/630
processed: 623/630
processed: 624/630
processed: 625/630
processed: 626/630
processed: 627/630
processed: 628/630
processed: 629/630

Total structures that match 630/630
</pre></div></div>
</div>
<p>Training a cluster expansion is one of the most critical steps. This is how you get <strong>effective cluster interactions (ECI’s)</strong>. To do so you need an estimator class that implements some form of regression model. In this case we will use simple least squares regression using the <code class="docutils literal notranslate"><span class="pre">LinearRegression</span></code> estimator from <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">smol</span></code> the coefficients from the fit are not exactly the ECI’s but the ECI times the multiplicity of their orbit.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="c1"># Set fit_intercept to False because we already do this using</span>
<span class="c1"># the empty cluster.</span>
<span class="n">estimator</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">wrangler</span><span class="o">.</span><span class="n">feature_matrix</span><span class="p">,</span>
              <span class="n">wrangler</span><span class="o">.</span><span class="n">get_property_vector</span><span class="p">(</span><span class="s1">&#39;total_energy&#39;</span><span class="p">))</span>
<span class="n">coefs</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>
</div>
</div>
<section id="3.1)-Check-the-quality-of-the-fit">
<h3>3.1) Check the quality of the fit<a class="headerlink" href="#3.1)-Check-the-quality-of-the-fit" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">max_error</span>

<span class="n">train_predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">wrangler</span><span class="o">.</span><span class="n">feature_matrix</span><span class="p">,</span> <span class="n">coefs</span><span class="p">)</span>

<span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">wrangler</span><span class="o">.</span><span class="n">get_property_vector</span><span class="p">(</span><span class="s1">&#39;total_energy&#39;</span><span class="p">),</span>
                          <span class="n">train_predictions</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">maxer</span> <span class="o">=</span> <span class="n">max_error</span><span class="p">(</span><span class="n">wrangler</span><span class="o">.</span><span class="n">get_property_vector</span><span class="p">(</span><span class="s1">&#39;total_energy&#39;</span><span class="p">),</span>
                  <span class="n">train_predictions</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;RMSE </span><span class="si">{</span><span class="n">rmse</span><span class="si">}</span><span class="s1"> eV/prim&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;MAX </span><span class="si">{</span><span class="n">maxer</span><span class="si">}</span><span class="s1"> eV/prim&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RMSE 0.013719719976843134 eV/prim
MAX 0.10229881737488533 eV/prim
</pre></div></div>
</div>
</section>
</section>
<section id="4)-Create-a-cluster-expansion">
<h2>4) Create a cluster expansion<a class="headerlink" href="#4)-Create-a-cluster-expansion" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># save details of the regression used to fit</span>
<span class="n">reg_data</span> <span class="o">=</span> <span class="n">RegressionData</span><span class="o">.</span><span class="n">from_sklearn</span><span class="p">(</span>
    <span class="n">estimator</span><span class="p">,</span> <span class="n">feature_matrix</span><span class="o">=</span><span class="n">wrangler</span><span class="o">.</span><span class="n">feature_matrix</span><span class="p">,</span>
    <span class="n">property_vector</span><span class="o">=</span><span class="n">wrangler</span><span class="o">.</span><span class="n">get_property_vector</span><span class="p">(</span><span class="s1">&#39;total_energy&#39;</span><span class="p">))</span>

<span class="n">expansion</span> <span class="o">=</span> <span class="n">ClusterExpansion</span><span class="p">(</span>
    <span class="n">subspace</span><span class="p">,</span> <span class="n">coefficients</span><span class="o">=</span><span class="n">coefs</span><span class="p">,</span> <span class="n">regression_data</span><span class="o">=</span><span class="n">reg_data</span><span class="p">)</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">structure</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">wrangler</span><span class="o">.</span><span class="n">structures</span><span class="p">)</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">expansion</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The predicted energy for a structure with composition &#39;</span>
      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">structure</span><span class="o">.</span><span class="n">composition</span><span class="si">}</span><span class="s1"> is </span><span class="si">{</span><span class="n">prediction</span><span class="si">}</span><span class="s1"> eV/prim.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The fitted coefficients are:</span><span class="se">\n</span><span class="si">{</span><span class="n">expansion</span><span class="o">.</span><span class="n">coefs</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The effective cluster interactions are:</span><span class="se">\n</span><span class="si">{</span><span class="n">expansion</span><span class="o">.</span><span class="n">eci</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">expansion</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The predicted energy for a structure with composition Mn3+9 Li+21 Ti4+6 O2-36 is -13.550963091022656 eV/prim.

The fitted coefficients are:
[-1.41649677e+11 -3.54124192e+11  1.22672219e+11  7.93385756e-01
 -5.30298691e-01  1.55481332e-01  4.38792541e-01 -2.09197422e-01
  5.72421679e-02  1.99144459e-01  1.62832331e-01 -1.10884296e-01
  1.44084032e-01  6.09243067e-02 -3.38844332e-02  2.38991409e-01
 -1.30564341e-01 -1.23614042e-02 -2.50345094e-01 -1.03712695e-01
  4.50283643e-01  7.79379756e-02 -6.63553619e-02 -1.05656329e-01
  2.81985642e-01  1.38585686e-01 -1.30902417e-01]

The effective cluster interactions are:
[-1.41649677e+11 -3.54124192e+11  1.22672219e+11  1.32230959e-01
 -4.41915576e-02  2.59135553e-02  1.46264180e-01 -3.48662371e-02
  1.90807226e-02  1.65953715e-02  6.78468044e-03 -9.24035801e-03
  2.40140053e-02  5.07702555e-03 -5.64740553e-03  1.99159507e-02
 -5.44018086e-03 -1.03011701e-03 -3.12931368e-02 -4.32136227e-03
  1.87618185e-02  9.74224694e-03 -3.31776809e-02 -1.32070411e-02
  2.34988035e-02  1.73232107e-02 -6.54512087e-02]

ClusterExpansion:
    Prim Composition: Li+0.33333333 Mn3+0.33333333 Ti4+0.33333333 O2-1
Num corr functions: 27
    [Orbit]  id: 0
        bit       eci
        [X]       -1.42e+11
    [Orbit]  id: 1   size: 1   radius: 0.0
        id    bit       eci     feature avg  feature std  eci*std
        1     [0]       -354124192092.776-0.337       0.089        -31535657800.435
        2     [1]       122672218580.1490.182        0.257        31535657800.783
    [Orbit]  id: 3   size: 2   radius: 2.97
        id    bit       eci     feature avg  feature std  eci*std
        3     [0 0]     0.793   0.049        0.080        0.064
        4     [0 1]     -0.530  -0.050       0.115        -0.061
        5     [1 1]     0.155   0.085        0.069        0.011
    [Orbit]  id: 6   size: 2   radius: 4.2
        id    bit       eci     feature avg  feature std  eci*std
        6     [0 0]     0.439   0.089        0.108        0.047
        7     [0 1]     -0.209  -0.029       0.112        -0.023
        8     [1 1]     0.057   0.094        0.086        0.005
    [Orbit]  id: 9   size: 2   radius: 5.14
        id    bit       eci     feature avg  feature std  eci*std
        9     [0 0]     0.199   0.163        0.083        0.016
        10    [0 1]     0.163   -0.035       0.074        0.012
        11    [1 1]     -0.111  0.099        0.089        -0.010
    [Orbit]  id: 12  size: 2   radius: 5.94
        id    bit       eci     feature avg  feature std  eci*std
        12    [0 0]     0.144   0.117        0.131        0.019
        13    [0 1]     0.061   -0.048       0.094        0.006
        14    [1 1]     -0.034  0.097        0.080        -0.003
    [Orbit]  id: 15  size: 2   radius: 6.64
        id    bit       eci     feature avg  feature std  eci*std
        15    [0 0]     0.239   0.105        0.081        0.019
        16    [0 1]     -0.131  -0.045       0.093        -0.012
        17    [1 1]     -0.012  0.093        0.078        -0.001
    [Orbit]  id: 18  size: 3   radius: 2.97
        id    bit       eci     feature avg  feature std  eci*std
        18    [0 0 0]   -0.250  0.031        0.055        -0.014
        19    [1 0 0]   -0.104  -0.009       0.039        -0.004
        20    [1 0 1]   0.450   -0.043       0.035        0.016
        21    [1 1 1]   0.078   0.021        0.028        0.002
    [Orbit]  id: 22  size: 4   radius: 2.97
        id    bit       eci     feature avg  feature std  eci*std
        22    [0 0 0 0] -0.066  -0.011       0.085        -0.006
        23    [0 1 0 0] -0.106  0.026        0.048        -0.005
        24    [0 1 0 1] 0.282   0.017        0.027        0.008
        25    [1 1 0 1] 0.139   -0.012       0.018        0.003
        26    [1 1 1 1] -0.131  0.005        0.012        -0.002

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/tmp/ipykernel_296408/2662299786.py:9: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify &#39;dtype=object&#39; when creating the ndarray.
  structure = np.random.choice(wrangler.structures)
</pre></div></div>
</div>
</section>
<section id="5)-Saving-your-work">
<h2>5) Saving your work<a class="headerlink" href="#5)-Saving-your-work" title="Permalink to this headline">¶</a></h2>
<p>All core classes in <code class="docutils literal notranslate"><span class="pre">smol</span></code> are <code class="docutils literal notranslate"><span class="pre">MSONables</span></code> and so can be saved using their <code class="docutils literal notranslate"><span class="pre">as_dict</span></code> methods or better yet with <code class="docutils literal notranslate"><span class="pre">monty.serialization.dumpfn</span></code>.</p>
<p>Currently there is also a convenience function in <code class="docutils literal notranslate"><span class="pre">smol</span></code> that will nicely save all of your work for you in a standardized way. Work saved with the <code class="docutils literal notranslate"><span class="pre">save_work</span></code> function is saved as a dictionary with standardized names for the classes. Since a work flow should only contain 1 of each core classes the function will complain if you give it two of the same class (i.e. two wranglers)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">smol.io</span> <span class="kn">import</span> <span class="n">load_work</span><span class="p">,</span> <span class="n">save_work</span>

<span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;../data/lmto_sinusoid.mson&#39;</span>
<span class="c1"># we can save the subspace as well, but since both the wrangler</span>
<span class="c1"># and the expansion have it, there is no need to do so.</span>
<span class="n">save_work</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">wrangler</span><span class="p">,</span> <span class="n">expansion</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="5.1)-Loading-previously-saved-work">
<h3>5.1) Loading previously saved work<a class="headerlink" href="#5.1)-Loading-previously-saved-work" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">smol.io</span> <span class="kn">import</span> <span class="n">load_work</span><span class="p">,</span> <span class="n">save_work</span>

<span class="n">work</span> <span class="o">=</span> <span class="n">load_work</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">work</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
StructureWrangler: &lt;class &#39;smol.cofe.wrangling.wrangler.StructureWrangler&#39;&gt;

ClusterExpansion: &lt;class &#39;smol.cofe.expansion.ClusterExpansion&#39;&gt;

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</section>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2020-2022, Ceder Group.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>