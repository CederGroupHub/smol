
<!DOCTYPE html>


<html lang="en" data-theme="auto">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Package Design &#8212; smol 0.5.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "auto";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/smol.css?v=153d459c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=927b94d3fcb96560df09"></script>

    <script src="../_static/documentation_options.js?v=ec2251d1"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'developer_guide/design';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.14.0';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://pydata-sphinx-theme.readthedocs.io/en/latest/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '0.5.2';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <script src="../_static/require.js?v=d4dd881e"></script>
    <script src="../_static/custom.js?v=1f4f4097"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Contributing &amp; Developing Guidelines" href="guide.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Sep 17, 2023"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="auto">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../getting_started.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../examples.html">
                        Example Notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../user_guide.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api_reference/index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../citing.html">
                        Citing
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    More
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item current active">
                      <a class="nav-link dropdown-item nav-internal" href="index.html">
                        Developing
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://github.com/CederGroupHub/smol/blob/master/CHANGES.md">
                    Changes
                  </a>
                </li>
                

                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://github.com/CederGroupHub/smol/issues">
                    Issues
                  </a>
                </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__kbd-shortcut">Search</span>
    <span><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="versionswitcherbutton" type="button" role="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="listbox" aria-controls="versionswitcherlist" aria-label="Version switcher list">
      0.5.2  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="versionswitcherlist" class="version-switcher__menu dropdown-menu list-group-flush py-0" role="listbox" aria-labelledby="versionswitcherbutton">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/CederGroupHub/smol" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__kbd-shortcut">Search</span>
    <span><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../getting_started.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../examples.html">
                        Example Notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../user_guide.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api_reference/index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../citing.html">
                        Citing
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    More
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item current active">
                      <a class="nav-link dropdown-item nav-internal" href="index.html">
                        Developing
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://github.com/CederGroupHub/smol/blob/master/CHANGES.md">
                    Changes
                  </a>
                </li>
                

                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://github.com/CederGroupHub/smol/issues">
                    Issues
                  </a>
                </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="versionswitcherbutton" type="button" role="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="listbox" aria-controls="versionswitcherlist" aria-label="Version switcher list">
      0.5.2  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="versionswitcherlist" class="version-switcher__menu dropdown-menu list-group-flush py-0" role="listbox" aria-labelledby="versionswitcherbutton">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/CederGroupHub/smol" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="guide.html">Contributing &amp; Developing Guidelines</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Package Design</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Developing</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Package Design</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="package-design">
<span id="design"></span><h1>Package Design<a class="headerlink" href="#package-design" title="Link to this heading">#</a></h1>
<section id="overview-mission">
<h2>Overview &amp; Mission<a class="headerlink" href="#overview-mission" title="Link to this heading">#</a></h2>
<p><strong>smol</strong> is intentionally designed to be easy to use, install and extend. In order to
achieve these goals the package has few dependencies <a class="footnote-reference brackets" href="#f1" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, and has a heavily
object-oriented and modular design that closely follows mathematical and methodological
abstractions. This enables flexible creation of complex workflows and hassle-free
implementation methodology extensions, that will rarely need to be implemented from
scratch.</p>
<p>Inheritance, polymorphism and composition are key OOP design concepts in <strong>smol</strong> that
result in a modular design, This <em>hopefully</em> allows to design complex calculation
workflows and implement new functionality without having to implement new classes and
functions from scratch.</p>
<p><strong>smol</strong> has been designed to enable efficient and open development of new methodology
for fitting and sampling applied lattice models in a user-friendly way; and as a result
allow quick development-to-application turnaround time in the study of configuration
dependent properties of inorganic materials.</p>
</section>
<section id="module-design">
<h2>Module Design<a class="headerlink" href="#module-design" title="Link to this heading">#</a></h2>
<p><strong>smol</strong> is organized into two main submodules, <code class="xref py py-mod docutils literal notranslate"><span class="pre">smol.cofe</span></code> and
<code class="xref py py-mod docutils literal notranslate"><span class="pre">smol.moca</span></code>:</p>
<ul class="simple">
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">smol.cofe</span></code> implements the classes and functions to represent
site spaces, configuration spaces and function subspaces over them, and the tools
necessary to fit lattice models, in the spirit of <em>cluster expansions</em> and the
<em>structure inversion method</em>.</p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">smol.moca</span></code> has implementations of classes to carry out Monte Carlo sampling of
ensembles associated with a fitted lattice model Hamiltonian, as well as simple
empirical models such as a point Coulomb potential.</p></li>
</ul>
<p>Below is a detailed description of the classes and their relationships in the main
modules. Before delving into these we recommend going over the simpler overview of the
package in the <a class="reference internal" href="../user_guide.html#user-guide"><span class="std std-ref">User Guide</span></a> page.</p>
<p>Diagrams showing the main objects and their relationships for the <code class="xref py py-mod docutils literal notranslate"><span class="pre">smol.cofe</span></code> and
<code class="xref py py-mod docutils literal notranslate"><span class="pre">smol.moca</span></code> are presented below. In these diagrams base classes are depicted in
filled (and unboxed) rectangles, derived classes are depited in boxed rectangles with
an colored arrow pointing from the base class to the derived classes.</p>
<p>Ownership relationships between distinct classes (i.e. when a class has another class
as an attribute) are depicted as dark blue colored arrows. The arrow points from the
class which is an attribute to the class that holds the former as an attributed.</p>
<section id="smol-cofe">
<h3><code class="xref py py-mod docutils literal notranslate"><span class="pre">smol.cofe</span></code><a class="headerlink" href="#smol-cofe" title="Link to this heading">#</a></h3>
<p>The diagram below summarizes the overall design of the <code class="xref py py-mod docutils literal notranslate"><span class="pre">smol.cofe</span></code> module. The main
classes that users directly instantiate and interact with are the
<code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterSubspace</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">StructureWrangler</span></code>, and <code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterExpansion</span></code> as
detailed in the <a class="reference internal" href="../user_guide.html#user-guide"><span class="std std-ref">User Guide</span></a>. All main classes are derived from <code class="xref py py-mod docutils literal notranslate"><span class="pre">monty</span></code>
<code class="xref py py-class docutils literal notranslate"><span class="pre">MSONable</span></code> and thus can be serialized and saved as JSON objects.
In addition, several other classes are defined to enable the various features and
functionality in the module.</p>
<img alt="../_images/smol_cofe.svg" class="dark-light p-2" src="../_images/smol_cofe.svg" /><p>Following the diagram above, the main purpose of the classes depicted is,</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterSubspace</span></code> (and its derived class <code class="xref py py-class docutils literal notranslate"><span class="pre">PottsSubspace</span></code>) is the main
work horse to construct and represent configuration spaces and the function spaces
over them. Its main purpose is to compute <em>correlation function</em> values given an
ordered structure. In order to do so, it holds a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Orbit</span></code> objects
generated for a particular disordered <code class="xref py py-mod docutils literal notranslate"><span class="pre">pymatgen</span></code> <code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code>. Additionally
an <em>external term</em> representing a simple empricial potential model can also be
included. Currently only an <code class="xref py py-class docutils literal notranslate"><span class="pre">EwaldTerm</span></code>, to represent a point electrostatic
potential is available.</p>
<ul>
<li><p>An <code class="xref py py-class docutils literal notranslate"><span class="pre">Orbit</span></code> represents both the set of symmetrically equivalent clusters, as
well as the set of <em>product functions</em> that act over the configurations of those
clusters. An orbit holds a base <code class="xref py py-class docutils literal notranslate"><span class="pre">Cluster</span></code> and a list of <span class="xref std std-ref">SiteBasis</span>
associated with each site in the cluster.</p>
<ul>
<li><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">Cluster</span></code> is a collection of sites (derived from <code class="xref py py-class docutils literal notranslate"><span class="pre">SiteCollection</span></code>
in <code class="xref py py-mod docutils literal notranslate"><span class="pre">pymatgen</span></code>). The two key concepts of a <code class="xref py py-class docutils literal notranslate"><span class="pre">Cluster</span></code> is that compared
to a <code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code> they do hold periodic sites, and compared to a
<code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> the hold a lattice (of the structure they are associated with).</p></li>
<li><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">SiteBasis</span></code> represents the basis set that spans the function space of
the configurations for a single site. Several types of basis sets are included
and implementing new ones is relatively straightforward. A <code class="xref py py-class docutils literal notranslate"><span class="pre">SiteBasis</span></code> holds
a <code class="xref py py-class docutils literal notranslate"><span class="pre">SiteSpace</span></code> which represents its single site configuration space.</p>
<ul>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SiteSpace</span></code> represents the possible configurations of a given site.
It essentially holds a <code class="xref py py-mod docutils literal notranslate"><span class="pre">pymatgen</span></code> <code class="xref py py-class docutils literal notranslate"><span class="pre">Composition</span></code>, with the addition
of an explicit <code class="xref py py-class docutils literal notranslate"><span class="pre">Vacancy</span></code> species, for compositions that do not sum to 1.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>An external term, representing a simple empirical pair potential can also be
included in a <code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterSubspace</span></code> to create a mixture model (i.e. a Cluster
expansion + an empirical potential). Currently an <code class="xref py py-class docutils literal notranslate"><span class="pre">EwaldTerm</span></code> is implemented
to allow mixture models of cluster expansions with explicit electrostatics.</p></li>
</ul>
</li>
<li><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">StructureWrangler</span></code> is the main object for training data preparation.
Training data is held as a list of <code class="xref py py-mod docutils literal notranslate"><span class="pre">pymatgen</span></code> <code class="xref py py-class docutils literal notranslate"><span class="pre">ComputedStructureEntry</span></code>. The
<code class="xref py py-class docutils literal notranslate"><span class="pre">StructureWrangler</span></code> holds a given <code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterSubspace</span></code>, and takes care of
making sure training structures can be correctly mapped to the disordered unit
structure of the <code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterSubspace</span></code>. The corresponding correlation vectors of
the training structures that can be correctly mapped are computed to form the
correlation matrix (feature matrix) necessary for training. In addition, the
<code class="xref py py-class docutils literal notranslate"><span class="pre">StructureWrangler</span></code> has several methods that allow to inspect and further
prepare training data, such as checking for duplicates, obtaining correlation matrix
properties, and most importantly obtaining a properly normalized property vector for
training (the normalization is done per the disordered unit cell from the
<code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterSubspace</span></code> ).</p></li>
<li><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterExpansion</span></code> represent the final <em>fitted</em> lattice model. It holds
a <code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterSubspace</span></code>, and a corresponding set of fitted coefficients. A
<code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterSubspace</span></code> can be used to predict the energy of new structures, as well
as obtain the <em>effective cluster interactions</em> (ECI), and prune unimportant terms.</p></li>
</ul>
</section>
<section id="smol-moca">
<h3><code class="xref py py-mod docutils literal notranslate"><span class="pre">smol.moca</span></code><a class="headerlink" href="#smol-moca" title="Link to this heading">#</a></h3>
<p>A diagram showing the overall design of the <code class="xref py py-mod docutils literal notranslate"><span class="pre">smol.moca</span></code> module. The
main classes in this module that are necessary to run Monte Carlo sampling using
a <code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterExpansion</span></code> are the <code class="xref py py-class docutils literal notranslate"><span class="pre">Processor</span></code> classes, the <code class="xref py py-class docutils literal notranslate"><span class="pre">Ensemble</span></code>,
and the <code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code> class. However, a number of helper classes are implemented
to allow running and implementing a large variety of types of MC calculations.</p>
<img alt="../_images/smol_moca.svg" class="dark-light p-2" src="../_images/smol_moca.svg" /><p>The class descriptions are as follows,</p>
<ul class="simple">
<li><p>An <code class="xref py py-class docutils literal notranslate"><span class="pre">Ensemble</span></code> represents the probability space associated with a particular
lattice model and thermodynamic boundary conditions (i.e. <code class="xref py py-attr docutils literal notranslate"><span class="pre">chemical_potentials</span></code>)
over a finite simulation domain size, which is represented by a supercell matrix of
an associated unit cell. An <code class="xref py py-class docutils literal notranslate"><span class="pre">Ensemble</span></code> holds a <code class="xref py py-class docutils literal notranslate"><span class="pre">Processor</span></code> and a list
of <code class="xref py py-class docutils literal notranslate"><span class="pre">Sublattice</span></code> instances.</p>
<ul>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Sublattice</span></code> represents the set of sites of the defined supercell that are
have the same site space (set of allowed species). <code class="xref py py-class docutils literal notranslate"><span class="pre">Sublattice</span></code> instances
can also be split according to a particular <em>frozen</em> configuration.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Processor</span></code> instances, hold a <code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterSubspace</span></code> and represent a
particular sampling domain in the form of a supercell matrix (of the corresponding
disordered unit cell). A <code class="xref py py-class docutils literal notranslate"><span class="pre">Processor</span></code> allows to quickly and efficiently
calculate the fitted property and differences from local updates for a given
configuration (over the represented supercell). A <code class="xref py py-class docutils literal notranslate"><span class="pre">Processor</span></code> can also
generate occupancy strings given an ordered supercell structure, as well as
generate the <code class="xref py py-class docutils literal notranslate"><span class="pre">Sublattice</span></code> instances for the different sites in the
supercell domain.</p></li>
</ul>
</li>
<li><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code> is the main class to run MC sampling given a particular
<code class="xref py py-class docutils literal notranslate"><span class="pre">Ensemble</span></code> instance. Apart from the ensemble to be sampled, a <code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code>
holds the an <code class="xref py py-class docutils literal notranslate"><span class="pre">MCKernel</span></code> that implements the particular sampling algorithm, and
a <code class="xref py py-class docutils literal notranslate"><span class="pre">SampleContainer</span></code> to record the sampled configurations, correlation vectors,
enthalpy, and any other associated state variable.</p>
<ul>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">MCKernel</span></code> are implementations of particular MC algorithms, such as the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Metropolis</span></code> kernel. They take care of generating the Markov chain, sampling
histograms, and any other configuration and state attribute. The include an
<code class="xref py py-class docutils literal notranslate"><span class="pre">MCUsher</span></code> to propose steps, and may also include an optional <code class="xref py py-class docutils literal notranslate"><span class="pre">MCBias</span></code>
to bias samples to particular configurations in phase space.</p>
<ul>
<li><p>An <code class="xref py py-class docutils literal notranslate"><span class="pre">MCUsher</span></code> has the purpose of proposing the steps to carry out the
random walk for an MC calculation. The simplest are a <code class="xref py py-class docutils literal notranslate"><span class="pre">Flip</span></code> for single
site species changes, and a <code class="xref py py-class docutils literal notranslate"><span class="pre">Swap</span></code> for swapping the species at two sites.
However implementing new <code class="xref py py-class docutils literal notranslate"><span class="pre">MCUsher</span></code> for more complex random walks should
be relatively straightforward.</p></li>
<li><p>An <code class="xref py py-class docutils literal notranslate"><span class="pre">MCBias</span></code> serves as an additional term that can be included to bias
acceptance probabilities in order to carry out sampling from <em>extended</em> or
<em>biased</em> ensembles.</p></li>
</ul>
</li>
<li><p>MC samples are saved in a <code class="xref py py-class docutils literal notranslate"><span class="pre">SamplerContainer</span></code> from sampled <code class="xref py py-class docutils literal notranslate"><span class="pre">Trace</span></code>
objects. These will always include the configurations, correlations or features,
and the energy or enthalpy. Additional values depending on the particular
<code class="xref py py-class docutils literal notranslate"><span class="pre">MCKernel</span></code> used are also saved. A <code class="xref py py-class docutils literal notranslate"><span class="pre">SampleContainer</span></code> has functionality
to obtain simple mean and variances of sampled values. In addition, a
<code class="xref py py-class docutils literal notranslate"><span class="pre">SampleContainer</span></code> can be saved as either a json file or an hdf5 container.
During lengthy simulations, samples can be streamed into an hdf5 container to
minimize memory requirements; further, using hdf5 containers in
<a class="reference external" href="https://docs.h5py.org/en/stable/swmr.html">single writer multiple reader</a> mode
allows users to begin looking at samples before a simulation has concluded.</p></li>
</ul>
</li>
</ul>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="f1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>The dependence on <strong>pymatgen</strong> implicitly includes all of its dependecies—
which are many. However, once <strong>pymatgen</strong> is properly installed, then
installing <strong>smol</strong> should be headache free.</p>
</aside>
</aside>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="guide.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Contributing &amp; Developing Guidelines</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-mission">Overview &amp; Mission</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-design">Module Design</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smol-cofe"><code class="xref py py-mod docutils literal notranslate"><span class="pre">smol.cofe</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smol-moca"><code class="xref py py-mod docutils literal notranslate"><span class="pre">smol.moca</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  
  <div class="tocsection editthispage">
    <a href="https://github.com/CederGroupHub/smol/edit/main/docs/src/developer_guide/design.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2022-2023, Ceder Group.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>