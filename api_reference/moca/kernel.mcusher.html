
<!DOCTYPE html>


<html lang="en" data-theme="auto">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MCUshers &#8212; smol 0.5.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "auto";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/smol.css?v=153d459c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=927b94d3fcb96560df09"></script>

    <script src="../../_static/documentation_options.js?v=ec2251d1"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api_reference/moca/kernel.mcusher';</script>
    <script src="../../_static/require.js?v=d4dd881e"></script>
    <script src="../../_static/custom.js?v=1f4f4097"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Sampling Bias" href="kernel.bias.html" />
    <link rel="prev" title="MCKernels" href="kernel.kernels.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Sep 20, 2023"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="auto">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
      <div class="navbar-item"><ul class="navbar-nav">
  <li class="version-switcher__container dropdown">
    <button
      type="button"
      role="button"
      class="version-switcher__button btn btn-sm navbar-btn"
      data-bs-toggle="dropdown"
      id="dLabelMore"
      aria-haspopup="listbox"
    >
      v0.5.2
      <span class="caret"></span>
    </button>
  </li>
</ul></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../getting_started.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../examples.html">
                        Example Notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user_guide.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../citing.html">
                        Citing
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    More
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../developer_guide/index.html">
                        Developing
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://github.com/CederGroupHub/smol/releases">
                    Changes
                  </a>
                </li>
                

                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://github.com/CederGroupHub/smol/issues">
                    Issues
                  </a>
                </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__kbd-shortcut">Search</span>
    <span><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/CederGroupHub/smol" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__kbd-shortcut">Search</span>
    <span><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../getting_started.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../examples.html">
                        Example Notebooks
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user_guide.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../citing.html">
                        Citing
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    More
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../../developer_guide/index.html">
                        Developing
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://github.com/CederGroupHub/smol/releases">
                    Changes
                  </a>
                </li>
                

                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://github.com/CederGroupHub/smol/issues">
                    Issues
                  </a>
                </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/CederGroupHub/smol" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../cofe/index.html"><strong>cofe</strong> — Cluster-Orbit Function Expansion Module</a><input checked class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../cofe/clusterspace.html">Cluster Spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cofe/space.html">Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cofe/clusterexpansion.html">Expansion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cofe/wrangling.html">Wrangling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cofe/extern.ewald.html">External Terms</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html"><strong>moca</strong> — Monte Carlo Module</a><input checked class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ensemble.html">Ensembles</a></li>
<li class="toctree-l2"><a class="reference internal" href="processors.html">Processors</a></li>
<li class="toctree-l2"><a class="reference internal" href="sampler.html">Sampling</a></li>
<li class="toctree-l2 current active"><a class="reference internal" href="kernel.html">Kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="sublattice.html">Sublattice</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../capp/index.html"><strong>capp</strong> — Cluster Analysis and Applications</a><input checked class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../capp/generate.html">Generate</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../io.html">io — Input and Output</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item"><nav class="sidebar-indices-items">
  <p class="sidebar-indices-items__title" role="heading" aria-level="1">Indices</p>
  <ul class="indices-link">
        <li class="toctree-l1">
          <a class="reference internal"
             href="../../genindex.html"
             accesskey="I">General Index</a>
        </li>
        <li class="toctree-l1">
          <a class="reference internal" href="../../py-modindex.html">Python Module Index</a>
        </li>
  </ul>
</nav></div>
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">





<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">API Reference</a></li>
    
    
    <li class="breadcrumb-item"><i class="fa-solid fa-ellipsis"></i></li>
    
    
    <li class="breadcrumb-item"><a href="kernel.html" class="nav-link">Kernels</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">MCUshers</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="module-smol.moca.kernel.mcusher">
<span id="mcushers"></span><h1>MCUshers<a class="headerlink" href="#module-smol.moca.kernel.mcusher" title="Link to this heading">#</a></h1>
<p>Implementations of MCMC Usher classes.</p>
<p>An usher is used to generate step proposals for MC Monte Carlo sampling.
For example a Flipper simply proposes a change of the identity of a species
at a site for use in a SemiGrand ensemble. A Swapper will propose a swap
between species at two sites for use in Canonical ensemble simulations.</p>
<p>More complex steps can be defined simply by deriving from the MCUsher.</p>
<dl class="py class">
<dt class="sig sig-object py" id="smol.moca.kernel.mcusher.Composite">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Composite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcushers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcusher_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smol/moca/kernel/mcusher.html#Composite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smol.moca.kernel.mcusher.Composite" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MCUsher</span></code></p>
<p>A composite usher for chaining different step types.</p>
<p>This can be used to mix step types for all sublattices or to create hybrid
ensembles where different sublattices have different allowed steps.</p>
<p>Initialize the composite usher.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattices</strong> (<em>list</em><em> of </em><a class="reference internal" href="sublattice.html#smol.moca.sublattice.Sublattice" title="smol.moca.sublattice.Sublattice"><em>Sublattice</em></a>) – list of active Sublattices to propose steps for. Active
sublattices are those that include sites with configuration
degrees of freedom DOFs, only occupancy on active sub-lattices’ active sites
are allowed to change.</p></li>
<li><p><strong>mcushers</strong> (<em>list</em><em> of </em><em>MCUsher</em>) – A list of mcushers to add to the composite.</p></li>
<li><p><strong>mcusher_weights</strong> (<em>list</em><em> of </em><em>float</em>) – A list of the weights associated with each mcusher passed. With this
the corresponding probabilities for each mcusher to be picked are
generated. Must be in the same order as the mcusher list.</p></li>
<li><p><strong>rng</strong> (<em>np.Generator</em>) – optional
The given PRNG must be the same instance as that used by the kernel and
any bias terms, otherwise reproducibility will be compromised.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="smol.moca.kernel.mcusher.Composite.add_mcusher">
<span class="sig-name descname"><span class="pre">add_mcusher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mcusher</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smol/moca/kernel/mcusher.html#Composite.add_mcusher"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smol.moca.kernel.mcusher.Composite.add_mcusher" title="Link to this definition">#</a></dt>
<dd><p>Add an MCUsher to the Composite usher.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mcusher</strong> (<em>MCUsher</em>) – The MCUsher to add</p></li>
<li><p><strong>weight</strong> (<em>float</em>) – The weight associated with the mcusher being added</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="smol.moca.kernel.mcusher.Composite.mcushers">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mcushers</span></span><a class="headerlink" href="#smol.moca.kernel.mcusher.Composite.mcushers" title="Link to this definition">#</a></dt>
<dd><p>Get the list of mcushers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smol.moca.kernel.mcusher.Composite.propose_step">
<span class="sig-name descname"><span class="pre">propose_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smol/moca/kernel/mcusher.html#Composite.propose_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smol.moca.kernel.mcusher.Composite.propose_step" title="Link to this definition">#</a></dt>
<dd><p>Propose a step given an occupancy.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="smol.moca.kernel.mcusher.Composite.weight">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">weight</span></span><a class="headerlink" href="#smol.moca.kernel.mcusher.Composite.weight" title="Link to this definition">#</a></dt>
<dd><p>Get the weights associated with each mcusher.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="smol.moca.kernel.mcusher.Flip">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Flip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sublattice_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smol/moca/kernel/mcusher.html#Flip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smol.moca.kernel.mcusher.Flip" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MCUsher</span></code></p>
<p>Implementation of a simple flip step at a random site.</p>
<p>Initialize MCMCStep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattices</strong> (<em>list</em><em> of </em><a class="reference internal" href="sublattice.html#smol.moca.sublattice.Sublattice" title="smol.moca.sublattice.Sublattice"><em>Sublattice</em></a>) – list of active Sublattices to propose steps for. Active
sublattices are those that include sites with configuration
degrees of freedom DOFs, only occupancy on active sub-lattices’
active sites are allowed to change.</p></li>
<li><p><strong>sublattice_probabilities</strong> (<em>list</em><em> of </em><em>float</em>) – optional
list of probabilities to pick a site from specific active
sublattices.</p></li>
<li><p><strong>rng</strong> (<em>np.Generator</em>) – optional
The given PRNG must be the same instance as that used by the kernel and
any bias terms, otherwise reproducibility will be compromised.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="smol.moca.kernel.mcusher.Flip.propose_step">
<span class="sig-name descname"><span class="pre">propose_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smol/moca/kernel/mcusher.html#Flip.propose_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smol.moca.kernel.mcusher.Flip.propose_step" title="Link to this definition">#</a></dt>
<dd><p>Propose a single random flip step.</p>
<p>A step is given as a sequence of tuples, where each tuple is of the
form (site index, species code to set)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of tuples each with (index, code)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list(tuple)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="smol.moca.kernel.mcusher.MultiStep">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MultiStep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcusher</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_lengths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smol/moca/kernel/mcusher.html#MultiStep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smol.moca.kernel.mcusher.MultiStep" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MCUsher</span></code></p>
<p>A multistep usher to generate steps of several flips.</p>
<p>Any usher can be used to chain steps, ie create multi flip steps, multi swap steps
even multi composite steps, etc.</p>
<p>Initialize a multistep usher.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattices</strong> (<em>list</em><em> of </em><a class="reference internal" href="sublattice.html#smol.moca.sublattice.Sublattice" title="smol.moca.sublattice.Sublattice"><em>Sublattice</em></a>) – list of active Sublattices to propose steps for. Active
sublattices are those that include sites with configuration
degrees of freedom DOFs, only occupancy on active sub-lattices’ active sites
are allowed to change.</p></li>
<li><p><strong>mcusher</strong> (<em>MCUsher</em>) – An instantiated MCUsher to use to create multisteps.</p></li>
<li><p><strong>step_lengths</strong> (<em>int</em><em> or </em><em>Sequence</em><em> of </em><em>int</em>) – The length or lengths of steps. If given a sequence of sizes, a size
is chosen at each proposal according to step_probabilities. The step
length proposed may be less in cases where the same site is chosen
more than once. This should become less and less likely for larger
supercells.</p></li>
<li><p><strong>step_probabilities</strong> (<em>Sequence</em><em> of </em><em>float</em>) – optional
A sequence of probabilities corresponding to the step lengths provided.
If none is given, then a uniform probability is used.</p></li>
<li><p><strong>rng</strong> (<em>np.Generator</em>) – optional
The given PRNG must be the same instance as that used by the kernel and
any bias terms, otherwise reproducibility will be compromised.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="smol.moca.kernel.mcusher.MultiStep.propose_step">
<span class="sig-name descname"><span class="pre">propose_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smol/moca/kernel/mcusher.html#MultiStep.propose_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smol.moca.kernel.mcusher.MultiStep.propose_step" title="Link to this definition">#</a></dt>
<dd><p>Propose a step given an occupancy.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="smol.moca.kernel.mcusher.MultiStep.sublattice_probabilities">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sublattice_probabilities</span></span><a class="headerlink" href="#smol.moca.kernel.mcusher.MultiStep.sublattice_probabilities" title="Link to this definition">#</a></dt>
<dd><p>Get the probabilities of choosing a sublattice.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="smol.moca.kernel.mcusher.Swap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Swap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sublattice_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smol/moca/kernel/mcusher.html#Swap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smol.moca.kernel.mcusher.Swap" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MCUsher</span></code></p>
<p>Implementation of a simple swap step for two random sites.</p>
<p>Initialize MCMCStep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattices</strong> (<em>list</em><em> of </em><a class="reference internal" href="sublattice.html#smol.moca.sublattice.Sublattice" title="smol.moca.sublattice.Sublattice"><em>Sublattice</em></a>) – list of active Sublattices to propose steps for. Active
sublattices are those that include sites with configuration
degrees of freedom DOFs, only occupancy on active sub-lattices’
active sites are allowed to change.</p></li>
<li><p><strong>sublattice_probabilities</strong> (<em>list</em><em> of </em><em>float</em>) – optional
list of probabilities to pick a site from specific active
sublattices.</p></li>
<li><p><strong>rng</strong> (<em>np.Generator</em>) – optional
The given PRNG must be the same instance as that used by the kernel and
any bias terms, otherwise reproducibility will be compromised.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="smol.moca.kernel.mcusher.Swap.propose_step">
<span class="sig-name descname"><span class="pre">propose_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smol/moca/kernel/mcusher.html#Swap.propose_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smol.moca.kernel.mcusher.Swap.propose_step" title="Link to this definition">#</a></dt>
<dd><p>Propose a single random swap step.</p>
<p>A step is given as a sequence of tuples, where each tuple is of the
form (site index, species code to set)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of tuples each with (index, code)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list(tuple)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="smol.moca.kernel.mcusher.TableFlip">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TableFlip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge_balanced</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_ergodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swap_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smol/moca/kernel/mcusher.html#TableFlip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smol.moca.kernel.mcusher.TableFlip" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MCUsher</span></code></p>
<p>Implementation of table flips.</p>
<p>Use user-specified or auto-calculated flip tables. Does not
check the correctness of the flip tables.</p>
<p>No longer computing and assigning a-priori proabilities
before flip selection, and selects sites instead.</p>
<p>Direct use of this class is not recommended, because the
dict form of the flip table is not very easy to read and
write.</p>
<p>Initialize TableFlip.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattices</strong> (<em>list</em><em> of </em><a class="reference internal" href="sublattice.html#smol.moca.sublattice.Sublattice" title="smol.moca.sublattice.Sublattice"><em>Sublattice</em></a>) – list of Sublattices to propose steps for. Must
be all sublattices, including active and inactive
ones.</p></li>
<li><p><strong>rng</strong> (<em>np.Generator</em>) – optional
The given PRNG must be the same instance as that used by the
kernel and any bias terms, otherwise reproducibility will be
compromised.</p></li>
<li><p><strong>flip_table</strong> (<em>2D np.ndarray</em><em>[</em><em>int</em><em>]</em>) – Flip vectors in “n” format, as generated by a CompositionSpace.
If not given, we will initialize a CompositionSpace from
sublattice information, and calculate the flip table
with that CompositionSpace.
Notice:
1, We suggest you provide a pre-computed flip table, unless
the number of sites in sub-lattices can be reduced to very
small when divided with their GCD.
2, As implemented in the Sublattice class,
you are allowed to have multiple species on an inactive
sub-lattice, but it is not the suggested approach.
In this case, you have 3 choices. Either always try to split
until all inactive sub-lattices only have one species
(suggested), fixing number of inactive species as a
constraint, or pre-compute your own flip table.</p></li>
<li><p><strong>charge_balanced</strong> (<em>bool</em>) – optional
Whether to add charge balance constraint. Default
to true.</p></li>
<li><p><strong>other_constraints</strong> (<em>List</em><em>[</em><em>tuple</em><em>(</em><em>1D arrayLike</em><em>[</em><em>int</em><em>]</em><em>, </em><em>int</em><em>)</em><em>]</em>) – optional
Other integer constraints except charge balance and
site-number conservation. Should be given in the form of
tuple(a, bb), each gives constraint np.dot(a, n)=bb.</p></li>
<li><p><strong>optimize_basis</strong> (<em>bool</em>) – optional
Whether to optimize the basis to minimal flip sizes and maximal
connectivity in the minimum super-cell size.
When the minimal super-cell size is large, we recommend not to
optimize basis.</p></li>
<li><p><strong>table_ergodic</strong> (<em>bool</em>) – optional
When generating a flip table, whether to add vectors and
ensure ergodicity under a minimal super-cell size.
Default to False.
When the minimal super-cell size is large, we recommend not to
ensure ergodicity. This is not only because of the computation
difficulty; but also because at large super-cell size,
the fraction of inaccessible compositions usually becomes
minimal.</p></li>
<li><p><strong>swap_weight</strong> (<em>float</em>) – optional
Percentage of canonical swaps to attempt. Should be a
positive value, but smaller than 1.
Default to 0.1.</p></li>
<li><p><strong>flip_weights</strong> (<em>1D Arraylike</em>) – optional
Weights to adjust probability of each flip. If
None given, will assign equal weights to each
flip vector and its inverse. Length must equal to
2*len(flip_table).</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In table flip, adding proposal bias to different
sub-lattices is not meaningful. We will always assign
sub-lattice probabilities as equal.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="smol.moca.kernel.mcusher.TableFlip.compute_log_priori_factor">
<span class="sig-name descname"><span class="pre">compute_log_priori_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smol/moca/kernel/mcusher.html#TableFlip.compute_log_priori_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smol.moca.kernel.mcusher.TableFlip.compute_log_priori_factor" title="Link to this definition">#</a></dt>
<dd><p>Compute a-priori weight to adjust step acceptance ratio.</p>
<p>This is essential in keeping detailed balance. Return log for
numerical accuracy.</p>
<dl class="simple">
<dt>Arg:</dt><dd><dl class="simple">
<dt>occupancy (ndarray):</dt><dd><p>encoded occupancy string. (Processor encoding.)</p>
</dd>
<dt>step (list[tuple]):</dt><dd><p>Metropolis step. list of tuples each with (index, code).
(Processor encoding.)</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>log of a-priori adjustment ratio.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="smol.moca.kernel.mcusher.TableFlip.propose_step">
<span class="sig-name descname"><span class="pre">propose_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smol/moca/kernel/mcusher.html#TableFlip.propose_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smol.moca.kernel.mcusher.TableFlip.propose_step" title="Link to this definition">#</a></dt>
<dd><p>Propose a single random flip step.</p>
<p>A step is given as a sequence of tuples, where each tuple is of the
form (site index, species code to set)</p>
<p>1, Pick a flip in table;
2, Choose sites from site specie statistics list according to the flip.
3, (Acceptance proability will be adjusted according to a-priori</p>
<blockquote>
<div><p>weight to enforce detailed balance.)</p>
</div></blockquote>
<dl class="simple">
<dt>4, If selection failed, may or may not attempt a canonical swap based</dt><dd><p>on self.add_swap parameter.</p>
</dd>
</dl>
<p>There are circumstances where the current occupancy can not be accessed
by minimal table flips. This method does not take care of that, please
be careful when choosing starting compositions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of tuples each with (idex, code).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list(tuple)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="smol.moca.kernel.mcusher.mcusher_factory">
<span class="sig-name descname"><span class="pre">mcusher_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">usher_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smol/moca/kernel/mcusher.html#mcusher_factory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#smol.moca.kernel.mcusher.mcusher_factory" title="Link to this definition">#</a></dt>
<dd><p>Get a MC Usher from string name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>usher_type</strong> (<em>str</em>) – string specifying step to instantiate.</p></li>
<li><p><strong>sublattices</strong> (<em>list</em><em> of </em><a class="reference internal" href="sublattice.html#smol.moca.sublattice.Sublattice" title="smol.moca.sublattice.Sublattice"><em>Sublattice</em></a>) – list of Sublattices to propose steps for.</p></li>
<li><p><strong>*args</strong> – positional arguments passed to class constructor</p></li>
<li><p><strong>**kwargs</strong> – keyword arguments passed to class constructor</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>instance of derived class.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>MCUsher</p>
</dd>
</dl>
</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="kernel.kernels.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">MCKernels</p>
      </div>
    </a>
    <a class="right-next"
       href="kernel.bias.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Sampling Bias</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smol.moca.kernel.mcusher.Composite"><code class="docutils literal notranslate"><span class="pre">Composite</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smol.moca.kernel.mcusher.Composite.add_mcusher"><code class="docutils literal notranslate"><span class="pre">Composite.add_mcusher()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smol.moca.kernel.mcusher.Composite.mcushers"><code class="docutils literal notranslate"><span class="pre">Composite.mcushers</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smol.moca.kernel.mcusher.Composite.propose_step"><code class="docutils literal notranslate"><span class="pre">Composite.propose_step()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smol.moca.kernel.mcusher.Composite.weight"><code class="docutils literal notranslate"><span class="pre">Composite.weight</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smol.moca.kernel.mcusher.Flip"><code class="docutils literal notranslate"><span class="pre">Flip</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smol.moca.kernel.mcusher.Flip.propose_step"><code class="docutils literal notranslate"><span class="pre">Flip.propose_step()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smol.moca.kernel.mcusher.MultiStep"><code class="docutils literal notranslate"><span class="pre">MultiStep</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smol.moca.kernel.mcusher.MultiStep.propose_step"><code class="docutils literal notranslate"><span class="pre">MultiStep.propose_step()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smol.moca.kernel.mcusher.MultiStep.sublattice_probabilities"><code class="docutils literal notranslate"><span class="pre">MultiStep.sublattice_probabilities</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smol.moca.kernel.mcusher.Swap"><code class="docutils literal notranslate"><span class="pre">Swap</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smol.moca.kernel.mcusher.Swap.propose_step"><code class="docutils literal notranslate"><span class="pre">Swap.propose_step()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smol.moca.kernel.mcusher.TableFlip"><code class="docutils literal notranslate"><span class="pre">TableFlip</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smol.moca.kernel.mcusher.TableFlip.compute_log_priori_factor"><code class="docutils literal notranslate"><span class="pre">TableFlip.compute_log_priori_factor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smol.moca.kernel.mcusher.TableFlip.propose_step"><code class="docutils literal notranslate"><span class="pre">TableFlip.propose_step()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smol.moca.kernel.mcusher.mcusher_factory"><code class="docutils literal notranslate"><span class="pre">mcusher_factory()</span></code></a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  
  <div class="tocsection editthispage">
    <a href="https://github.com/CederGroupHub/smol/edit/main/docs/src/api_reference/moca/kernel.mcusher.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="footer-content-items footer-content__inner">
  
    <div class="footer-content-item"><p class="last-updated">
  Last updated on Sep 20, 2023.
  <br/>
</p></div>
  
</div>

          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2022-2023, Ceder Group.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>