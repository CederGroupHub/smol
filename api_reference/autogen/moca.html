
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>moca package &#8212; smol v0.0.1 documentation</title>
    
    <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/smol.css" />
    
    <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/logo.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../getting_started.html">
  Getting Started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../user_guide/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../index.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../citing.html">
  Citing
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../developer_guide/index.html">
  Developing
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/CederGroupHub/smol/blob/master/CHANGES.md">Changes<i class="fas fa-external-link-alt"></i></a>
    </li>
    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/CederGroupHub/smol/issues">Issues<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        v0.0.1  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables api_reference/autogen/moca and {'json_url': 'https://pydata-sphinx-theme.readthedocs.io/en/latest/_static/switcher.json', 'url_template': 'https://pydata-sphinx-theme.readthedocs.io/en/v{version}/', 'version_match': 'v0.0.1'}.
-->

<script type="text/javascript">
// Construct the target URL from the JSON components
function buildURL(entry) {
    var template = "https://pydata-sphinx-theme.readthedocs.io/en/v{version}/";  // supplied by jinja
    template = template.replace("{version}", entry.version);
    return template;
}

// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "api_reference/autogen/moca.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("https://pydata-sphinx-theme.readthedocs.io/en/latest/_static/switcher.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "api_reference/autogen/moca.html";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            // get the base URL for that doc version, add the current page's
            // path to it, and set as `href`
            entry.url = buildURL(entry);
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's v0.0.1 variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "v0.0.1") {
                node.classList.add("active");
                $("#version_switcher_button").text(entry.name);
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/CederGroupHub/smol" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="moca.ensemble.html">
   moca.ensemble package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="moca.processor.html">
   moca.processor package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="moca.sampler.html">
   moca.sampler package
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#subpackages">
   Subpackages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submodules">
   Submodules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-moca.sublattice">
   moca.sublattice module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-moca">
   Module contents
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/CederGroupHub/smol/edit/main/docs/api_reference/autogen/moca.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="moca-package">
<h1>moca package<a class="headerlink" href="#moca-package" title="Permalink to this headline">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="moca.ensemble.html">moca.ensemble package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="moca.ensemble.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="moca.ensemble.html#module-moca.ensemble.base">moca.ensemble.base module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moca.ensemble.html#module-moca.ensemble.canonical">moca.ensemble.canonical module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moca.ensemble.html#module-moca.ensemble.semigrand">moca.ensemble.semigrand module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moca.ensemble.html#module-moca.ensemble">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="moca.processor.html">moca.processor package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="moca.processor.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="moca.processor.html#module-moca.processor.base">moca.processor.base module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moca.processor.html#module-moca.processor.composite">moca.processor.composite module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moca.processor.html#module-moca.processor.ewald">moca.processor.ewald module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moca.processor.html#module-moca.processor.expansion">moca.processor.expansion module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moca.processor.html#module-moca.processor">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="moca.sampler.html">moca.sampler package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="moca.sampler.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="moca.sampler.html#module-moca.sampler.bias">moca.sampler.bias module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moca.sampler.html#module-moca.sampler.container">moca.sampler.container module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moca.sampler.html#module-moca.sampler.kernel">moca.sampler.kernel module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moca.sampler.html#module-moca.sampler.mcusher">moca.sampler.mcusher module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moca.sampler.html#module-moca.sampler.sampler">moca.sampler.sampler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="moca.sampler.html#module-moca.sampler">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-moca.sublattice">
<span id="moca-sublattice-module"></span><h2>moca.sublattice module<a class="headerlink" href="#module-moca.sublattice" title="Permalink to this headline">¶</a></h2>
<p>Implementation of Sublattice class.</p>
<p>A sublattice represents a set of sites in a supercell that all have
the same domain/site space. More rigourously it represents a substructure
of the random structure supercell being sampled in a Monte Carlo
simulation.</p>
<dl class="py class">
<dt class="sig sig-object py" id="moca.sublattice.Sublattice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Sublattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">site_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../cofe/space.domain.html#smol.cofe.space.domain.SiteSpace" title="smol.cofe.space.domain.SiteSpace"><span class="pre">smol.cofe.space.domain.SiteSpace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sublattice.Sublattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>Sublattice class.</p>
<p>A Sublattice is used to represent a subset of supercell sites that have
the same site space. Rigorously it represents a set of sites in a
“substructure” of the total structure.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sublattice.Sublattice.site_space">
<span class="sig-name descname"><span class="pre">site_space</span></span><a class="headerlink" href="#moca.sublattice.Sublattice.site_space" title="Permalink to this definition">¶</a></dt>
<dd><p>SiteSpace with the allowed species and their random
state composition.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="cofe.space.html#cofe.space.domain.SiteSpace" title="cofe.space.domain.SiteSpace">SiteSpace</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sublattice.Sublattice.sites">
<span class="sig-name descname"><span class="pre">sites</span></span><a class="headerlink" href="#moca.sublattice.Sublattice.sites" title="Permalink to this definition">¶</a></dt>
<dd><p>array of site indices for all sites in sublattice</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sublattice.Sublattice.active_sites">
<span class="sig-name descname"><span class="pre">active_sites</span></span><a class="headerlink" href="#moca.sublattice.Sublattice.active_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>array of site indices for all unrestricted sites in the sublattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sublattice.Sublattice.encoding">
<span class="sig-name descname"><span class="pre">encoding</span></span><a class="headerlink" href="#moca.sublattice.Sublattice.encoding" title="Permalink to this definition">¶</a></dt>
<dd><p>array of species encoding in integer indices. By default,
will be initialized as range(len(site_space)). Might be different
if a sub-lattice was created from the split of another sub-lattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">active_sites</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.array</span></em><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sublattice.Sublattice.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#moca.sublattice.Sublattice.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get Json-serialization dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>MSONable dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">encoding</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.array</span></em><a class="headerlink" href="#id1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sublattice.Sublattice.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sublattice.Sublattice.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a sublattice from dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Sublattice</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sublattice.Sublattice.is_active">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_active</span></span><a class="headerlink" href="#moca.sublattice.Sublattice.is_active" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether sub-lattice has active sites.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sublattice.Sublattice.reset_restricted_sites">
<span class="sig-name descname"><span class="pre">reset_restricted_sites</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#moca.sublattice.Sublattice.reset_restricted_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset all restricted sites to active.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sublattice.Sublattice.restrict_sites">
<span class="sig-name descname"><span class="pre">restrict_sites</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sites</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sublattice.Sublattice.restrict_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Restricts (freezes) the given sites.</p>
<p>Once a site is restricted, no Metropolis step can be proposed
with it, including flipping, swapping, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sites</strong> (<em>Sequence</em>) – indices of sites in the occupancy string to restrict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sublattice.Sublattice.restricted_sites">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">restricted_sites</span></span><a class="headerlink" href="#moca.sublattice.Sublattice.restricted_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Get restricted sites for species.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">site_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../cofe/space.domain.html#smol.cofe.space.domain.SiteSpace" title="smol.cofe.space.domain.SiteSpace"><span class="pre">smol.cofe.space.domain.SiteSpace</span></a></em><a class="headerlink" href="#id2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">sites</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.array</span></em><a class="headerlink" href="#id3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sublattice.Sublattice.species">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">species</span></span><a class="headerlink" href="#moca.sublattice.Sublattice.species" title="Permalink to this definition">¶</a></dt>
<dd><p>Get allowed species for sites in sublattice.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sublattice.Sublattice.split_by_species">
<span class="sig-name descname"><span class="pre">split_by_species</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_in_partitions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sublattice.Sublattice.split_by_species" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a sub-lattice into multiple by specie.</p>
<p>An example use case might be simulating topotactic Li extraction
and insertion, where we want to consider Li/Vac, TM and O as
different sub-lattices that can not be mixed by swapping.
:param occu: An occupancy array to reference with.
:type occu: np.ndarray[int]
:param species_in_partitions: Each sub-list contains a few species or encodings of species in</p>
<blockquote>
<div><p>the site space to be grouped as a new sub-lattice, namely,
sites with occu[sites] == specie in the sub-list, will be
used to initialize a new sub-lattice.
Sub-lists will be pre-sorted to ascending order.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List[Sublattice]</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>List of split sub-lattices</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-moca">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-moca" title="Permalink to this headline">¶</a></h2>
<p>Class implementations for ClusterExpansion based Monte Carlo.</p>
<p>The moca (pronounced mocha) holds implementations of classes used to run
Monte Carlo simulations using Cluster Expansion Hamiltonians.</p>
<dl class="py class">
<dt class="sig sig-object py" id="moca.CanonicalEnsemble">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CanonicalEnsemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sublattices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.CanonicalEnsemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../moca/ensembles.base.html#smol.moca.ensemble.base.Ensemble" title="smol.moca.ensemble.base.Ensemble"><code class="xref py py-class docutils literal notranslate"><span class="pre">smol.moca.ensemble.base.Ensemble</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>Canonical Ensemble class to run Monte Carlo Simulations.</p>
<p>Initialize class instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processor</strong> (<a class="reference internal" href="moca.processor.html#moca.processor.base.Processor" title="moca.processor.base.Processor"><em>Processor</em></a>) – a processor that can compute the change in property given
a set of flips.</p></li>
<li><p><strong>sublattices</strong> (<em>list of Sublattice</em>) – optional
list of Sublattice objects representing sites in the processor
supercell with same site spaces.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.CanonicalEnsemble.compute_feature_vector">
<span class="sig-name descname"><span class="pre">compute_feature_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.CanonicalEnsemble.compute_feature_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the feature vector for a given occupancy.</p>
<p>In the canonical case it is just the feature vector from the underlying
processor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy string</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>feature vector</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.CanonicalEnsemble.compute_feature_vector_change">
<span class="sig-name descname"><span class="pre">compute_feature_vector_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.CanonicalEnsemble.compute_feature_vector_change" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the change in the feature vector from a given step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy string.</p></li>
<li><p><strong>step</strong> (<em>list of tuple</em>) – A sequence of flips as given by MCUsher.propose_step</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>difference in feature vector</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.CanonicalEnsemble.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.CanonicalEnsemble.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a CanonicalEnsemble from dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>d</strong> (<em>dict</em>) – dictionary representation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>CanonicalEnsemble</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.CanonicalEnsemble.natural_parameters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">natural_parameters</span></span><a class="headerlink" href="#moca.CanonicalEnsemble.natural_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the vector of exponential parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.CanonicalEnsemble.valid_mcmc_steps">
<span class="sig-name descname"><span class="pre">valid_mcmc_steps</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('swap',)</span></em><a class="headerlink" href="#moca.CanonicalEnsemble.valid_mcmc_steps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.ClusterExpansionProcessor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ClusterExpansionProcessor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_subspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefficients</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.ClusterExpansionProcessor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../moca/processors.base.html#smol.moca.processor.base.Processor" title="smol.moca.processor.base.Processor"><code class="xref py py-class docutils literal notranslate"><span class="pre">smol.moca.processor.base.Processor</span></code></a></p>
<p>ClusterExpansionProcessor class to use a ClusterExpansion in MC.</p>
<p>A CE processor is optimized to compute correlation vectors and local
changes in correlation vectors. This class allows the use of a CE
Hamiltonian to run Monte Carlo-based simulations</p>
<p>A processor that allows an Ensemble class to generate a Markov chain
for sampling thermodynamic properties from a CE Hamiltonian.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="moca.ClusterExpansionProcessor.coefs">
<span class="sig-name descname"><span class="pre">coefs</span></span><a class="headerlink" href="#moca.ClusterExpansionProcessor.coefs" title="Permalink to this definition">¶</a></dt>
<dd><p>Fitted coefficients from the cluster expansion.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.ClusterExpansionProcessor.num_corr_functions">
<span class="sig-name descname"><span class="pre">num_corr_functions</span></span><a class="headerlink" href="#moca.ClusterExpansionProcessor.num_corr_functions" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of orbit basis functions (correlation functions).
This includes all possible labelings/orderings for all orbits.
Same as <code class="code docutils literal notranslate"><span class="pre">ClusterSubspace.n_bit_orderings</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>Initialize a ClusterExpansionProcessor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster_subspace</strong> (<a class="reference internal" href="cofe.html#cofe.ClusterSubspace" title="cofe.ClusterSubspace"><em>ClusterSubspace</em></a>) – a cluster subspace</p></li>
<li><p><strong>supercell_matrix</strong> (<em>ndarray</em>) – an array representing the supercell matrix with respect to the
Cluster Expansion prim structure.</p></li>
<li><p><strong>coefficients</strong> (<em>ndarray</em>) – fit coefficients for the represented cluster expansion.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.ClusterExpansionProcessor.compute_feature_vector">
<span class="sig-name descname"><span class="pre">compute_feature_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.ClusterExpansionProcessor.compute_feature_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the correlation vector for a given occupancy string.</p>
<p>The correlation vector in this case is normalized per supercell. In
other works it is extensive corresponding to the size of the supercell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupation array</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>correlation vector</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.ClusterExpansionProcessor.compute_feature_vector_change">
<span class="sig-name descname"><span class="pre">compute_feature_vector_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flips</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.ClusterExpansionProcessor.compute_feature_vector_change" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the change in the correlation vector from a list of flips.</p>
<p>The correlation vector in this case is normalized per supercell. In
other works it is extensive corresponding to the size of the supercell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy string</p></li>
<li><p><strong>flips</strong> (<em>list of tuple</em>) – list of tuples with two elements. Each tuple represents a
single flip where the first element is the index of the site
in the occupancy string and the second element is the index
for the new species to place at that site.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>change in correlation vector</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.ClusterExpansionProcessor.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.ClusterExpansionProcessor.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a ClusterExpansionProcessor from serialized MSONable dict.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.CompositeProcessor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CompositeProcessor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_subspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell_matrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.CompositeProcessor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../moca/processors.base.html#smol.moca.processor.base.Processor" title="smol.moca.processor.base.Processor"><code class="xref py py-class docutils literal notranslate"><span class="pre">smol.moca.processor.base.Processor</span></code></a></p>
<p>CompositeProcessor class used for mixed models.</p>
<p>A Composite processor is merely a container for many different processors
that acts as an interface such that it can be used in the same way as an
individual processor. This can be used to mix models in any way that your
heart desires.</p>
<p>The most common use case is a CompositeProcessor of a
ClusterExpansionProcessor and an EwaldProcessor for use in ionic materials
when the cluster expansion contains an Ewald term.</p>
<p>You can add any of the other processor class implemented to build a
composite processor.</p>
<p>It is recommended to use the <code class="code docutils literal notranslate"><span class="pre">from_cluster_expansion</span></code> to create an
ensemble and the underlying processor automatically created rather than
directly creating a processor. This will take care of creating the correct
<a class="reference internal" href="#moca.CompositeProcessor" title="moca.CompositeProcessor"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompositeProcessor</span></code></a> or <a class="reference internal" href="#moca.ClusterExpansionProcessor" title="moca.ClusterExpansionProcessor"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterExpansionProcessor</span></code></a> for you.</p>
<p>Initialize a CompositeProcessor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster_subspace</strong> (<a class="reference internal" href="cofe.html#cofe.ClusterSubspace" title="cofe.ClusterSubspace"><em>ClusterSubspace</em></a>) – a cluster subspace</p></li>
<li><p><strong>supercell_matrix</strong> (<em>ndarray</em>) – an array representing the supercell matrix with respect to the
cluster expansion prim structure.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.CompositeProcessor.add_processor">
<span class="sig-name descname"><span class="pre">add_processor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.CompositeProcessor.add_processor" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a processor to composite.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>processor</strong> (<a class="reference internal" href="moca.processor.html#moca.processor.base.Processor" title="moca.processor.base.Processor"><em>Processor</em></a>) – processor to add. All processors must have the same
ClusterSubspace and supercell matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.CompositeProcessor.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#moca.CompositeProcessor.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Json-serialization dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>MSONable dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.CompositeProcessor.compute_feature_vector">
<span class="sig-name descname"><span class="pre">compute_feature_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.CompositeProcessor.compute_feature_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the feature vector for a given occupancy array.</p>
<p>Each entry in the correlation vector corresponds to a particular
symmetrically distinct bit ordering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupation array</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>correlation vector</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.CompositeProcessor.compute_feature_vector_change">
<span class="sig-name descname"><span class="pre">compute_feature_vector_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flips</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.CompositeProcessor.compute_feature_vector_change" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the change in the feature vector from a list of flips.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy array</p></li>
<li><p><strong>flips</strong> (<em>list of tuple</em>) – list of tuples with two elements. Each tuple represents a
single flip where the first element is the index of the site
in the occupancy array and the second element is the index
for the new species to place at that site.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>change in feature vector</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.CompositeProcessor.compute_property">
<span class="sig-name descname"><span class="pre">compute_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.CompositeProcessor.compute_property" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the value of the property for the given occupancy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy array</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predicted property</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.CompositeProcessor.compute_property_change">
<span class="sig-name descname"><span class="pre">compute_property_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flips</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.CompositeProcessor.compute_property_change" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the change in property from a set of flips.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy array</p></li>
<li><p><strong>flips</strong> (<em>list</em>) – list of tuples for (index of site, specie code to set)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>property difference between inital and final states</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.CompositeProcessor.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.CompositeProcessor.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a CompositeProcessor from serialized MSONable dict.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.CompositeProcessor.processors">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">processors</span></span><a class="headerlink" href="#moca.CompositeProcessor.processors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of processors in CompositeProcessor.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.EwaldProcessor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">EwaldProcessor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_subspace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ewald_term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefficient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.EwaldProcessor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../moca/processors.base.html#smol.moca.processor.base.Processor" title="smol.moca.processor.base.Processor"><code class="xref py py-class docutils literal notranslate"><span class="pre">smol.moca.processor.base.Processor</span></code></a></p>
<p>Processor for CE’s including an EwaldTerm.</p>
<p>A Processor class that handles changes for the electrostatic interaction
energy using an Ewald Summation term.</p>
<p>Initialize an EwaldProcessor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster_subspace</strong> (<a class="reference internal" href="cofe.html#cofe.ClusterSubspace" title="cofe.ClusterSubspace"><em>ClusterSubspace</em></a>) – a cluster subspace.</p></li>
<li><p><strong>supercell_matrix</strong> (<em>ndarray</em>) – an array representing the supercell matrix with respect to the
Cluster Expansion prim structure.</p></li>
<li><p><strong>ewald_term</strong> (<a class="reference internal" href="cofe.extern.html#cofe.extern.ewald.EwaldTerm" title="cofe.extern.ewald.EwaldTerm"><em>EwaldTerm</em></a>) – an instance of EwaldTerm to compute electrostatic energies.</p></li>
<li><p><strong>coefficient</strong> (<em>float</em>) – Fitting coefficient to scale Ewald energy by.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.EwaldProcessor.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#moca.EwaldProcessor.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Json-serialization dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>MSONable dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.EwaldProcessor.compute_feature_vector">
<span class="sig-name descname"><span class="pre">compute_feature_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.EwaldProcessor.compute_feature_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the feature vector for a given occupancy array.</p>
<p>Each entry in the correlation vector corresponds to a particular
symmetrically distinct bit ordering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupation array</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>correlation vector</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.EwaldProcessor.compute_feature_vector_change">
<span class="sig-name descname"><span class="pre">compute_feature_vector_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flips</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.EwaldProcessor.compute_feature_vector_change" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the change in the feature vector from a list of flips.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy string</p></li>
<li><p><strong>flips</strong> (<em>list of tuple</em>) – list of tuples with two elements. Each tuple represents a
single flip where the first element is the index of the site
in the occupancy string and the second element is the index
for the new species to place at that site.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>change in correlation vector</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.EwaldProcessor.compute_property">
<span class="sig-name descname"><span class="pre">compute_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.EwaldProcessor.compute_property" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Ewald electrostatic energy for a given occupancy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy array</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Ewald electrostatic energy</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.EwaldProcessor.compute_property_change">
<span class="sig-name descname"><span class="pre">compute_property_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flips</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.EwaldProcessor.compute_property_change" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute change in electrostatic energy from a set of flips.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy array</p></li>
<li><p><strong>flips</strong> (<em>list</em>) – list of tuples for (index of site, specie code to set)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>electrostatic energy change</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.EwaldProcessor.ewald_matrix">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ewald_matrix</span></span><a class="headerlink" href="#moca.EwaldProcessor.ewald_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the electrostatic interaction matrix.</p>
<p>The matrix used is the one set in the EwaldTerm of the given
ClusterExpansion.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.EwaldProcessor.ewald_summation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ewald_summation</span></span><a class="headerlink" href="#moca.EwaldProcessor.ewald_summation" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the pymatgen EwaldSummation object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.EwaldProcessor.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.EwaldProcessor.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a EwaldProcessor from serialized MSONable dict.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.SampleContainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SampleContainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natural_parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_energy_coefs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>A SampleContainer class stores Monte Carlo simulation samples.</p>
<p>A SampleContainer holds samples and sampling information from an MCMC
sampling run. It is useful to obtain the raw data and minimal empirical
properties of the underlying distribution in order to carry out further
analysis of the MCMC sampling results.</p>
<p>When getting any value from the provided attributes, the highly repeated
args are:</p>
<blockquote>
<div><dl class="simple">
<dt>discard (int): optional</dt><dd><p>number of samples to discard to obtain the value requested.</p>
</dd>
<dt>thin_by (int): optional</dt><dd><p>use every thin_by sample to obtain the value requested.</p>
</dd>
<dt>flat (bool): optional</dt><dd><p>if more than 1 walker is used, flattening will flatten all
chains into one. Defaults to True.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="moca.SampleContainer.num_sites">
<span class="sig-name descname"><span class="pre">num_sites</span></span><a class="headerlink" href="#moca.SampleContainer.num_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of system (usually in number of prims in supercell, but
can be anything representative, i.e. number of sites)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.SampleContainer.sublattices">
<span class="sig-name descname"><span class="pre">sublattices</span></span><a class="headerlink" href="#moca.SampleContainer.sublattices" title="Permalink to this definition">¶</a></dt>
<dd><p>Sublattices of the ensemble sampled.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of Sublattice</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.SampleContainer.natural_parameters">
<span class="sig-name descname"><span class="pre">natural_parameters</span></span><a class="headerlink" href="#moca.SampleContainer.natural_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of natural parameters used in the ensemble.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.SampleContainer.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><a class="headerlink" href="#moca.SampleContainer.metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of metadata from the MC run that generated the samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<p>Initialize a sample container.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattices</strong> (<em>list of Sublattice</em>) – Sublattices of the ensemble sampled.</p></li>
<li><p><strong>natural_parameters</strong> (<em>ndarray</em>) – array of natural parameters used in the ensemble.</p></li>
<li><p><strong>num_energy_coefs</strong> (<em>int</em>) – the number of coefficients in the natural parameters that
correspond to the energy only.</p></li>
<li><p><strong>sample_trace</strong> (<a class="reference internal" href="moca.sampler.html#moca.sampler.kernel.Trace" title="moca.sampler.kernel.Trace"><em>Trace</em></a>) – a trace object for the traced values during MC sampling</p></li>
<li><p><strong>sampling_metadata</strong> (<a class="reference internal" href="moca.ensemble.html#moca.ensemble.base.Ensemble" title="moca.ensemble.base.Ensemble"><em>Ensemble</em></a>) – sampling metadata (i.e. ensemble name, mckernel type, etc)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.allocate">
<span class="sig-name descname"><span class="pre">allocate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsamples</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.allocate" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate more space in arrays for more samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get Json-serialization dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>MSONable dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear all samples from container.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.composition_variance">
<span class="sig-name descname"><span class="pre">composition_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.composition_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the variance in composition of all species.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.energy_variance">
<span class="sig-name descname"><span class="pre">energy_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.energy_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the variance of sampled energies.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.enthalpy_variance">
<span class="sig-name descname"><span class="pre">enthalpy_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.enthalpy_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the variance in enthalpy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.feature_vector_variance">
<span class="sig-name descname"><span class="pre">feature_vector_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.feature_vector_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the variance of feature vector elements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.flush_to_backend">
<span class="sig-name descname"><span class="pre">flush_to_backend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backend</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.flush_to_backend" title="Permalink to this definition">¶</a></dt>
<dd><p>Flush current samples and trace to backend file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>backend</strong> (<em>object</em>) – backend file object, currently only hdf5 supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a SampleContainer from dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>d</strong> (<em>dict</em>) – dictionary representation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Sublattice</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.from_hdf5">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swmr_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.from_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a SampleContainer from an hdf5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>str</em>) – path to file</p></li>
<li><p><strong>swmr_mode</strong> (<em>bool</em>) – optional
If true allows to read file from other processes. Single Writer
Multiple Readers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>SampleContainer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.get_backend">
<span class="sig-name descname"><span class="pre">get_backend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alloc_nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swmr_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.get_backend" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a backend file object.</p>
<p>Currently only hdf5 files supported</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>str</em>) – path to backend file.</p></li>
<li><p><strong>alloc_nsamples</strong> (<em>int</em>) – optional
number of new samples to allocate. Will only extend datasets
if number given is larger than space left to write samples
into.</p></li>
<li><p><strong>swmr_mode</strong> (<em>bool</em>) – optional
If true allows to read file from other processes. Single Writer
Multiple Readers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>h5.File object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.get_compositions">
<span class="sig-name descname"><span class="pre">get_compositions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.get_compositions" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the compositions for each occupancy in the chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.get_energies">
<span class="sig-name descname"><span class="pre">get_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.get_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the energies from samples in chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.get_enthalpies">
<span class="sig-name descname"><span class="pre">get_enthalpies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.get_enthalpies" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the generalized enthalpy changes from samples in chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.get_feature_vectors">
<span class="sig-name descname"><span class="pre">get_feature_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.get_feature_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the feature vector changes from samples in chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.get_minimum_energy">
<span class="sig-name descname"><span class="pre">get_minimum_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.get_minimum_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the minimum energy from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.get_minimum_energy_occupancy">
<span class="sig-name descname"><span class="pre">get_minimum_energy_occupancy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.get_minimum_energy_occupancy" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the occupancy with minimum energy from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.get_minimum_enthalpy">
<span class="sig-name descname"><span class="pre">get_minimum_enthalpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.get_minimum_enthalpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the minimum energy from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.get_minimum_enthalpy_occupancy">
<span class="sig-name descname"><span class="pre">get_minimum_enthalpy_occupancy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.get_minimum_enthalpy_occupancy" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the occupancy with minimum energy from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.get_occupancies">
<span class="sig-name descname"><span class="pre">get_occupancies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.get_occupancies" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the occupancy chain of the samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.get_species_counts">
<span class="sig-name descname"><span class="pre">get_species_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.get_species_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the species counts for each occupancy in the chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.get_sublattice_compositions">
<span class="sig-name descname"><span class="pre">get_sublattice_compositions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.get_sublattice_compositions" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the compositions of a specific sublattice.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.get_sublattice_species_counts">
<span class="sig-name descname"><span class="pre">get_sublattice_species_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.get_sublattice_species_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the counts of each species in a sublattices.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>where last axis is the count for each species in the
same order as the underlying site space.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.get_trace_value">
<span class="sig-name descname"><span class="pre">get_trace_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.get_trace_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Get sampled values of a traced value given by name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.mean_composition">
<span class="sig-name descname"><span class="pre">mean_composition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.mean_composition" title="Permalink to this definition">¶</a></dt>
<dd><p>Get mean composition for all species regardless of sublattice.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.mean_energy">
<span class="sig-name descname"><span class="pre">mean_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.mean_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the mean energy from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.mean_enthalpy">
<span class="sig-name descname"><span class="pre">mean_enthalpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.mean_enthalpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the mean generalized enthalpy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.mean_feature_vector">
<span class="sig-name descname"><span class="pre">mean_feature_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.mean_feature_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the mean feature vector from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.mean_sublattice_composition">
<span class="sig-name descname"><span class="pre">mean_sublattice_composition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.mean_sublattice_composition" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the mean composition of a specific sublattice.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.mean_trace_value">
<span class="sig-name descname"><span class="pre">mean_trace_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.mean_trace_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Get mean of a traced value given by name.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.SampleContainer.num_samples">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_samples</span></span><a class="headerlink" href="#moca.SampleContainer.num_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the total number of samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.sampling_efficiency">
<span class="sig-name descname"><span class="pre">sampling_efficiency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.sampling_efficiency" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sampling efficiency for chains.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.save_sampled_trace">
<span class="sig-name descname"><span class="pre">save_sampled_trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thinned_by</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.save_sampled_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a sampled trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<a class="reference internal" href="moca.sampler.html#moca.sampler.kernel.Trace" title="moca.sampler.kernel.Trace"><em>Trace</em></a>) – Trace of sampled values</p></li>
<li><p><strong>thinned_by</strong> (<em>int</em>) – the amount that the sampling was thinned by. Used to update
the total mc iterations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.SampleContainer.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#moca.SampleContainer.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the shape of the samples in chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.sublattice_composition_variance">
<span class="sig-name descname"><span class="pre">sublattice_composition_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.sublattice_composition_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the variance in composition of a specific sublattice.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.to_hdf5">
<span class="sig-name descname"><span class="pre">to_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Save SampleContainer as an HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>str</em>) – path to file save location. If file exists and dimensions
match samples will be appended.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.SampleContainer.total_mc_steps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_mc_steps</span></span><a class="headerlink" href="#moca.SampleContainer.total_mc_steps" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the total number of MC steps taken during sampling.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SampleContainer.trace_value_variance">
<span class="sig-name descname"><span class="pre">trace_value_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SampleContainer.trace_value_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Get variance of a traced value given by name.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.SampleContainer.traced_values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">traced_values</span></span><a class="headerlink" href="#moca.SampleContainer.traced_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the names of traced values being sampled.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.Sampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.Sampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A sampler is used to run MCMC sampling simulations.</p>
<p>The specific MCMC algorithm is defined by the given MCKernel.
The default will use a simple Metropolis random walk kernel.</p>
<p>Initialize BaseSampler.</p>
<p>It is recommended to initialize a sampler with the from_ensemble
method, unless you need more control over the sampling kernel,
mcusher, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel</strong> (<a class="reference internal" href="moca.sampler.html#moca.sampler.kernel.MCKernel" title="moca.sampler.kernel.MCKernel"><em>MCKernel</em></a>) – an MCKernel instance.</p></li>
<li><p><strong>container</strong> (<a class="reference internal" href="#moca.SampleContainer" title="moca.SampleContainer"><em>SampleContainer</em></a>) – a sampler container to store samples.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – optional
seed for random number generator.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.Sampler.anneal">
<span class="sig-name descname"><span class="pre">anneal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperatures</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcmc_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_occupancies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.Sampler.anneal" title="Permalink to this definition">¶</a></dt>
<dd><p>Carry out a simulated annealing procedure.</p>
<p>Uses the total number of temperatures given by “steps” interpolating
between the start and end temperature according to a cooling function.
The start temperature is the temperature set for the ensemble.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperatures</strong> (<em>Sequence</em>) – sequence of temperatures to anneal, should be strictly
decreasing.</p></li>
<li><p><strong>mcmc_steps</strong> (<em>int</em>) – number of Monte Carlo steps to run at each temperature.</p></li>
<li><p><strong>initial_occupancies</strong> (<em>ndarray</em>) – array of occupancies. If None, the last sample will be taken.
You should only provide this the first time you call run.</p></li>
<li><p><strong>thin_by</strong> (<em>int</em>) – optional
amount to thin by for saving samples.</p></li>
<li><p><strong>progress</strong> (<em>bool</em>) – if true will show a progress bar.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.Sampler.clear_samples">
<span class="sig-name descname"><span class="pre">clear_samples</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#moca.Sampler.clear_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear samples from sampler container.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.Sampler.efficiency">
<span class="sig-name descname"><span class="pre">efficiency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.Sampler.efficiency" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the efficiency of MCMC sampling (accepted/total).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.Sampler.from_ensemble">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_ensemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ensemble</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwalkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.Sampler.from_ensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a sampler based on an Ensemble instance.</p>
<p>This is the easier way to set up a Sampler. This will
automatically populate and create an appropriate SampleContainer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ensemble</strong> (<a class="reference internal" href="moca.ensemble.html#moca.ensemble.base.Ensemble" title="moca.ensemble.base.Ensemble"><em>Ensemble</em></a>) – an Ensemble class to obtain sample probabilities from.</p></li>
<li><p><strong>step_type</strong> (<em>str</em>) – optional
type of step to run MCMC with. If not given the default is the
first entry in the Ensemble.valid_mcmc_steps.</p></li>
<li><p><strong>*args</strong> – positional arguments to pass to the MCKernel constructor.
More often than not you want to specify the temperature!</p></li>
<li><p><strong>kernel_type</strong> (<em>str</em>) – optional
string specifying the specific MCMC transition kernel. This
represents the underlying MC algorithm. Currently only
Metropolis is supported.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – optional
seed for the PRNG.</p></li>
<li><p><strong>nwalkers</strong> (<em>int</em>) – optional
number of walkers/chains to sampler. Default is 1. More than 1
is still experimental…</p></li>
<li><p><strong>**kwargs</strong> – keyword arguments to pass to the MCKernel constructor.
More often than not you want to specify the temperature!</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Sampler</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.Sampler.mckernel">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mckernel</span></span><a class="headerlink" href="#moca.Sampler.mckernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the underlying ensemble.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.Sampler.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_occupancies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_chunk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swmr_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.Sampler.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an MCMC sampling simulation.</p>
<p>This will run and save the samples every thin_by into a
SampleContainer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nsteps</strong> (<em>int</em>) – number of total MC steps.</p></li>
<li><p><strong>initial_occupancies</strong> (<em>ndarray</em>) – array of occupancies. If None, the last sampler will be taken.
You should only provide this the first time you call run. If
you want to reset then you should call reset before to start
a fresh run.</p></li>
<li><p><strong>thin_by</strong> (<em>int</em>) – optional
the amount to thin by for saving samples.</p></li>
<li><p><strong>progress</strong> (<em>bool</em>) – optional
if true will show a progress bar.</p></li>
<li><p><strong>stream_chunk</strong> (<em>int</em>) – optional
chunk of samples to stream into a file. If &gt; 0 samples will
be flushed to backend file in stream_chucks</p></li>
<li><p><strong>stream_file</strong> (<em>str</em>) – optional
file name to use as backend. If file already exists will try
to append to datasets. If not given will create a new file.</p></li>
<li><p><strong>swmr_mode</strong> (<em>bool</em>) – optional
if true allows to read file from other processes. Single Writer
Multiple Readers.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.Sampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_occupancies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.Sampler.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate MCMC samples.</p>
<p>Yield a sampler state every <cite>thin_by</cite> iterations. A state is give by
a tuple of (occupancies, features, enthalpy)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nsteps</strong> (<em>int</em>) – number of iterations to run.</p></li>
<li><p><strong>initial_occupancies</strong> (<em>ndarray</em>) – array of occupancies</p></li>
<li><p><strong>thin_by</strong> (<em>int</em>) – optional
number to thin iterations by and provide samples.</p></li>
<li><p><strong>progress</strong> (<em>bool</em>) – If true will show a progress bar.</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>tuple</em> – accepted, occupancies, features change, enthalpies change</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.Sampler.samples">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">samples</span></span><a class="headerlink" href="#moca.Sampler.samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the SampleContainer.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.Sampler.seed">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#moca.Sampler.seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Seed for the random number generator.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.SemiGrandEnsemble">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SemiGrandEnsemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chemical_potentials</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sublattices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SemiGrandEnsemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="moca.ensemble.html#moca.ensemble.base.Ensemble" title="moca.ensemble.base.Ensemble"><code class="xref py py-class docutils literal notranslate"><span class="pre">moca.ensemble.base.Ensemble</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>Relative chemical potential-based SemiGrand Ensemble.</p>
<p>A Semi-Grand Canonical Ensemble for Monte Carlo simulations where species’
relative chemical potentials are predefined. Note that in the SGC Ensemble
implemented here, only the differences in chemical potentials with
respect to a reference species on each sublattice are fixed, and not the
absolute values. To obtain the absolute values you must calculate the
reference chemical potential and then subtract it from the given values.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="moca.SemiGrandEnsemble.thermo_boundaries">
<span class="sig-name descname"><span class="pre">thermo_boundaries</span></span><a class="headerlink" href="#moca.SemiGrandEnsemble.thermo_boundaries" title="Permalink to this definition">¶</a></dt>
<dd><p>dict of chemical potentials.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<p>Initialize MuSemiGrandEnsemble.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>processor</strong> (<a class="reference internal" href="moca.processor.html#moca.processor.base.Processor" title="moca.processor.base.Processor"><em>Processor</em></a>) – a processor that can compute the change in property given
a set of flips.</p></li>
<li><p><strong>chemical_potentials</strong> (<em>dict</em>) – Dictionary with species and chemical potentials.</p></li>
<li><p><strong>sublattices</strong> (<em>list of Sublattice</em>) – optional
list of Sublattice objects representing sites in the processor
supercell with same site spaces.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.SemiGrandEnsemble.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#moca.SemiGrandEnsemble.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get Json-serialization dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>MSONable dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.SemiGrandEnsemble.chemical_potentials">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">chemical_potentials</span></span><a class="headerlink" href="#moca.SemiGrandEnsemble.chemical_potentials" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the chemical potentials for species in the system.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SemiGrandEnsemble.compute_chemical_work">
<span class="sig-name descname"><span class="pre">compute_chemical_work</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SemiGrandEnsemble.compute_chemical_work" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute sum of mu * N for given occupancy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SemiGrandEnsemble.compute_feature_vector">
<span class="sig-name descname"><span class="pre">compute_feature_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SemiGrandEnsemble.compute_feature_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the relevant feature vector for a given occupancy.</p>
<p>In the semigrand case it is the feature vector and the chemical work
term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy string</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>feature vector</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SemiGrandEnsemble.compute_feature_vector_change">
<span class="sig-name descname"><span class="pre">compute_feature_vector_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SemiGrandEnsemble.compute_feature_vector_change" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the change in the feature vector from a given step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy string.</p></li>
<li><p><strong>step</strong> (<em>list of tuple</em>) – a sequence of flips given by MCUsher.propose_step</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>difference in feature vector</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SemiGrandEnsemble.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SemiGrandEnsemble.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a SemiGrandEnsemble from dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>CanonicalEnsemble</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.SemiGrandEnsemble.natural_parameters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">natural_parameters</span></span><a class="headerlink" href="#moca.SemiGrandEnsemble.natural_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the vector of natural parameters.</p>
<p>For SGC an extra -1 is added for the chemical part of the Legendre
transform.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.SemiGrandEnsemble.split_sublattice_by_species">
<span class="sig-name descname"><span class="pre">split_sublattice_by_species</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattice_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_in_partitions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.SemiGrandEnsemble.split_sublattice_by_species" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a sub-lattice in system by its occupied species.</p>
<p>An example use case might be simulating topotactic Li extraction
and insertion, where we want to consider Li/Vac, TM and O as
different sub-lattices that can not be mixed by swapping.</p>
<p>In the grand canonical ensemble, the mu table will also be updated
after split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice_id</strong> (<em>int</em>) – The index of sub-lattice to split in self.sublattices.</p></li>
<li><p><strong>occu</strong> (<em>np.ndarray</em><em>[</em><em>int</em><em>]</em>) – An occupancy array to reference with.</p></li>
<li><p><strong>species_in_partitions</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>int</em><em>|</em><em>Species</em><em>|</em><a class="reference internal" href="cofe.space.html#cofe.space.domain.Vacancy" title="cofe.space.domain.Vacancy"><em>Vacancy</em></a><em>|</em><em>Element</em><em>|</em><em>str</em><em>]</em><em>]</em>) – Each sub-list contains a few species or encodings of species in
the site space to be grouped as a new sub-lattice, namely,
sites with occu[sites] == specie in the sub-list, will be
used to initialize a new sub-lattice.
Sub-lists will be pre-sorted to ascending order.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.SemiGrandEnsemble.valid_mcmc_steps">
<span class="sig-name descname"><span class="pre">valid_mcmc_steps</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('flip',)</span></em><a class="headerlink" href="#moca.SemiGrandEnsemble.valid_mcmc_steps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022-2022, Ceder Group.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>