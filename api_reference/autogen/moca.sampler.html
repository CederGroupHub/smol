
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>moca.sampler package &#8212; smol 0.3.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "auto";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/smol.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api_reference/autogen/moca.sampler';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://pydata-sphinx-theme.readthedocs.io/en/latest/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '0.3.1';
        </script>
    <script src="../../_static/require.js"></script>
    <script src="../../_static/custom.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="auto">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">

  
  
  
  
  
  
  

  
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image">
    <img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../getting_started.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user_guide.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../citing.html">
                        Citing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../developer_guide/index.html">
                        Developing
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://github.com/CederGroupHub/smol/blob/master/CHANGES.md">
                    Changes
                  </a>
                </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://github.com/CederGroupHub/smol/issues">
                    Issues
                  </a>
                </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <div class="version-switcher__container dropdown">
    <button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-toggle="dropdown">
        0.3.1  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div class="version-switcher__menu dropdown-menu list-group-flush py-0">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>
      </div>
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/CederGroupHub/smol" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../getting_started.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user_guide.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../citing.html">
                        Citing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../developer_guide/index.html">
                        Developing
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://github.com/CederGroupHub/smol/blob/master/CHANGES.md">
                    Changes
                  </a>
                </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://github.com/CederGroupHub/smol/issues">
                    Issues
                  </a>
                </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <div class="version-switcher__container dropdown">
    <button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-toggle="dropdown">
        0.3.1  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div class="version-switcher__menu dropdown-menu list-group-flush py-0">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>
      </div>
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/CederGroupHub/smol" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Section navigation">
  <p class="bd-links__title" role="heading" aria-level="1">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="moca.ensemble.html">moca.ensemble package</a></li>
<li class="toctree-l1"><a class="reference internal" href="moca.processor.html">moca.processor package</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">moca.sampler package</a></li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="moca-sampler-package">
<h1>moca.sampler package<a class="headerlink" href="#moca-sampler-package" title="Permalink to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">#</a></h2>
</section>
<section id="module-moca.sampler.bias">
<span id="moca-sampler-bias-module"></span><h2>moca.sampler.bias module<a class="headerlink" href="#module-moca.sampler.bias" title="Permalink to this heading">#</a></h2>
<p>Bias term definitions for biased sampling techniques.</p>
<p>Bias terms can be added to an MCKernel in order to generate samples that are
biased accordingly.</p>
<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.bias.FugacityBias">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FugacityBias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fugacity_fractions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.bias.FugacityBias" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moca.sampler.bias.MCBias" title="moca.sampler.bias.MCBias"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCBias</span></code></a></p>
<p>Fugacity fraction bias.</p>
<p>This bias corresponds directly to using a composition bias. Using this
with a CanonicalEnsemble keeps fugacity fractions constant, which
implicitly sets the chemical potentials, albeit for a specific temperature.
Since one species per sublattice is the reference species, to calculate
actual fugacities, the reference fugacity must be computed as an ensemble
average and all other fugacities can then be calculated.
From the fugacities and the set temperature, the corresponding chemical
potentials can then be calculated.</p>
<p>Initialize fugacity ratio bias.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattices</strong> (<em>List</em><em>[</em><a class="reference internal" href="moca.html#moca.sublattice.Sublattice" title="moca.sublattice.Sublattice"><em>Sublattice</em></a><em>]</em>) – list of active sublattices, containing species information and
site indices in sublattice.</p></li>
<li><p><strong>fugacity_fractions</strong> (<em>sequence</em><em> of </em><em>dicts</em>) – optional
Dictionary of species name and fugacity fraction for each
sublattice (.i.e think of it as the sublattice concentrations
for random structure). If not given this will be taken from the
prim structure used in the cluster subspace. Needs to be in
the same order as the corresponding sublattice.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>kwargs:</dt><dd><p>Keyword arguments for initializing MCUsher.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.bias.FugacityBias.compute_bias">
<span class="sig-name descname"><span class="pre">compute_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.bias.FugacityBias.compute_bias" title="Permalink to this definition">#</a></dt>
<dd><p>Compute bias from occupancy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>np.ndarray</em>) – Encoded occupancy string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float, bias value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.bias.FugacityBias.compute_bias_change">
<span class="sig-name descname"><span class="pre">compute_bias_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.bias.FugacityBias.compute_bias_change" title="Permalink to this definition">#</a></dt>
<dd><p>Compute bias change from step.</p>
<p>The returned value needs to be the difference of bias logs,
log(bias_f) - log(bias_i), when the bias terms would directly multiply
the ensemble probability (i.e. exp(-beta * E) * bias).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occupancy</strong> – (ndarray):
encoded occupancy array.</p></li>
<li><p><strong>step</strong> – (List[tuple(int,int)]):
step returned by MCUsher.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>float, change of bias value after step.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.bias.FugacityBias.fugacity_fractions">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fugacity_fractions</span></span><a class="headerlink" href="#moca.sampler.bias.FugacityBias.fugacity_fractions" title="Permalink to this definition">#</a></dt>
<dd><p>Get the fugacity fractions for species on active sublatts.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.bias.MCBias">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MCBias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.bias.MCBias" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base bias term class.</p>
<p>Note: Any MCBias should be implemented as beta * E - bias
will be minimized in thermodynamics kernel.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sampler.bias.MCBias.sublattices">
<span class="sig-name descname"><span class="pre">sublattices</span></span><a class="headerlink" href="#moca.sampler.bias.MCBias.sublattices" title="Permalink to this definition">#</a></dt>
<dd><p>list of sublattices with active sites.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="moca.html#moca.sublattice.Sublattice" title="moca.sublattice.Sublattice">Sublattice</a>]</p>
</dd>
</dl>
</dd></dl>

<p>Initialize MCBias.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattices</strong> (<em>List</em><em>[</em><a class="reference internal" href="moca.html#moca.sublattice.Sublattice" title="moca.sublattice.Sublattice"><em>Sublattice</em></a><em>]</em>) – list of active sublattices, containing species information and
site indices in sublattice.</p></li>
<li><p><strong>rng</strong> (<em>np.Generator</em>) – optional
The given PRNG must be the same instance as that used by the kernel and
any bias terms, otherwise reproducibility will be compromised.</p></li>
<li><p><strong>args</strong> – Additional arguments buffer.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments buffer.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.bias.MCBias.compute_bias">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.bias.MCBias.compute_bias" title="Permalink to this definition">#</a></dt>
<dd><p>Compute bias from occupancy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>np.ndarray</em>) – encoded occupancy string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float, bias value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.bias.MCBias.compute_bias_change">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute_bias_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.bias.MCBias.compute_bias_change" title="Permalink to this definition">#</a></dt>
<dd><p>Compute bias change from step.</p>
<p>The returned value needs to be the difference of bias logs,
log(bias_f) - log(bias_i), when the bias terms would directly multiply
the ensemble probability (i.e. exp(-beta * E) * bias).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occupancy</strong> – (ndarray):
encoded occupancy array.</p></li>
<li><p><strong>step</strong> – (List[tuple(int,int)]):
step returned by MCUsher.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float, change of bias value after step.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.bias.SquareChargeBias">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SquareChargeBias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">penalty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.bias.SquareChargeBias" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moca.sampler.bias.MCBias" title="moca.sampler.bias.MCBias"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCBias</span></code></a></p>
<p>Square charge bias.</p>
<p>This bias penalizes energy on square of the system net charge.</p>
<p>Square charge bias.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattices</strong> (<em>List</em><em>[</em><a class="reference internal" href="moca.html#moca.sublattice.Sublattice" title="moca.sublattice.Sublattice"><em>Sublattice</em></a><em>]</em>) – List of active sublattices, containing species information and
site indices in sublattice. Must include all sites!</p></li>
<li><p><strong>penalty</strong> (<em>float</em>) – optional
Penalty factor. energy/kT will be penalized by adding penalty
* charge**2.
Must be positive. Default to 0.5, which works
for most of the cases.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>kwargs:</dt><dd><p>Keyword arguments for initializing MCUsher.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.bias.SquareChargeBias.compute_bias">
<span class="sig-name descname"><span class="pre">compute_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.bias.SquareChargeBias.compute_bias" title="Permalink to this definition">#</a></dt>
<dd><p>Compute bias from occupancy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>np.ndarray</em>) – Encoded occupancy string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float, bias value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.bias.SquareChargeBias.compute_bias_change">
<span class="sig-name descname"><span class="pre">compute_bias_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.bias.SquareChargeBias.compute_bias_change" title="Permalink to this definition">#</a></dt>
<dd><p>Compute bias change from step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occupancy</strong> – (ndarray):
Encoded occupancy array.</p></li>
<li><p><strong>step</strong> – (List[tuple(int,int)]):
Step returned by MCUsher.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float, change of bias value after step.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.bias.SquareHyperplaneBias">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SquareHyperplaneBias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyperplane_normals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyperplane_intercepts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">penalty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.bias.SquareHyperplaneBias" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moca.sampler.bias.MCBias" title="moca.sampler.bias.MCBias"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCBias</span></code></a></p>
<p>Square hyperplane bias.</p>
<p>This bias penalizes energy on sum square of distance from a composition n
(“counts” format) to hyperplanes A n = b (in the unconstrained composition space,
see CompositionSpace document). In other words, this bias penalizes the
composition’s deviation from the constraints in A n = b.</p>
<p>Square composition bias.</p>
<p>Use this when you have other constraints to the composition
than the charge constraint.
:param sublattices: List of active sublattices, containing species information and</p>
<blockquote>
<div><p>site indices in sublattice. Must include all sites!</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyperplane_normals</strong> (<em>2D ArrayLike</em>) – Normal vectors of hyperplanes, each in a row. (The matrix A.)</p></li>
<li><p><strong>hyperplane_intercepts</strong> (<em>1D ArrayLike</em>) – Intercepts of each hyperplane. (The vector b.)</p></li>
<li><p><strong>of</strong> (<em>The matrix A and the vector b together forms a set</em>) – </p></li>
<li><p><strong>hyperplanes</strong> (<em>constraint</em>) – A n = b. (Per-super-cell, not per-primitive cell).</p></li>
<li><p><strong>penalty</strong> (<em>float</em>) – optional
Penalty factor. energy/kT will be penalized by adding penalty
* ||A n - b||**2. Must be positive.
Default to 0.5, which works for most of the cases.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>kwargs:</dt><dd><p>Keyword arguments for initializing MCUsher.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.bias.SquareHyperplaneBias.compute_bias">
<span class="sig-name descname"><span class="pre">compute_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.bias.SquareHyperplaneBias.compute_bias" title="Permalink to this definition">#</a></dt>
<dd><p>Compute bias from occupancy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>np.ndarray</em>) – Encoded occupancy string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float, bias value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.bias.SquareHyperplaneBias.compute_bias_change">
<span class="sig-name descname"><span class="pre">compute_bias_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.bias.SquareHyperplaneBias.compute_bias_change" title="Permalink to this definition">#</a></dt>
<dd><p>Compute bias change from step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occupancy</strong> – (ndarray):
Encoded occupancy array.</p></li>
<li><p><strong>step</strong> – (List[tuple(int,int)]):
Step returned by MCUsher.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float, change of bias value after step.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="moca.sampler.bias.mcbias_factory">
<span class="sig-name descname"><span class="pre">mcbias_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bias_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.bias.mcbias_factory" title="Permalink to this definition">#</a></dt>
<dd><p>Get a MCMC bias from string name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bias_type</strong> (<em>str</em>) – string specifying bias name to instantiate.</p></li>
<li><p><strong>sublattices</strong> (<em>List</em><em>[</em><a class="reference internal" href="moca.html#moca.sublattice.Sublattice" title="moca.sublattice.Sublattice"><em>Sublattice</em></a><em>]</em>) – list of active sublattices, containing species information and
site indices in sublattice.</p></li>
<li><p><strong>*args</strong> – positional args to instantiate a bias term.</p></li>
<li><p><strong>*kwargs</strong> – keyword argument to instantiate a bias term.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-moca.sampler.container">
<span id="moca-sampler-container-module"></span><h2>moca.sampler.container module<a class="headerlink" href="#module-moca.sampler.container" title="Permalink to this heading">#</a></h2>
<p>Implementation of SampleContainer class.</p>
<p>A SampleContainer is used to store data from Monte Carlo sampling simulation.
It has some minimimal methods and properties useful to start analyzing the
samples.</p>
<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SampleContainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ensemble</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MSONable</span></code></p>
<p>A SampleContainer class stores Monte Carlo simulation samples.</p>
<p>A SampleContainer holds samples and sampling information from an MCMC
sampling run. It is useful to obtain the raw data and minimal empirical
properties of the underlying distribution in order to carry out further
analysis of the MCMC sampling results.</p>
<p>When getting any value from the provided attributes, the highly repeated
args are:</p>
<blockquote>
<div><dl class="simple">
<dt>discard (int): optional</dt><dd><p>number of samples to discard to obtain the value requested.</p>
</dd>
<dt>thin_by (int): optional</dt><dd><p>use every thin_by sample to obtain the value requested.</p>
</dd>
<dt>flat (bool): optional</dt><dd><p>if more than 1 walker is used, flattening will flatten all
chains into one. Defaults to True.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.num_sites">
<span class="sig-name descname"><span class="pre">num_sites</span></span><a class="headerlink" href="#moca.sampler.container.SampleContainer.num_sites" title="Permalink to this definition">#</a></dt>
<dd><p>Size of system (usually in number of prims in supercell, but
can be anything representative, i.e. number of sites)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.sublattices">
<span class="sig-name descname"><span class="pre">sublattices</span></span><a class="headerlink" href="#moca.sampler.container.SampleContainer.sublattices" title="Permalink to this definition">#</a></dt>
<dd><p>Sublattices of the ensemble sampled.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of <a class="reference internal" href="moca.html#moca.sublattice.Sublattice" title="moca.sublattice.Sublattice">Sublattice</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.natural_parameters">
<span class="sig-name descname"><span class="pre">natural_parameters</span></span><a class="headerlink" href="#moca.sampler.container.SampleContainer.natural_parameters" title="Permalink to this definition">#</a></dt>
<dd><p>Array of natural parameters used in the ensemble.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><a class="headerlink" href="#moca.sampler.container.SampleContainer.metadata" title="Permalink to this definition">#</a></dt>
<dd><p>Dictionary of metadata from the MC run that generated the samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<p>Initialize a sample container.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ensemble</strong> (<a class="reference internal" href="moca.html#moca.Ensemble" title="moca.Ensemble"><em>Ensemble</em></a>) – Ensemble object used to generate the samples.</p></li>
<li><p><strong>sample_trace</strong> (<em>Trace</em>) – a trace object for the traced values during MC sampling</p></li>
<li><p><strong>sampling_metadata</strong> (<a class="reference internal" href="moca.html#moca.Ensemble" title="moca.Ensemble"><em>Ensemble</em></a>) – sampling metadata (i.e. ensemble name, mckernel type, etc)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.allocate">
<span class="sig-name descname"><span class="pre">allocate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsamples</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.allocate" title="Permalink to this definition">#</a></dt>
<dd><p>Allocate more space in arrays for more samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.as_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Get Json-serialization dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>MSONable dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.clear" title="Permalink to this definition">#</a></dt>
<dd><p>Clear all samples from container.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.composition_variance">
<span class="sig-name descname"><span class="pre">composition_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.composition_variance" title="Permalink to this definition">#</a></dt>
<dd><p>Get the variance in composition of all species.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.energy_variance">
<span class="sig-name descname"><span class="pre">energy_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.energy_variance" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the variance of sampled energies.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.ensemble">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ensemble</span></span><a class="headerlink" href="#moca.sampler.container.SampleContainer.ensemble" title="Permalink to this definition">#</a></dt>
<dd><p>Return the ensemble name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.enthalpy_variance">
<span class="sig-name descname"><span class="pre">enthalpy_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.enthalpy_variance" title="Permalink to this definition">#</a></dt>
<dd><p>Get the variance in enthalpy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.feature_vector_variance">
<span class="sig-name descname"><span class="pre">feature_vector_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.feature_vector_variance" title="Permalink to this definition">#</a></dt>
<dd><p>Get the variance of feature vector elements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.flush_to_backend">
<span class="sig-name descname"><span class="pre">flush_to_backend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backend</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.flush_to_backend" title="Permalink to this definition">#</a></dt>
<dd><p>Flush current samples and trace to backend file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>backend</strong> (<em>object</em>) – backend file object, currently only hdf5 supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Instantiate a SampleContainer from dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>dict</em>) – dictionary representation.</p></li>
<li><p><strong>ensemble</strong> (<a class="reference internal" href="moca.html#moca.Ensemble" title="moca.Ensemble"><em>Ensemble</em></a>) – optional
The ensemble object to used for generating samples. Only needed to
update legacy files.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>SampleContainer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.from_hdf5">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swmr_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.from_hdf5" title="Permalink to this definition">#</a></dt>
<dd><p>Instantiate a SampleContainer from an hdf5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>str</em>) – path to file</p></li>
<li><p><strong>swmr_mode</strong> (<em>bool</em>) – optional
If true allows to read file from other processes. Single Writer
Multiple Readers.</p></li>
<li><p><strong>ensemble</strong> (<a class="reference internal" href="moca.html#moca.Ensemble" title="moca.Ensemble"><em>Ensemble</em></a>) – optional
The ensemble object to used for generating samples. Only needed to
update legacy files.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>SampleContainer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.get_backend">
<span class="sig-name descname"><span class="pre">get_backend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alloc_nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swmr_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.get_backend" title="Permalink to this definition">#</a></dt>
<dd><p>Get a backend file object.</p>
<p>Currently only hdf5 files supported</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>str</em>) – path to backend file.</p></li>
<li><p><strong>alloc_nsamples</strong> (<em>int</em>) – optional
number of new samples to allocate. Will only extend datasets
if number given is larger than space left to write samples
into.</p></li>
<li><p><strong>swmr_mode</strong> (<em>bool</em>) – optional
If true allows to read file from other processes. Single Writer
Multiple Readers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>h5.File object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.get_compositions">
<span class="sig-name descname"><span class="pre">get_compositions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.get_compositions" title="Permalink to this definition">#</a></dt>
<dd><p>Get the compositions for each occupancy in the chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.get_energies">
<span class="sig-name descname"><span class="pre">get_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.get_energies" title="Permalink to this definition">#</a></dt>
<dd><p>Get the energies from samples in chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.get_enthalpies">
<span class="sig-name descname"><span class="pre">get_enthalpies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.get_enthalpies" title="Permalink to this definition">#</a></dt>
<dd><p>Get the generalized enthalpy changes from samples in chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.get_feature_vectors">
<span class="sig-name descname"><span class="pre">get_feature_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.get_feature_vectors" title="Permalink to this definition">#</a></dt>
<dd><p>Get the feature vector changes from samples in chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.get_minimum_energy">
<span class="sig-name descname"><span class="pre">get_minimum_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.get_minimum_energy" title="Permalink to this definition">#</a></dt>
<dd><p>Get the minimum energy from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.get_minimum_energy_occupancy">
<span class="sig-name descname"><span class="pre">get_minimum_energy_occupancy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.get_minimum_energy_occupancy" title="Permalink to this definition">#</a></dt>
<dd><p>Find the occupancy with minimum energy from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.get_minimum_enthalpy">
<span class="sig-name descname"><span class="pre">get_minimum_enthalpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.get_minimum_enthalpy" title="Permalink to this definition">#</a></dt>
<dd><p>Get the minimum energy from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.get_minimum_enthalpy_occupancy">
<span class="sig-name descname"><span class="pre">get_minimum_enthalpy_occupancy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.get_minimum_enthalpy_occupancy" title="Permalink to this definition">#</a></dt>
<dd><p>Find the occupancy with minimum energy from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.get_occupancies">
<span class="sig-name descname"><span class="pre">get_occupancies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.get_occupancies" title="Permalink to this definition">#</a></dt>
<dd><p>Get the occupancy chain of the samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.get_orbit_factors">
<span class="sig-name descname"><span class="pre">get_orbit_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_orbit_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.get_orbit_factors" title="Permalink to this definition">#</a></dt>
<dd><p>Get the orbit factor vectors for samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.get_sampled_structures">
<span class="sig-name descname"><span class="pre">get_sampled_structures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.get_sampled_structures" title="Permalink to this definition">#</a></dt>
<dd><p>Get sampled structures for MC steps given by indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>list</em><em> of </em><em>int</em><em> or </em><em>int</em>) – A single index or list of indices to obtain sampled structures.</p></li>
<li><p><strong>flat</strong> (<em>bool</em>) – optional
If true will flatten chains, and the indices correspond to flattened
values. If false chain is not flattened, and if multiple walkers where
used returns a list of list where each inner list has the sampled
structure for each walker. Default is set to flat True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of Structure or list of list of Structure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.get_species_counts">
<span class="sig-name descname"><span class="pre">get_species_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.get_species_counts" title="Permalink to this definition">#</a></dt>
<dd><p>Get the species counts for each occupancy in the chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.get_sublattice_compositions">
<span class="sig-name descname"><span class="pre">get_sublattice_compositions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.get_sublattice_compositions" title="Permalink to this definition">#</a></dt>
<dd><p>Get the compositions of a specific sublattice.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.get_sublattice_species_counts">
<span class="sig-name descname"><span class="pre">get_sublattice_species_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.get_sublattice_species_counts" title="Permalink to this definition">#</a></dt>
<dd><p>Get the counts of each species in a sublattices.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>where last axis is the count for each species in the
same order as the underlying site space.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.get_trace_value">
<span class="sig-name descname"><span class="pre">get_trace_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.get_trace_value" title="Permalink to this definition">#</a></dt>
<dd><p>Get sampled values of a traced value given by name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.mean_composition">
<span class="sig-name descname"><span class="pre">mean_composition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.mean_composition" title="Permalink to this definition">#</a></dt>
<dd><p>Get mean composition for all species regardless of sublattice.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.mean_energy">
<span class="sig-name descname"><span class="pre">mean_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.mean_energy" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the mean energy from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.mean_enthalpy">
<span class="sig-name descname"><span class="pre">mean_enthalpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.mean_enthalpy" title="Permalink to this definition">#</a></dt>
<dd><p>Get the mean generalized enthalpy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.mean_feature_vector">
<span class="sig-name descname"><span class="pre">mean_feature_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.mean_feature_vector" title="Permalink to this definition">#</a></dt>
<dd><p>Get the mean feature vector from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.mean_sublattice_composition">
<span class="sig-name descname"><span class="pre">mean_sublattice_composition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.mean_sublattice_composition" title="Permalink to this definition">#</a></dt>
<dd><p>Get the mean composition of a specific sublattice.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.mean_trace_value">
<span class="sig-name descname"><span class="pre">mean_trace_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.mean_trace_value" title="Permalink to this definition">#</a></dt>
<dd><p>Get mean of a traced value given by name.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">natural_parameters</span></span><a class="headerlink" href="#id0" title="Permalink to this definition">#</a></dt>
<dd><p>Return the natural parameters.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.num_samples">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_samples</span></span><a class="headerlink" href="#moca.sampler.container.SampleContainer.num_samples" title="Permalink to this definition">#</a></dt>
<dd><p>Get the total number of samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.sampling_efficiency">
<span class="sig-name descname"><span class="pre">sampling_efficiency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.sampling_efficiency" title="Permalink to this definition">#</a></dt>
<dd><p>Return the sampling efficiency for chains.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.save_sampled_trace">
<span class="sig-name descname"><span class="pre">save_sampled_trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thinned_by</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.save_sampled_trace" title="Permalink to this definition">#</a></dt>
<dd><p>Save a sampled trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>Trace</em>) – Trace of sampled values</p></li>
<li><p><strong>thinned_by</strong> (<em>int</em>) – the amount that the sampling was thinned by. Used to update
the total mc iterations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#moca.sampler.container.SampleContainer.shape" title="Permalink to this definition">#</a></dt>
<dd><p>Get the shape of the samples in chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.sublattice_composition_variance">
<span class="sig-name descname"><span class="pre">sublattice_composition_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.sublattice_composition_variance" title="Permalink to this definition">#</a></dt>
<dd><p>Get the variance in composition of a specific sublattice.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sublattices</span></span><a class="headerlink" href="#id1" title="Permalink to this definition">#</a></dt>
<dd><p>Return the sublattices.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.to_hdf5">
<span class="sig-name descname"><span class="pre">to_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.to_hdf5" title="Permalink to this definition">#</a></dt>
<dd><p>Save SampleContainer as an HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>str</em>) – path to file save location. If file exists and dimensions
match samples will be appended.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.total_mc_steps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_mc_steps</span></span><a class="headerlink" href="#moca.sampler.container.SampleContainer.total_mc_steps" title="Permalink to this definition">#</a></dt>
<dd><p>Return the total number of MC steps taken during sampling.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.trace_value_variance">
<span class="sig-name descname"><span class="pre">trace_value_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.container.SampleContainer.trace_value_variance" title="Permalink to this definition">#</a></dt>
<dd><p>Get variance of a traced value given by name.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.container.SampleContainer.traced_values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">traced_values</span></span><a class="headerlink" href="#moca.sampler.container.SampleContainer.traced_values" title="Permalink to this definition">#</a></dt>
<dd><p>Get the names of traced values being sampled.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-moca.sampler.kernel">
<span id="moca-sampler-kernel-module"></span><h2>moca.sampler.kernel module<a class="headerlink" href="#module-moca.sampler.kernel" title="Permalink to this heading">#</a></h2>
<p>Implementation of MCMC transition kernel classes.</p>
<p>A kernel essentially is an implementation of the MCMC algorithm that is used
to generate states for sampling an MCMC chain.</p>
<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.kernel.MCKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MCKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ensemble</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_type</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.kernel.MCKernel" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for transition kernels.</p>
<p>A kernel is used to implement a specific MC algorithm used to sample
the ensemble classes. For an illustrative example of how to derive from this
and write a specific kernel see the Metropolis kernel.</p>
<p>Initialize MCKernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ensemble</strong> (<a class="reference internal" href="moca.html#moca.Ensemble" title="moca.Ensemble"><em>Ensemble</em></a>) – an Ensemble instance to obtain the features and parameters
used in computing log probabilities.</p></li>
<li><p><strong>step_type</strong> (<em>str</em>) – string specifying the MCMC step type.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – optional
non-negative integer to seed the PRNG</p></li>
<li><p><strong>bias_type</strong> (<em>str</em>) – optional
name for bias type instance.</p></li>
<li><p><strong>bias_kwargs</strong> (<em>dict</em>) – optional
dictionary of keyword arguments to pass to the bias
constructor.</p></li>
<li><p><strong>args</strong> – positional arguments to instantiate the MCUsher for the
corresponding step size.</p></li>
<li><p><strong>kwargs</strong> – keyword arguments to instantiate the MCUsher for the
corresponding step size.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.kernel.MCKernel.bias">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bias</span></span><a class="headerlink" href="#moca.sampler.kernel.MCKernel.bias" title="Permalink to this definition">#</a></dt>
<dd><p>Get the bias.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.kernel.MCKernel.compute_initial_trace">
<span class="sig-name descname"><span class="pre">compute_initial_trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.kernel.MCKernel.compute_initial_trace" title="Permalink to this definition">#</a></dt>
<dd><p>Compute initial values for sample trace given an occupancy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – Initial occupancy</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Trace</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.kernel.MCKernel.ensemble">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ensemble</span></span><a class="headerlink" href="#moca.sampler.kernel.MCKernel.ensemble" title="Permalink to this definition">#</a></dt>
<dd><p>Return the ensemble instance.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.kernel.MCKernel.mcusher">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mcusher</span></span><a class="headerlink" href="#moca.sampler.kernel.MCKernel.mcusher" title="Permalink to this definition">#</a></dt>
<dd><p>Get the MCUsher.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.kernel.MCKernel.seed">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#moca.sampler.kernel.MCKernel.seed" title="Permalink to this definition">#</a></dt>
<dd><p>Get seed for PRNG.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.kernel.MCKernel.set_aux_state">
<span class="sig-name descname"><span class="pre">set_aux_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancies</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.kernel.MCKernel.set_aux_state" title="Permalink to this definition">#</a></dt>
<dd><p>Set the auxiliary occupancies from initial or checkpoint values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.kernel.MCKernel.single_step">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">single_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.kernel.MCKernel.single_step" title="Permalink to this definition">#</a></dt>
<dd><p>Attempt an MCMC step.</p>
<p>Returns the next state in the chain and if the attempted step was
successful.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>a step trace for states and traced values for a single</dt><dd><p>step</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>StepTrace</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sampler.kernel.MCKernel.valid_bias">
<span class="sig-name descname"><span class="pre">valid_bias</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#moca.sampler.kernel.MCKernel.valid_bias" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sampler.kernel.MCKernel.valid_mcushers">
<span class="sig-name descname"><span class="pre">valid_mcushers</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#moca.sampler.kernel.MCKernel.valid_mcushers" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.kernel.Metropolis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Metropolis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ensemble</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.kernel.Metropolis" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moca.sampler.kernel.ThermalKernel" title="moca.sampler.kernel.ThermalKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThermalKernel</span></code></a></p>
<p>A Metropolis-Hastings kernel.</p>
<p>The classic and nothing but the classic.</p>
<p>Initialize ThermalKernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ensemble</strong> (<a class="reference internal" href="moca.html#moca.Ensemble" title="moca.Ensemble"><em>Ensemble</em></a>) – an Ensemble instance to obtain the features and parameters
used in computing log probabilities.</p></li>
<li><p><strong>step_type</strong> (<em>str</em>) – string specifying the MCMC step type.</p></li>
<li><p><strong>temperature</strong> (<em>float</em>) – temperature at which the MCMC sampling will be carried out.</p></li>
<li><p><strong>args</strong> – positional arguments to instantiate the MCUsher for the
corresponding step size.</p></li>
<li><p><strong>kwargs</strong> – keyword arguments to instantiate the MCUsher for the
corresponding step size.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.kernel.Metropolis.single_step">
<span class="sig-name descname"><span class="pre">single_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.kernel.Metropolis.single_step" title="Permalink to this definition">#</a></dt>
<dd><p>Attempt an MC step.</p>
<p>Returns the next occupancies in the chain and if the attempted step was
successful.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>StepTrace</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sampler.kernel.Metropolis.valid_bias">
<span class="sig-name descname"><span class="pre">valid_bias</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['FugacityBias',</span> <span class="pre">'SquareChargeBias',</span> <span class="pre">'SquareHyperplaneBias']</span></em><a class="headerlink" href="#moca.sampler.kernel.Metropolis.valid_bias" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sampler.kernel.Metropolis.valid_mcushers">
<span class="sig-name descname"><span class="pre">valid_mcushers</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['Flip',</span> <span class="pre">'Swap',</span> <span class="pre">'MultiStep',</span> <span class="pre">'Composite',</span> <span class="pre">'TableFlip']</span></em><a class="headerlink" href="#moca.sampler.kernel.Metropolis.valid_mcushers" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.kernel.ThermalKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ThermalKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ensemble</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.kernel.ThermalKernel" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moca.sampler.kernel.MCKernel" title="moca.sampler.kernel.MCKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCKernel</span></code></a></p>
<p>Abstract base class for transition kernels with a set temperature.</p>
<p>Basically all kernels should derive from this with the exception of those
for multicanonical sampling and related methods</p>
<p>Initialize ThermalKernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ensemble</strong> (<a class="reference internal" href="moca.html#moca.Ensemble" title="moca.Ensemble"><em>Ensemble</em></a>) – an Ensemble instance to obtain the features and parameters
used in computing log probabilities.</p></li>
<li><p><strong>step_type</strong> (<em>str</em>) – string specifying the MCMC step type.</p></li>
<li><p><strong>temperature</strong> (<em>float</em>) – temperature at which the MCMC sampling will be carried out.</p></li>
<li><p><strong>args</strong> – positional arguments to instantiate the MCUsher for the
corresponding step size.</p></li>
<li><p><strong>kwargs</strong> – keyword arguments to instantiate the MCUsher for the
corresponding step size.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.kernel.ThermalKernel.compute_initial_trace">
<span class="sig-name descname"><span class="pre">compute_initial_trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.kernel.ThermalKernel.compute_initial_trace" title="Permalink to this definition">#</a></dt>
<dd><p>Compute initial values for sample trace given occupancy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – Initial occupancy</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Trace</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.kernel.ThermalKernel.set_aux_state">
<span class="sig-name descname"><span class="pre">set_aux_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancies</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.kernel.ThermalKernel.set_aux_state" title="Permalink to this definition">#</a></dt>
<dd><p>Set the auxiliary occupancies from initial or checkpoint values.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.kernel.ThermalKernel.temperature">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">temperature</span></span><a class="headerlink" href="#moca.sampler.kernel.ThermalKernel.temperature" title="Permalink to this definition">#</a></dt>
<dd><p>Get the temperature of kernel.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.kernel.UniformlyRandom">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">UniformlyRandom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ensemble</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_type</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.kernel.UniformlyRandom" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moca.sampler.kernel.MCKernel" title="moca.sampler.kernel.MCKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCKernel</span></code></a></p>
<p>A Kernel that accepts all proposed steps.</p>
<p>This kernel samples the random limit distribution where all states have the
same probability (corresponding to an infinite temperature). If a
bias is added then the corresponding distribution will be biased
accordingly.</p>
<p>Initialize MCKernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ensemble</strong> (<a class="reference internal" href="moca.html#moca.Ensemble" title="moca.Ensemble"><em>Ensemble</em></a>) – an Ensemble instance to obtain the features and parameters
used in computing log probabilities.</p></li>
<li><p><strong>step_type</strong> (<em>str</em>) – string specifying the MCMC step type.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – optional
non-negative integer to seed the PRNG</p></li>
<li><p><strong>bias_type</strong> (<em>str</em>) – optional
name for bias type instance.</p></li>
<li><p><strong>bias_kwargs</strong> (<em>dict</em>) – optional
dictionary of keyword arguments to pass to the bias
constructor.</p></li>
<li><p><strong>args</strong> – positional arguments to instantiate the MCUsher for the
corresponding step size.</p></li>
<li><p><strong>kwargs</strong> – keyword arguments to instantiate the MCUsher for the
corresponding step size.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.kernel.UniformlyRandom.single_step">
<span class="sig-name descname"><span class="pre">single_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.kernel.UniformlyRandom.single_step" title="Permalink to this definition">#</a></dt>
<dd><p>Attempt an MCMC step.</p>
<p>Returns the next occupancies in the chain and if the attempted step was
successful.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>StepTrace</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sampler.kernel.UniformlyRandom.valid_bias">
<span class="sig-name descname"><span class="pre">valid_bias</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['FugacityBias',</span> <span class="pre">'SquareChargeBias',</span> <span class="pre">'SquareHyperplaneBias']</span></em><a class="headerlink" href="#moca.sampler.kernel.UniformlyRandom.valid_bias" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sampler.kernel.UniformlyRandom.valid_mcushers">
<span class="sig-name descname"><span class="pre">valid_mcushers</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['Flip',</span> <span class="pre">'Swap',</span> <span class="pre">'MultiStep',</span> <span class="pre">'Composite',</span> <span class="pre">'TableFlip']</span></em><a class="headerlink" href="#moca.sampler.kernel.UniformlyRandom.valid_mcushers" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.kernel.WangLandau">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">WangLandau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ensemble</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_enthalpy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_enthalpy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_size</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flatness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mod_update</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.kernel.WangLandau" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moca.sampler.kernel.MCKernel" title="moca.sampler.kernel.MCKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCKernel</span></code></a></p>
<p>A Wang-Landau sampling kernel.</p>
<p>Allows wang-landau sampling method. Stores histogram and DOS in its instance.</p>
<p>Initialize a WangLandau Kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ensemble</strong> (<a class="reference internal" href="moca.html#moca.Ensemble" title="moca.Ensemble"><em>Ensemble</em></a>) – The ensemble object to use to generate samples</p></li>
<li><p><strong>step_type</strong> (<em>str</em>) – An MC step type corresponding to an MCUsher. See valid_mcushers</p></li>
<li><p><strong>min_enthalpy</strong> (<em>float</em>) – The minimum enthalpy to sample. Enthalpy means the dot product
of natural parameters and ensemble features. In canonical ensemble,
it shall be the energy. In semigrand ensemble, it shall be E- mu N.
Unit is eV scaled at the super-cell.</p></li>
<li><p><strong>max_enthalpy</strong> (<em>float</em>) – The maximum enthalpy to sample.</p></li>
<li><p><strong>bin_size</strong> (<em>float</em>) – The enthalpy bin size to determine different states.</p></li>
<li><p><strong>flatness</strong> (<em>float</em>) – optional
The flatness factor used when checking histogram flatness.
Must be between 0 and 1.</p></li>
<li><p><strong>mod_factor</strong> (<em>float</em>) – log of the initial modification factor used to update the
DOS/entropy.
Default is 1, which means the DOS shall be multiplied by e^1.</p></li>
<li><p><strong>check_period</strong> (<em>int</em>) – optional
The period in number of steps for the histogram flatness to be
checked.</p></li>
<li><p><strong>update_period</strong> (<em>int</em>) – optional
The period in number of steps to update the histogram and entropy.
In some cases periods slightly larger than each step, may allow
more efficient exploration of energy space.</p></li>
<li><p><strong>mod_update</strong> (<em>float</em><em>|</em><em>Callable</em>) – optional
A function used to update the fill factor when the histogram
satisfies the flatness criteria. It must monotonically decrease
to 0.
When a number is provided, at each update we will divide the
mod factor by this number.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – optional
non-negative integer to seed the PRNG</p></li>
<li><p><strong>args</strong> – Positional arguments to instantiate MCUsher.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments to instantiate MCUsher.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.kernel.WangLandau.bin_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bin_size</span></span><a class="headerlink" href="#moca.sampler.kernel.WangLandau.bin_size" title="Permalink to this definition">#</a></dt>
<dd><p>Enthalpy bin size.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.kernel.WangLandau.compute_initial_trace">
<span class="sig-name descname"><span class="pre">compute_initial_trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.kernel.WangLandau.compute_initial_trace" title="Permalink to this definition">#</a></dt>
<dd><p>Compute initial values for sample trace given an occupancy.</p>
<p>Add the micro-canonical entropy and histograms to the trace.
:param occupancy: Initial occupancy
:type occupancy: ndarray</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Trace</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.kernel.WangLandau.dos">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dos</span></span><a class="headerlink" href="#moca.sampler.kernel.WangLandau.dos" title="Permalink to this definition">#</a></dt>
<dd><p>Density of states on visited levels.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.kernel.WangLandau.entropy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">entropy</span></span><a class="headerlink" href="#moca.sampler.kernel.WangLandau.entropy" title="Permalink to this definition">#</a></dt>
<dd><p>log(dos) on visited levels.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.kernel.WangLandau.histogram">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">histogram</span></span><a class="headerlink" href="#moca.sampler.kernel.WangLandau.histogram" title="Permalink to this definition">#</a></dt>
<dd><p>Histogram on visited levels.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.kernel.WangLandau.levels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">levels</span></span><a class="headerlink" href="#moca.sampler.kernel.WangLandau.levels" title="Permalink to this definition">#</a></dt>
<dd><p>Visited enthalpy levels.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.kernel.WangLandau.mod_factor">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mod_factor</span></span><a class="headerlink" href="#moca.sampler.kernel.WangLandau.mod_factor" title="Permalink to this definition">#</a></dt>
<dd><p>Mod factor.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.kernel.WangLandau.set_aux_state">
<span class="sig-name descname"><span class="pre">set_aux_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.kernel.WangLandau.set_aux_state" title="Permalink to this definition">#</a></dt>
<dd><p>Set the auxiliary occupancies based on an occupancy.</p>
<p>This is necessary for WangLandau to work properly because
it needs to store the current enthalpy and features.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.kernel.WangLandau.single_step">
<span class="sig-name descname"><span class="pre">single_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.kernel.WangLandau.single_step" title="Permalink to this definition">#</a></dt>
<dd><p>Attempt an MC step.</p>
<p>Returns the next steptrace in the chain.
:param occupancy: encoded occupancy.
:type occupancy: ndarray</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>StepTrace</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sampler.kernel.WangLandau.valid_bias">
<span class="sig-name descname"><span class="pre">valid_bias</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#moca.sampler.kernel.WangLandau.valid_bias" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sampler.kernel.WangLandau.valid_mcushers">
<span class="sig-name descname"><span class="pre">valid_mcushers</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['Flip',</span> <span class="pre">'Swap',</span> <span class="pre">'MultiStep',</span> <span class="pre">'Composite',</span> <span class="pre">'TableFlip']</span></em><a class="headerlink" href="#moca.sampler.kernel.WangLandau.valid_mcushers" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="moca.sampler.kernel.mckernel_factory">
<span class="sig-name descname"><span class="pre">mckernel_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_type</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.kernel.mckernel_factory" title="Permalink to this definition">#</a></dt>
<dd><p>Get a MCMC Kernel from string name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel_type</strong> (<em>str</em>) – string specifying kernel type to instantiate.</p></li>
<li><p><strong>ensemble</strong> (<a class="reference internal" href="moca.html#moca.Ensemble" title="moca.Ensemble"><em>Ensemble</em></a>) – an Ensemble object to create the MCMC kernel from.</p></li>
<li><p><strong>step_type</strong> (<em>str</em>) – string specifying the proposal type (i.e. key for MCUsher type)</p></li>
<li><p><strong>*args</strong> – positional arguments passed to class constructor</p></li>
<li><p><strong>**kwargs</strong> – keyword arguments passed to class constructor</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>instance of derived class.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#moca.sampler.kernel.MCKernel" title="moca.sampler.kernel.MCKernel">MCKernel</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-moca.sampler.mcusher">
<span id="moca-sampler-mcusher-module"></span><h2>moca.sampler.mcusher module<a class="headerlink" href="#module-moca.sampler.mcusher" title="Permalink to this heading">#</a></h2>
<p>Implementations of MCMC Usher classes.</p>
<p>An usher is used to generate step proposals for MC Monte Carlo sampling.
For example a Flipper simply proposes a change of the identity of a species
at a site for use in a SemiGrand ensemble. A Swapper will propose a swap
between species at two sites for use in Canonical ensemble simulations.</p>
<p>More complex steps can be defined simply by deriving from the MCUsher.</p>
<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.mcusher.Composite">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Composite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcushers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcusher_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.Composite" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moca.sampler.mcusher.MCUsher" title="moca.sampler.mcusher.MCUsher"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCUsher</span></code></a></p>
<p>A composite usher for chaining different step types.</p>
<p>This can be used to mix step types for all sublattices or to create hybrid
ensembles where different sublattices have different allowed steps.</p>
<p>Initialize the composite usher.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattices</strong> (<em>list</em><em> of </em><a class="reference internal" href="moca.html#moca.sublattice.Sublattice" title="moca.sublattice.Sublattice"><em>Sublattice</em></a>) – list of active Sublattices to propose steps for. Active
sublattices are those that include sites with configuration
degrees of freedom DOFs, only occupancy on active sub-lattices’ active sites
are allowed to change.</p></li>
<li><p><strong>mcushers</strong> (<em>list</em><em> of </em><a class="reference internal" href="#moca.sampler.mcusher.MCUsher" title="moca.sampler.mcusher.MCUsher"><em>MCUsher</em></a>) – A list of mcushers to add to the composite.</p></li>
<li><p><strong>mcusher_weights</strong> (<em>list</em><em> of </em><em>float</em>) – A list of the weights associated with each mcusher passed. With this
the corresponding probabilities for each mcusher to be picked are
generated. Must be in the same order as the mcusher list.</p></li>
<li><p><strong>rng</strong> (<em>np.Generator</em>) – optional
The given PRNG must be the same instance as that used by the kernel and
any bias terms, otherwise reproducibility will be compromised.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.mcusher.Composite.add_mcusher">
<span class="sig-name descname"><span class="pre">add_mcusher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mcusher</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.Composite.add_mcusher" title="Permalink to this definition">#</a></dt>
<dd><p>Add an MCUsher to the Composite usher.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mcusher</strong> (<a class="reference internal" href="#moca.sampler.mcusher.MCUsher" title="moca.sampler.mcusher.MCUsher"><em>MCUsher</em></a>) – The MCUsher to add</p></li>
<li><p><strong>weight</strong> (<em>float</em>) – The weight associated with the mcusher being added</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.mcusher.Composite.mcushers">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mcushers</span></span><a class="headerlink" href="#moca.sampler.mcusher.Composite.mcushers" title="Permalink to this definition">#</a></dt>
<dd><p>Get the list of mcushers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.mcusher.Composite.propose_step">
<span class="sig-name descname"><span class="pre">propose_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.Composite.propose_step" title="Permalink to this definition">#</a></dt>
<dd><p>Propose a step given an occupancy.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.mcusher.Composite.weight">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">weight</span></span><a class="headerlink" href="#moca.sampler.mcusher.Composite.weight" title="Permalink to this definition">#</a></dt>
<dd><p>Get the weights associated with each mcusher.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.mcusher.Flip">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Flip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sublattice_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.Flip" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moca.sampler.mcusher.MCUsher" title="moca.sampler.mcusher.MCUsher"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCUsher</span></code></a></p>
<p>Implementation of a simple flip step at a random site.</p>
<p>Initialize MCMCStep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattices</strong> (<em>list</em><em> of </em><a class="reference internal" href="moca.html#moca.sublattice.Sublattice" title="moca.sublattice.Sublattice"><em>Sublattice</em></a>) – list of active Sublattices to propose steps for. Active
sublattices are those that include sites with configuration
degrees of freedom DOFs, only occupancy on active sub-lattices’
active sites are allowed to change.</p></li>
<li><p><strong>sublattice_probabilities</strong> (<em>list</em><em> of </em><em>float</em>) – optional
list of probabilities to pick a site from specific active
sublattices.</p></li>
<li><p><strong>rng</strong> (<em>np.Generator</em>) – optional
The given PRNG must be the same instance as that used by the kernel and
any bias terms, otherwise reproducibility will be compromised.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.mcusher.Flip.propose_step">
<span class="sig-name descname"><span class="pre">propose_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.Flip.propose_step" title="Permalink to this definition">#</a></dt>
<dd><p>Propose a single random flip step.</p>
<p>A step is given as a sequence of tuples, where each tuple is of the
form (site index, species code to set)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of tuples each with (index, code)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list(tuple)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.mcusher.MCUsher">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MCUsher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sublattice_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.MCUsher" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for MC usher classes.</p>
<p>Initialize MCMCStep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattices</strong> (<em>list</em><em> of </em><a class="reference internal" href="moca.html#moca.sublattice.Sublattice" title="moca.sublattice.Sublattice"><em>Sublattice</em></a>) – list of active Sublattices to propose steps for. Active
sublattices are those that include sites with configuration
degrees of freedom DOFs, only occupancy on active sub-lattices’
active sites are allowed to change.</p></li>
<li><p><strong>sublattice_probabilities</strong> (<em>list</em><em> of </em><em>float</em>) – optional
list of probabilities to pick a site from specific active
sublattices.</p></li>
<li><p><strong>rng</strong> (<em>np.Generator</em>) – optional
The given PRNG must be the same instance as that used by the kernel and
any bias terms, otherwise reproducibility will be compromised.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.mcusher.MCUsher.compute_log_priori_factor">
<span class="sig-name descname"><span class="pre">compute_log_priori_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.MCUsher.compute_log_priori_factor" title="Permalink to this definition">#</a></dt>
<dd><p>Compute a-priori weight to adjust step acceptance ratio.</p>
<p>This is essential in keeping detailed balance for some particular
metropolis proposal methods. Return log of the factor for numerical
accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy string</p></li>
<li><p><strong>step</strong> (<em>list</em><em>[</em><em>tuple</em><em>]</em>) – Metropolis step. list of tuples each with (index, code).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>log of a-priori adjustment weight.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.mcusher.MCUsher.get_random_sublattice">
<span class="sig-name descname"><span class="pre">get_random_sublattice</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.MCUsher.get_random_sublattice" title="Permalink to this definition">#</a></dt>
<dd><p>Return a random sublattice based on given probabilities.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.mcusher.MCUsher.propose_step">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">propose_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.MCUsher.propose_step" title="Permalink to this definition">#</a></dt>
<dd><p>Propose an MCMC step.</p>
<p>A step is given as a sequence of tuples, where each tuple is of the
form (site index, species code to set)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple of tuples each with (index, code)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list(tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.mcusher.MCUsher.set_aux_state">
<span class="sig-name descname"><span class="pre">set_aux_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancies</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.MCUsher.set_aux_state" title="Permalink to this definition">#</a></dt>
<dd><p>Set the auxiliary occupancies from a checkpoint values.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.mcusher.MCUsher.sublattice_probabilities">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sublattice_probabilities</span></span><a class="headerlink" href="#moca.sampler.mcusher.MCUsher.sublattice_probabilities" title="Permalink to this definition">#</a></dt>
<dd><p>Get the sublattice probabilities.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.mcusher.MCUsher.update_aux_state">
<span class="sig-name descname"><span class="pre">update_aux_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.MCUsher.update_aux_state" title="Permalink to this definition">#</a></dt>
<dd><p>Update any auxiliary state information based on an accepted step.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.mcusher.MultiStep">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MultiStep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcusher</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_lengths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.MultiStep" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moca.sampler.mcusher.MCUsher" title="moca.sampler.mcusher.MCUsher"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCUsher</span></code></a></p>
<p>A multistep usher to generate steps of several flips.</p>
<p>Any usher can be used to chain steps, ie create multi flip steps, multi swap steps
even multi composite steps, etc.</p>
<p>Initialize a multistep usher.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattices</strong> (<em>list</em><em> of </em><a class="reference internal" href="moca.html#moca.sublattice.Sublattice" title="moca.sublattice.Sublattice"><em>Sublattice</em></a>) – list of active Sublattices to propose steps for. Active
sublattices are those that include sites with configuration
degrees of freedom DOFs, only occupancy on active sub-lattices’ active sites
are allowed to change.</p></li>
<li><p><strong>mcusher</strong> (<a class="reference internal" href="#moca.sampler.mcusher.MCUsher" title="moca.sampler.mcusher.MCUsher"><em>MCUsher</em></a>) – An instantiated MCUsher to use to create multisteps.</p></li>
<li><p><strong>step_lengths</strong> (<em>int</em><em> or </em><em>Sequence</em><em> of </em><em>int</em>) – The length or lengths of steps. If given a sequence of sizes, a size
is chosen at each proposal according to step_probabilities. The step
length proposed may be less in cases where the same site is chosen
more than once. This should become less and less likely for larger
supercells.</p></li>
<li><p><strong>step_probabilities</strong> (<em>Sequence</em><em> of </em><em>float</em>) – optional
A sequence of probabilities corresponding to the step lengths provided.
If none is given, then a uniform probability is used.</p></li>
<li><p><strong>rng</strong> (<em>np.Generator</em>) – optional
The given PRNG must be the same instance as that used by the kernel and
any bias terms, otherwise reproducibility will be compromised.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.mcusher.MultiStep.propose_step">
<span class="sig-name descname"><span class="pre">propose_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.MultiStep.propose_step" title="Permalink to this definition">#</a></dt>
<dd><p>Propose a step given an occupancy.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.mcusher.MultiStep.sublattice_probabilities">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sublattice_probabilities</span></span><a class="headerlink" href="#moca.sampler.mcusher.MultiStep.sublattice_probabilities" title="Permalink to this definition">#</a></dt>
<dd><p>Get the probabilities of choosing a sublattice.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.mcusher.Swap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Swap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sublattice_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.Swap" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moca.sampler.mcusher.MCUsher" title="moca.sampler.mcusher.MCUsher"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCUsher</span></code></a></p>
<p>Implementation of a simple swap step for two random sites.</p>
<p>Initialize MCMCStep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattices</strong> (<em>list</em><em> of </em><a class="reference internal" href="moca.html#moca.sublattice.Sublattice" title="moca.sublattice.Sublattice"><em>Sublattice</em></a>) – list of active Sublattices to propose steps for. Active
sublattices are those that include sites with configuration
degrees of freedom DOFs, only occupancy on active sub-lattices’
active sites are allowed to change.</p></li>
<li><p><strong>sublattice_probabilities</strong> (<em>list</em><em> of </em><em>float</em>) – optional
list of probabilities to pick a site from specific active
sublattices.</p></li>
<li><p><strong>rng</strong> (<em>np.Generator</em>) – optional
The given PRNG must be the same instance as that used by the kernel and
any bias terms, otherwise reproducibility will be compromised.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.mcusher.Swap.propose_step">
<span class="sig-name descname"><span class="pre">propose_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.Swap.propose_step" title="Permalink to this definition">#</a></dt>
<dd><p>Propose a single random swap step.</p>
<p>A step is given as a sequence of tuples, where each tuple is of the
form (site index, species code to set)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of tuples each with (index, code)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list(tuple)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.mcusher.TableFlip">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TableFlip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge_balanced</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_ergodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swap_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.TableFlip" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#moca.sampler.mcusher.MCUsher" title="moca.sampler.mcusher.MCUsher"><code class="xref py py-class docutils literal notranslate"><span class="pre">MCUsher</span></code></a></p>
<p>Implementation of table flips.</p>
<p>Use user-specified or auto-calculated flip tables. Does not
check the correctness of the flip tables.</p>
<p>No longer computing and assigning a-priori proabilities
before flip selection, and selects sites instead.</p>
<p>Direct use of this class is not recommended, because the
dict form of the flip table is not very easy to read and
write.</p>
<p>Initialize TableFlip.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattices</strong> (<em>list</em><em> of </em><a class="reference internal" href="moca.html#moca.sublattice.Sublattice" title="moca.sublattice.Sublattice"><em>Sublattice</em></a>) – list of Sublattices to propose steps for. Must
be all sublattices, including active and inactive
ones.</p></li>
<li><p><strong>rng</strong> (<em>np.Generator</em>) – optional
The given PRNG must be the same instance as that used by the
kernel and any bias terms, otherwise reproducibility will be
compromised.</p></li>
<li><p><strong>flip_table</strong> (<em>2D np.ndarray</em><em>[</em><em>int</em><em>]</em>) – Flip vectors in “n” format, as generated by a CompositionSpace.
If not given, we will initialize a CompositionSpace from
sublattice information, and calculate the flip table
with that CompositionSpace.
Notice:
1, We suggest you provide a pre-computed flip table, unless
the number of sites in sub-lattices can be reduced to very
small when divided with their GCD.
2, As implemented in the Sublattice class,
you are allowed to have multiple species on an inactive
sub-lattice, but it is not the suggested approach.
In this case, you have 3 choices. Either always try to split
until all inactive sub-lattices only have one species
(suggested), fixing number of inactive species as a
constraint, or pre-compute your own flip table.</p></li>
<li><p><strong>charge_balanced</strong> (<em>bool</em>) – optional
Whether to add charge balance constraint. Default
to true.</p></li>
<li><p><strong>other_constraints</strong> (<em>List</em><em>[</em><em>tuple</em><em>(</em><em>1D arrayLike</em><em>[</em><em>int</em><em>]</em><em>, </em><em>int</em><em>)</em><em>]</em>) – optional
Other integer constraints except charge balance and
site-number conservation. Should be given in the form of
tuple(a, bb), each gives constraint np.dot(a, n)=bb.</p></li>
<li><p><strong>optimize_basis</strong> (<em>bool</em>) – optional
Whether to optimize the basis to minimal flip sizes and maximal
connectivity in the minimum super-cell size.
When the minimal super-cell size is large, we recommend not to
optimize basis.</p></li>
<li><p><strong>table_ergodic</strong> (<em>bool</em>) – optional
When generating a flip table, whether to add vectors and
ensure ergodicity under a minimal super-cell size.
Default to False.
When the minimal super-cell size is large, we recommend not to
ensure ergodicity. This is not only because of the computation
difficulty; but also because at large super-cell size,
the fraction of inaccessible compositions usually becomes
minimal.</p></li>
<li><p><strong>swap_weight</strong> (<em>float</em>) – optional
Percentage of canonical swaps to attempt. Should be a
positive value, but smaller than 1.
Default to 0.1.</p></li>
<li><p><strong>flip_weights</strong> (<em>1D Arraylike</em>) – optional
Weights to adjust probability of each flip. If
None given, will assign equal weights to each
flip vector and its inverse. Length must equal to
2*len(flip_table).</p></li>
</ul>
</dd>
</dl>
<p>Note: In table flip, adding proposal bias to different
sub-lattices is not meaningful. We will always assign
sub-lattice probabilities as equal.</p>
<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.mcusher.TableFlip.compute_log_priori_factor">
<span class="sig-name descname"><span class="pre">compute_log_priori_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.TableFlip.compute_log_priori_factor" title="Permalink to this definition">#</a></dt>
<dd><p>Compute a-priori weight to adjust step acceptance ratio.</p>
<p>This is essential in keeping detailed balance. Return log for
numerical accuracy.</p>
<dl class="simple">
<dt>Arg:</dt><dd><dl class="simple">
<dt>occupancy (ndarray):</dt><dd><p>encoded occupancy string. (Processor encoding.)</p>
</dd>
<dt>step (list[tuple]):</dt><dd><p>Metropolis step. list of tuples each with (index, code).
(Processor encoding.)</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>log of a-priori adjustment ratio.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.mcusher.TableFlip.propose_step">
<span class="sig-name descname"><span class="pre">propose_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.TableFlip.propose_step" title="Permalink to this definition">#</a></dt>
<dd><p>Propose a single random flip step.</p>
<p>A step is given as a sequence of tuples, where each tuple is of the
form (site index, species code to set)</p>
<p>1, Pick a flip in table;
2, Choose sites from site specie statistics list according to the flip.
3, (Acceptance proability will be adjusted according to a-priori</p>
<blockquote>
<div><p>weight to enforce detailed balance.)</p>
</div></blockquote>
<dl class="simple">
<dt>4, If selection failed, may or may not attempt a canonical swap based</dt><dd><p>on self.add_swap parameter.</p>
</dd>
</dl>
<p>There are circumstances where the current occupancy can not be accessed
by minimal table flips. This method does not take care of that, please
be careful when choosing starting compositions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>occupancy</strong> (<em>ndarray</em>) – encoded occupancy string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of tuples each with (idex, code).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list(tuple)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="moca.sampler.mcusher.mcusher_factory">
<span class="sig-name descname"><span class="pre">mcusher_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">usher_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sublattices</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.mcusher.mcusher_factory" title="Permalink to this definition">#</a></dt>
<dd><p>Get a MC Usher from string name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>usher_type</strong> (<em>str</em>) – string specifying step to instantiate.</p></li>
<li><p><strong>sublattices</strong> (<em>list</em><em> of </em><a class="reference internal" href="moca.html#moca.sublattice.Sublattice" title="moca.sublattice.Sublattice"><em>Sublattice</em></a>) – list of Sublattices to propose steps for.</p></li>
<li><p><strong>*args</strong> – positional arguments passed to class constructor</p></li>
<li><p><strong>**kwargs</strong> – keyword arguments passed to class constructor</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>instance of derived class.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#moca.sampler.mcusher.MCUsher" title="moca.sampler.mcusher.MCUsher">MCUsher</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-moca.sampler.sampler">
<span id="moca-sampler-sampler-module"></span><h2>moca.sampler.sampler module<a class="headerlink" href="#module-moca.sampler.sampler" title="Permalink to this heading">#</a></h2>
<p>Implementation of base sampler classes.</p>
<p>A sampler essentially is an implementation of the MCMC algorithm that is used
by the corresponding ensemble to generate Monte Carlo samples.</p>
<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.sampler.Sampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">container</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.sampler.Sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A sampler is used to run MCMC sampling simulations.</p>
<p>The specific MCMC algorithm is defined by the given MCKernel.
The default will use a simple Metropolis random walk kernel.</p>
<p>Initialize BaseSampler.</p>
<p>It is recommended to initialize a sampler with the from_ensemble
method, unless you need more control over the sampling kernel,
mcusher, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernels</strong> (<em>[</em><a class="reference internal" href="#moca.sampler.kernel.MCKernel" title="moca.sampler.kernel.MCKernel"><em>MCKernel</em></a><em>]</em>) – <p>a list of MCKernel instances for each walker.
Note: we only support the same type of kernel and the</p>
<blockquote>
<div><p>same ensemble for all walkers.</p>
</div></blockquote>
</p></li>
<li><p><strong>container</strong> (<a class="reference internal" href="moca.html#moca.SampleContainer" title="moca.SampleContainer"><em>SampleContainer</em></a>) – a sampler container to store samples.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.sampler.Sampler.anneal">
<span class="sig-name descname"><span class="pre">anneal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperatures</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcmc_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_occupancies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_chunk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swmr_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.sampler.Sampler.anneal" title="Permalink to this definition">#</a></dt>
<dd><p>Carry out a simulated annealing procedure.</p>
<p>Will MC sampling for each temperature for the specified number of steps,
taking the last sampled configuration at each temperature as the starting
configuration for the next temperature.</p>
<p>Everything is saved to the same SampleContainer, or if streaming, saved to the
same file. To save each temperature in a different container, simply run
a similar “for loop” creating a new sampler at each temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperatures</strong> (<em>Sequence</em>) – sequence of temperatures to anneal, should be strictly
decreasing.
Note: only available for ThermalKernel.</p></li>
<li><p><strong>mcmc_steps</strong> (<em>int</em>) – number of Monte Carlo steps to run at each temperature.</p></li>
<li><p><strong>initial_occupancies</strong> (<em>ndarray</em>) – array of occupancies. If None, the last sample will be taken.
You should only provide this the first time you call run.</p></li>
<li><p><strong>thin_by</strong> (<em>int</em>) – optional
amount to thin by for saving samples.</p></li>
<li><p><strong>progress</strong> (<em>bool</em>) – if true will show a progress bar.</p></li>
<li><p><strong>stream_chunk</strong> (<em>int</em>) – optional
chunk of samples to stream into a file. If &gt; 0 samples will
be flushed to backend file in stream_chucks</p></li>
<li><p><strong>stream_file</strong> (<em>str</em>) – optional
file name to use as backend. If file already exists will try
to append to datasets. If not given will create a new file.</p></li>
<li><p><strong>swmr_mode</strong> (<em>bool</em>) – optional
if true allows to read file from other processes. Single Writer
Multiple Readers.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.sampler.Sampler.clear_samples">
<span class="sig-name descname"><span class="pre">clear_samples</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.sampler.Sampler.clear_samples" title="Permalink to this definition">#</a></dt>
<dd><p>Clear samples from sampler container.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.sampler.Sampler.efficiency">
<span class="sig-name descname"><span class="pre">efficiency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.sampler.Sampler.efficiency" title="Permalink to this definition">#</a></dt>
<dd><p>Get the efficiency of MCMC sampling (accepted/total).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.sampler.Sampler.from_ensemble">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_ensemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ensemble</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seeds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwalkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.sampler.Sampler.from_ensemble" title="Permalink to this definition">#</a></dt>
<dd><p>Create a sampler based on an Ensemble instance.</p>
<p>This is the easier way to set up a Sampler. This will
automatically populate and create an appropriate SampleContainer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ensemble</strong> (<a class="reference internal" href="moca.html#moca.Ensemble" title="moca.Ensemble"><em>Ensemble</em></a>) – an Ensemble class to obtain sample probabilities from.</p></li>
<li><p><strong>step_type</strong> (<em>str</em>) – optional
type of step to run MCMC with. If not given the default depends on
whether chemical potentials are defined.</p></li>
<li><p><strong>*args</strong> – positional arguments to pass to the MCKernel constructor.
More often than not you want to specify the temperature!</p></li>
<li><p><strong>kernel_type</strong> (<em>str</em>) – optional
string specifying the specific MCMC transition kernel. This
represents the underlying MC algorithm. Currently only
Metropolis is supported.</p></li>
<li><p><strong>seeds</strong> (<em>[</em><em>int</em><em>]</em>) – optional
seed for the PRNG in each kernel.</p></li>
<li><p><strong>nwalkers</strong> (<em>int</em>) – optional
number of walkers/chains to sampler. Default is 1. More than 1
is still experimental…</p></li>
<li><p><strong>**kwargs</strong> – keyword arguments to pass to the MCKernel constructor.
More often than not you want to specify the temperature!</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampler</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.sampler.Sampler.mckernels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mckernels</span></span><a class="headerlink" href="#moca.sampler.sampler.Sampler.mckernels" title="Permalink to this definition">#</a></dt>
<dd><p>Get the underlying ensemble.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.sampler.Sampler.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_occupancies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_chunk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_last_chunk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swmr_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.sampler.Sampler.run" title="Permalink to this definition">#</a></dt>
<dd><p>Run an MCMC sampling simulation.</p>
<p>This will run and save the samples every thin_by into a
SampleContainer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nsteps</strong> (<em>int</em>) – number of total MC steps.</p></li>
<li><p><strong>initial_occupancies</strong> (<em>ndarray</em>) – array of occupancies. If None, the last sampler will be taken.
You should only provide this the first time you call run. If
you want to reset then you should call reset before to start
a fresh run.</p></li>
<li><p><strong>thin_by</strong> (<em>int</em>) – optional
the amount to thin by for saving samples.</p></li>
<li><p><strong>progress</strong> (<em>bool</em>) – optional
if true will show a progress bar.</p></li>
<li><p><strong>stream_chunk</strong> (<em>int</em>) – optional
chunk of samples to stream into a file. If &gt; 0 samples will
be flushed to backend file in stream_chucks</p></li>
<li><p><strong>stream_file</strong> (<em>str</em>) – optional
file name to use as backend. If file already exists will try
to append to datasets. If not given will create a new file.</p></li>
<li><p><strong>keep_last_chunk</strong> (<em>bool</em>) – optional
if True will keep the last chunk of samples in memory, but will reset
the sampler otherwise. This is useful if the last occupancies are
needed to start another run (ie for simulated annealing with streaming)</p></li>
<li><p><strong>swmr_mode</strong> (<em>bool</em>) – optional
if true allows to read file from other processes. Single Writer
Multiple Readers.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.sampler.Sampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_occupancies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.sampler.Sampler.sample" title="Permalink to this definition">#</a></dt>
<dd><p>Generate MCMC samples.</p>
<p>Yield a sampler state every <cite>thin_by</cite> iterations. A state is give by
a tuple of (occupancies, features, enthalpy)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nsteps</strong> (<em>int</em>) – number of iterations to run.</p></li>
<li><p><strong>initial_occupancies</strong> (<em>ndarray</em>) – array of occupancies</p></li>
<li><p><strong>thin_by</strong> (<em>int</em>) – optional
number to thin iterations by and provide samples.</p></li>
<li><p><strong>progress</strong> (<em>bool</em>) – If true will show a progress bar.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>tuple</em> – accepted, occupancies, features change, enthalpies change</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.sampler.Sampler.samples">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">samples</span></span><a class="headerlink" href="#moca.sampler.sampler.Sampler.samples" title="Permalink to this definition">#</a></dt>
<dd><p>Get the SampleContainer.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.sampler.Sampler.seeds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">seeds</span></span><a class="headerlink" href="#moca.sampler.sampler.Sampler.seeds" title="Permalink to this definition">#</a></dt>
<dd><p>Seed for the random number generator.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-moca.sampler">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-moca.sampler" title="Permalink to this heading">#</a></h2>
<p>Implementation of Relevant classes for MCMC Sampling.</p>
<p>Samplers should derive from ABC Sampler classes whenever possible.</p>
<p>MCMCUshers are used to propose different kinds of MC steps for specific
simulations.</p>
<p>Samples are saved in a Sample Container.</p>
<dl class="py class">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SampleContainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ensemble</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MSONable</span></code></p>
<p>A SampleContainer class stores Monte Carlo simulation samples.</p>
<p>A SampleContainer holds samples and sampling information from an MCMC
sampling run. It is useful to obtain the raw data and minimal empirical
properties of the underlying distribution in order to carry out further
analysis of the MCMC sampling results.</p>
<p>When getting any value from the provided attributes, the highly repeated
args are:</p>
<blockquote>
<div><dl class="simple">
<dt>discard (int): optional</dt><dd><p>number of samples to discard to obtain the value requested.</p>
</dd>
<dt>thin_by (int): optional</dt><dd><p>use every thin_by sample to obtain the value requested.</p>
</dd>
<dt>flat (bool): optional</dt><dd><p>if more than 1 walker is used, flattening will flatten all
chains into one. Defaults to True.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.num_sites">
<span class="sig-name descname"><span class="pre">num_sites</span></span><a class="headerlink" href="#moca.sampler.SampleContainer.num_sites" title="Permalink to this definition">#</a></dt>
<dd><p>Size of system (usually in number of prims in supercell, but
can be anything representative, i.e. number of sites)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.sublattices">
<span class="sig-name descname"><span class="pre">sublattices</span></span><a class="headerlink" href="#moca.sampler.SampleContainer.sublattices" title="Permalink to this definition">#</a></dt>
<dd><p>Sublattices of the ensemble sampled.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of <a class="reference internal" href="moca.html#moca.sublattice.Sublattice" title="moca.sublattice.Sublattice">Sublattice</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.natural_parameters">
<span class="sig-name descname"><span class="pre">natural_parameters</span></span><a class="headerlink" href="#moca.sampler.SampleContainer.natural_parameters" title="Permalink to this definition">#</a></dt>
<dd><p>Array of natural parameters used in the ensemble.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><a class="headerlink" href="#moca.sampler.SampleContainer.metadata" title="Permalink to this definition">#</a></dt>
<dd><p>Dictionary of metadata from the MC run that generated the samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<p>Initialize a sample container.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ensemble</strong> (<a class="reference internal" href="moca.html#moca.Ensemble" title="moca.Ensemble"><em>Ensemble</em></a>) – Ensemble object used to generate the samples.</p></li>
<li><p><strong>sample_trace</strong> (<em>Trace</em>) – a trace object for the traced values during MC sampling</p></li>
<li><p><strong>sampling_metadata</strong> (<a class="reference internal" href="moca.html#moca.Ensemble" title="moca.Ensemble"><em>Ensemble</em></a>) – sampling metadata (i.e. ensemble name, mckernel type, etc)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.allocate">
<span class="sig-name descname"><span class="pre">allocate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsamples</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.allocate" title="Permalink to this definition">#</a></dt>
<dd><p>Allocate more space in arrays for more samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.as_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Get Json-serialization dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>MSONable dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.clear" title="Permalink to this definition">#</a></dt>
<dd><p>Clear all samples from container.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.composition_variance">
<span class="sig-name descname"><span class="pre">composition_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.composition_variance" title="Permalink to this definition">#</a></dt>
<dd><p>Get the variance in composition of all species.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.energy_variance">
<span class="sig-name descname"><span class="pre">energy_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.energy_variance" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the variance of sampled energies.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.ensemble">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ensemble</span></span><a class="headerlink" href="#moca.sampler.SampleContainer.ensemble" title="Permalink to this definition">#</a></dt>
<dd><p>Return the ensemble name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.enthalpy_variance">
<span class="sig-name descname"><span class="pre">enthalpy_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.enthalpy_variance" title="Permalink to this definition">#</a></dt>
<dd><p>Get the variance in enthalpy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.feature_vector_variance">
<span class="sig-name descname"><span class="pre">feature_vector_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.feature_vector_variance" title="Permalink to this definition">#</a></dt>
<dd><p>Get the variance of feature vector elements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.flush_to_backend">
<span class="sig-name descname"><span class="pre">flush_to_backend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backend</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.flush_to_backend" title="Permalink to this definition">#</a></dt>
<dd><p>Flush current samples and trace to backend file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>backend</strong> (<em>object</em>) – backend file object, currently only hdf5 supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Instantiate a SampleContainer from dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>dict</em>) – dictionary representation.</p></li>
<li><p><strong>ensemble</strong> (<a class="reference internal" href="moca.html#moca.Ensemble" title="moca.Ensemble"><em>Ensemble</em></a>) – optional
The ensemble object to used for generating samples. Only needed to
update legacy files.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>SampleContainer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.from_hdf5">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swmr_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.from_hdf5" title="Permalink to this definition">#</a></dt>
<dd><p>Instantiate a SampleContainer from an hdf5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>str</em>) – path to file</p></li>
<li><p><strong>swmr_mode</strong> (<em>bool</em>) – optional
If true allows to read file from other processes. Single Writer
Multiple Readers.</p></li>
<li><p><strong>ensemble</strong> (<a class="reference internal" href="moca.html#moca.Ensemble" title="moca.Ensemble"><em>Ensemble</em></a>) – optional
The ensemble object to used for generating samples. Only needed to
update legacy files.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>SampleContainer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.get_backend">
<span class="sig-name descname"><span class="pre">get_backend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alloc_nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swmr_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.get_backend" title="Permalink to this definition">#</a></dt>
<dd><p>Get a backend file object.</p>
<p>Currently only hdf5 files supported</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>str</em>) – path to backend file.</p></li>
<li><p><strong>alloc_nsamples</strong> (<em>int</em>) – optional
number of new samples to allocate. Will only extend datasets
if number given is larger than space left to write samples
into.</p></li>
<li><p><strong>swmr_mode</strong> (<em>bool</em>) – optional
If true allows to read file from other processes. Single Writer
Multiple Readers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>h5.File object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.get_compositions">
<span class="sig-name descname"><span class="pre">get_compositions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.get_compositions" title="Permalink to this definition">#</a></dt>
<dd><p>Get the compositions for each occupancy in the chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.get_energies">
<span class="sig-name descname"><span class="pre">get_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.get_energies" title="Permalink to this definition">#</a></dt>
<dd><p>Get the energies from samples in chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.get_enthalpies">
<span class="sig-name descname"><span class="pre">get_enthalpies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.get_enthalpies" title="Permalink to this definition">#</a></dt>
<dd><p>Get the generalized enthalpy changes from samples in chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.get_feature_vectors">
<span class="sig-name descname"><span class="pre">get_feature_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.get_feature_vectors" title="Permalink to this definition">#</a></dt>
<dd><p>Get the feature vector changes from samples in chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.get_minimum_energy">
<span class="sig-name descname"><span class="pre">get_minimum_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.get_minimum_energy" title="Permalink to this definition">#</a></dt>
<dd><p>Get the minimum energy from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.get_minimum_energy_occupancy">
<span class="sig-name descname"><span class="pre">get_minimum_energy_occupancy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.get_minimum_energy_occupancy" title="Permalink to this definition">#</a></dt>
<dd><p>Find the occupancy with minimum energy from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.get_minimum_enthalpy">
<span class="sig-name descname"><span class="pre">get_minimum_enthalpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.get_minimum_enthalpy" title="Permalink to this definition">#</a></dt>
<dd><p>Get the minimum energy from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.get_minimum_enthalpy_occupancy">
<span class="sig-name descname"><span class="pre">get_minimum_enthalpy_occupancy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.get_minimum_enthalpy_occupancy" title="Permalink to this definition">#</a></dt>
<dd><p>Find the occupancy with minimum energy from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.get_occupancies">
<span class="sig-name descname"><span class="pre">get_occupancies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.get_occupancies" title="Permalink to this definition">#</a></dt>
<dd><p>Get the occupancy chain of the samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.get_orbit_factors">
<span class="sig-name descname"><span class="pre">get_orbit_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_orbit_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.get_orbit_factors" title="Permalink to this definition">#</a></dt>
<dd><p>Get the orbit factor vectors for samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.get_sampled_structures">
<span class="sig-name descname"><span class="pre">get_sampled_structures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.get_sampled_structures" title="Permalink to this definition">#</a></dt>
<dd><p>Get sampled structures for MC steps given by indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>list</em><em> of </em><em>int</em><em> or </em><em>int</em>) – A single index or list of indices to obtain sampled structures.</p></li>
<li><p><strong>flat</strong> (<em>bool</em>) – optional
If true will flatten chains, and the indices correspond to flattened
values. If false chain is not flattened, and if multiple walkers where
used returns a list of list where each inner list has the sampled
structure for each walker. Default is set to flat True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of Structure or list of list of Structure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.get_species_counts">
<span class="sig-name descname"><span class="pre">get_species_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.get_species_counts" title="Permalink to this definition">#</a></dt>
<dd><p>Get the species counts for each occupancy in the chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.get_sublattice_compositions">
<span class="sig-name descname"><span class="pre">get_sublattice_compositions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.get_sublattice_compositions" title="Permalink to this definition">#</a></dt>
<dd><p>Get the compositions of a specific sublattice.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.get_sublattice_species_counts">
<span class="sig-name descname"><span class="pre">get_sublattice_species_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.get_sublattice_species_counts" title="Permalink to this definition">#</a></dt>
<dd><p>Get the counts of each species in a sublattices.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>where last axis is the count for each species in the
same order as the underlying site space.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.get_trace_value">
<span class="sig-name descname"><span class="pre">get_trace_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.get_trace_value" title="Permalink to this definition">#</a></dt>
<dd><p>Get sampled values of a traced value given by name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.mean_composition">
<span class="sig-name descname"><span class="pre">mean_composition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.mean_composition" title="Permalink to this definition">#</a></dt>
<dd><p>Get mean composition for all species regardless of sublattice.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.mean_energy">
<span class="sig-name descname"><span class="pre">mean_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.mean_energy" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the mean energy from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.mean_enthalpy">
<span class="sig-name descname"><span class="pre">mean_enthalpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.mean_enthalpy" title="Permalink to this definition">#</a></dt>
<dd><p>Get the mean generalized enthalpy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.mean_feature_vector">
<span class="sig-name descname"><span class="pre">mean_feature_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.mean_feature_vector" title="Permalink to this definition">#</a></dt>
<dd><p>Get the mean feature vector from samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.mean_sublattice_composition">
<span class="sig-name descname"><span class="pre">mean_sublattice_composition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.mean_sublattice_composition" title="Permalink to this definition">#</a></dt>
<dd><p>Get the mean composition of a specific sublattice.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.mean_trace_value">
<span class="sig-name descname"><span class="pre">mean_trace_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.mean_trace_value" title="Permalink to this definition">#</a></dt>
<dd><p>Get mean of a traced value given by name.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">natural_parameters</span></span><a class="headerlink" href="#id2" title="Permalink to this definition">#</a></dt>
<dd><p>Return the natural parameters.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.num_samples">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_samples</span></span><a class="headerlink" href="#moca.sampler.SampleContainer.num_samples" title="Permalink to this definition">#</a></dt>
<dd><p>Get the total number of samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.sampling_efficiency">
<span class="sig-name descname"><span class="pre">sampling_efficiency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.sampling_efficiency" title="Permalink to this definition">#</a></dt>
<dd><p>Return the sampling efficiency for chains.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.save_sampled_trace">
<span class="sig-name descname"><span class="pre">save_sampled_trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thinned_by</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.save_sampled_trace" title="Permalink to this definition">#</a></dt>
<dd><p>Save a sampled trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>Trace</em>) – Trace of sampled values</p></li>
<li><p><strong>thinned_by</strong> (<em>int</em>) – the amount that the sampling was thinned by. Used to update
the total mc iterations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#moca.sampler.SampleContainer.shape" title="Permalink to this definition">#</a></dt>
<dd><p>Get the shape of the samples in chain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.sublattice_composition_variance">
<span class="sig-name descname"><span class="pre">sublattice_composition_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sublattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.sublattice_composition_variance" title="Permalink to this definition">#</a></dt>
<dd><p>Get the variance in composition of a specific sublattice.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id3">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sublattices</span></span><a class="headerlink" href="#id3" title="Permalink to this definition">#</a></dt>
<dd><p>Return the sublattices.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.to_hdf5">
<span class="sig-name descname"><span class="pre">to_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.to_hdf5" title="Permalink to this definition">#</a></dt>
<dd><p>Save SampleContainer as an HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>str</em>) – path to file save location. If file exists and dimensions
match samples will be appended.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.total_mc_steps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_mc_steps</span></span><a class="headerlink" href="#moca.sampler.SampleContainer.total_mc_steps" title="Permalink to this definition">#</a></dt>
<dd><p>Return the total number of MC steps taken during sampling.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.trace_value_variance">
<span class="sig-name descname"><span class="pre">trace_value_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thin_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#moca.sampler.SampleContainer.trace_value_variance" title="Permalink to this definition">#</a></dt>
<dd><p>Get variance of a traced value given by name.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="moca.sampler.SampleContainer.traced_values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">traced_values</span></span><a class="headerlink" href="#moca.sampler.SampleContainer.traced_values" title="Permalink to this definition">#</a></dt>
<dd><p>Get the names of traced values being sampled.</p>
</dd></dl>

</dd></dl>

</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submodules">
   Submodules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-moca.sampler.bias">
   moca.sampler.bias module
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.bias.FugacityBias">
     <code class="docutils literal notranslate">
      <span class="pre">
       FugacityBias
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.bias.FugacityBias.compute_bias">
       <code class="docutils literal notranslate">
        <span class="pre">
         FugacityBias.compute_bias()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.bias.FugacityBias.compute_bias_change">
       <code class="docutils literal notranslate">
        <span class="pre">
         FugacityBias.compute_bias_change()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.bias.FugacityBias.fugacity_fractions">
       <code class="docutils literal notranslate">
        <span class="pre">
         FugacityBias.fugacity_fractions
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.bias.MCBias">
     <code class="docutils literal notranslate">
      <span class="pre">
       MCBias
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.bias.MCBias.sublattices">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCBias.sublattices
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.bias.MCBias.compute_bias">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCBias.compute_bias()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.bias.MCBias.compute_bias_change">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCBias.compute_bias_change()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.bias.SquareChargeBias">
     <code class="docutils literal notranslate">
      <span class="pre">
       SquareChargeBias
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.bias.SquareChargeBias.compute_bias">
       <code class="docutils literal notranslate">
        <span class="pre">
         SquareChargeBias.compute_bias()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.bias.SquareChargeBias.compute_bias_change">
       <code class="docutils literal notranslate">
        <span class="pre">
         SquareChargeBias.compute_bias_change()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.bias.SquareHyperplaneBias">
     <code class="docutils literal notranslate">
      <span class="pre">
       SquareHyperplaneBias
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.bias.SquareHyperplaneBias.compute_bias">
       <code class="docutils literal notranslate">
        <span class="pre">
         SquareHyperplaneBias.compute_bias()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.bias.SquareHyperplaneBias.compute_bias_change">
       <code class="docutils literal notranslate">
        <span class="pre">
         SquareHyperplaneBias.compute_bias_change()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.bias.mcbias_factory">
     <code class="docutils literal notranslate">
      <span class="pre">
       mcbias_factory()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-moca.sampler.container">
   moca.sampler.container module
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer">
     <code class="docutils literal notranslate">
      <span class="pre">
       SampleContainer
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.num_sites">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.num_sites
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.sublattices">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.sublattices
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.natural_parameters">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.natural_parameters
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.metadata">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.metadata
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.allocate">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.allocate()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.as_dict">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.as_dict()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.clear">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.clear()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.composition_variance">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.composition_variance()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.energy_variance">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.energy_variance()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.ensemble">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.ensemble
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.enthalpy_variance">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.enthalpy_variance()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.feature_vector_variance">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.feature_vector_variance()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.flush_to_backend">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.flush_to_backend()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.from_dict">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.from_dict()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.from_hdf5">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.from_hdf5()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.get_backend">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_backend()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.get_compositions">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_compositions()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.get_energies">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_energies()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.get_enthalpies">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_enthalpies()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.get_feature_vectors">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_feature_vectors()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.get_minimum_energy">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_minimum_energy()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.get_minimum_energy_occupancy">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_minimum_energy_occupancy()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.get_minimum_enthalpy">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_minimum_enthalpy()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.get_minimum_enthalpy_occupancy">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_minimum_enthalpy_occupancy()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.get_occupancies">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_occupancies()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.get_orbit_factors">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_orbit_factors()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.get_sampled_structures">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_sampled_structures()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.get_species_counts">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_species_counts()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.get_sublattice_compositions">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_sublattice_compositions()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.get_sublattice_species_counts">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_sublattice_species_counts()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.get_trace_value">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_trace_value()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.mean_composition">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.mean_composition()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.mean_energy">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.mean_energy()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.mean_enthalpy">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.mean_enthalpy()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.mean_feature_vector">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.mean_feature_vector()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.mean_sublattice_composition">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.mean_sublattice_composition()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.mean_trace_value">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.mean_trace_value()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id0">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.natural_parameters
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.num_samples">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.num_samples
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.sampling_efficiency">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.sampling_efficiency()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.save_sampled_trace">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.save_sampled_trace()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.shape">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.shape
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.sublattice_composition_variance">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.sublattice_composition_variance()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.sublattices
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.to_hdf5">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.to_hdf5()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.total_mc_steps">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.total_mc_steps
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.trace_value_variance">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.trace_value_variance()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.container.SampleContainer.traced_values">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.traced_values
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-moca.sampler.kernel">
   moca.sampler.kernel module
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.kernel.MCKernel">
     <code class="docutils literal notranslate">
      <span class="pre">
       MCKernel
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.MCKernel.bias">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCKernel.bias
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.MCKernel.compute_initial_trace">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCKernel.compute_initial_trace()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.MCKernel.ensemble">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCKernel.ensemble
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.MCKernel.mcusher">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCKernel.mcusher
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.MCKernel.seed">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCKernel.seed
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.MCKernel.set_aux_state">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCKernel.set_aux_state()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.MCKernel.single_step">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCKernel.single_step()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.MCKernel.valid_bias">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCKernel.valid_bias
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.MCKernel.valid_mcushers">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCKernel.valid_mcushers
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.kernel.Metropolis">
     <code class="docutils literal notranslate">
      <span class="pre">
       Metropolis
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.Metropolis.single_step">
       <code class="docutils literal notranslate">
        <span class="pre">
         Metropolis.single_step()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.Metropolis.valid_bias">
       <code class="docutils literal notranslate">
        <span class="pre">
         Metropolis.valid_bias
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.Metropolis.valid_mcushers">
       <code class="docutils literal notranslate">
        <span class="pre">
         Metropolis.valid_mcushers
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.kernel.ThermalKernel">
     <code class="docutils literal notranslate">
      <span class="pre">
       ThermalKernel
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.ThermalKernel.compute_initial_trace">
       <code class="docutils literal notranslate">
        <span class="pre">
         ThermalKernel.compute_initial_trace()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.ThermalKernel.set_aux_state">
       <code class="docutils literal notranslate">
        <span class="pre">
         ThermalKernel.set_aux_state()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.ThermalKernel.temperature">
       <code class="docutils literal notranslate">
        <span class="pre">
         ThermalKernel.temperature
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.kernel.UniformlyRandom">
     <code class="docutils literal notranslate">
      <span class="pre">
       UniformlyRandom
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.UniformlyRandom.single_step">
       <code class="docutils literal notranslate">
        <span class="pre">
         UniformlyRandom.single_step()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.UniformlyRandom.valid_bias">
       <code class="docutils literal notranslate">
        <span class="pre">
         UniformlyRandom.valid_bias
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.UniformlyRandom.valid_mcushers">
       <code class="docutils literal notranslate">
        <span class="pre">
         UniformlyRandom.valid_mcushers
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.kernel.WangLandau">
     <code class="docutils literal notranslate">
      <span class="pre">
       WangLandau
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.WangLandau.bin_size">
       <code class="docutils literal notranslate">
        <span class="pre">
         WangLandau.bin_size
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.WangLandau.compute_initial_trace">
       <code class="docutils literal notranslate">
        <span class="pre">
         WangLandau.compute_initial_trace()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.WangLandau.dos">
       <code class="docutils literal notranslate">
        <span class="pre">
         WangLandau.dos
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.WangLandau.entropy">
       <code class="docutils literal notranslate">
        <span class="pre">
         WangLandau.entropy
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.WangLandau.histogram">
       <code class="docutils literal notranslate">
        <span class="pre">
         WangLandau.histogram
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.WangLandau.levels">
       <code class="docutils literal notranslate">
        <span class="pre">
         WangLandau.levels
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.WangLandau.mod_factor">
       <code class="docutils literal notranslate">
        <span class="pre">
         WangLandau.mod_factor
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.WangLandau.set_aux_state">
       <code class="docutils literal notranslate">
        <span class="pre">
         WangLandau.set_aux_state()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.WangLandau.single_step">
       <code class="docutils literal notranslate">
        <span class="pre">
         WangLandau.single_step()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.WangLandau.valid_bias">
       <code class="docutils literal notranslate">
        <span class="pre">
         WangLandau.valid_bias
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.kernel.WangLandau.valid_mcushers">
       <code class="docutils literal notranslate">
        <span class="pre">
         WangLandau.valid_mcushers
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.kernel.mckernel_factory">
     <code class="docutils literal notranslate">
      <span class="pre">
       mckernel_factory()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-moca.sampler.mcusher">
   moca.sampler.mcusher module
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.mcusher.Composite">
     <code class="docutils literal notranslate">
      <span class="pre">
       Composite
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.mcusher.Composite.add_mcusher">
       <code class="docutils literal notranslate">
        <span class="pre">
         Composite.add_mcusher()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.mcusher.Composite.mcushers">
       <code class="docutils literal notranslate">
        <span class="pre">
         Composite.mcushers
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.mcusher.Composite.propose_step">
       <code class="docutils literal notranslate">
        <span class="pre">
         Composite.propose_step()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.mcusher.Composite.weight">
       <code class="docutils literal notranslate">
        <span class="pre">
         Composite.weight
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.mcusher.Flip">
     <code class="docutils literal notranslate">
      <span class="pre">
       Flip
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.mcusher.Flip.propose_step">
       <code class="docutils literal notranslate">
        <span class="pre">
         Flip.propose_step()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.mcusher.MCUsher">
     <code class="docutils literal notranslate">
      <span class="pre">
       MCUsher
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.mcusher.MCUsher.compute_log_priori_factor">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCUsher.compute_log_priori_factor()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.mcusher.MCUsher.get_random_sublattice">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCUsher.get_random_sublattice()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.mcusher.MCUsher.propose_step">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCUsher.propose_step()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.mcusher.MCUsher.set_aux_state">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCUsher.set_aux_state()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.mcusher.MCUsher.sublattice_probabilities">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCUsher.sublattice_probabilities
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.mcusher.MCUsher.update_aux_state">
       <code class="docutils literal notranslate">
        <span class="pre">
         MCUsher.update_aux_state()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.mcusher.MultiStep">
     <code class="docutils literal notranslate">
      <span class="pre">
       MultiStep
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.mcusher.MultiStep.propose_step">
       <code class="docutils literal notranslate">
        <span class="pre">
         MultiStep.propose_step()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.mcusher.MultiStep.sublattice_probabilities">
       <code class="docutils literal notranslate">
        <span class="pre">
         MultiStep.sublattice_probabilities
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.mcusher.Swap">
     <code class="docutils literal notranslate">
      <span class="pre">
       Swap
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.mcusher.Swap.propose_step">
       <code class="docutils literal notranslate">
        <span class="pre">
         Swap.propose_step()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.mcusher.TableFlip">
     <code class="docutils literal notranslate">
      <span class="pre">
       TableFlip
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.mcusher.TableFlip.compute_log_priori_factor">
       <code class="docutils literal notranslate">
        <span class="pre">
         TableFlip.compute_log_priori_factor()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.mcusher.TableFlip.propose_step">
       <code class="docutils literal notranslate">
        <span class="pre">
         TableFlip.propose_step()
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.mcusher.mcusher_factory">
     <code class="docutils literal notranslate">
      <span class="pre">
       mcusher_factory()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-moca.sampler.sampler">
   moca.sampler.sampler module
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.sampler.Sampler">
     <code class="docutils literal notranslate">
      <span class="pre">
       Sampler
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.sampler.Sampler.anneal">
       <code class="docutils literal notranslate">
        <span class="pre">
         Sampler.anneal()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.sampler.Sampler.clear_samples">
       <code class="docutils literal notranslate">
        <span class="pre">
         Sampler.clear_samples()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.sampler.Sampler.efficiency">
       <code class="docutils literal notranslate">
        <span class="pre">
         Sampler.efficiency()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.sampler.Sampler.from_ensemble">
       <code class="docutils literal notranslate">
        <span class="pre">
         Sampler.from_ensemble()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.sampler.Sampler.mckernels">
       <code class="docutils literal notranslate">
        <span class="pre">
         Sampler.mckernels
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.sampler.Sampler.run">
       <code class="docutils literal notranslate">
        <span class="pre">
         Sampler.run()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.sampler.Sampler.sample">
       <code class="docutils literal notranslate">
        <span class="pre">
         Sampler.sample()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.sampler.Sampler.samples">
       <code class="docutils literal notranslate">
        <span class="pre">
         Sampler.samples
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.sampler.Sampler.seeds">
       <code class="docutils literal notranslate">
        <span class="pre">
         Sampler.seeds
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-moca.sampler">
   Module contents
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moca.sampler.SampleContainer">
     <code class="docutils literal notranslate">
      <span class="pre">
       SampleContainer
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.num_sites">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.num_sites
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.sublattices">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.sublattices
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.natural_parameters">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.natural_parameters
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.metadata">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.metadata
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.allocate">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.allocate()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.as_dict">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.as_dict()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.clear">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.clear()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.composition_variance">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.composition_variance()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.energy_variance">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.energy_variance()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.ensemble">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.ensemble
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.enthalpy_variance">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.enthalpy_variance()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.feature_vector_variance">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.feature_vector_variance()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.flush_to_backend">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.flush_to_backend()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.from_dict">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.from_dict()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.from_hdf5">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.from_hdf5()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.get_backend">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_backend()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.get_compositions">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_compositions()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.get_energies">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_energies()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.get_enthalpies">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_enthalpies()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.get_feature_vectors">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_feature_vectors()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.get_minimum_energy">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_minimum_energy()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.get_minimum_energy_occupancy">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_minimum_energy_occupancy()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.get_minimum_enthalpy">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_minimum_enthalpy()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.get_minimum_enthalpy_occupancy">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_minimum_enthalpy_occupancy()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.get_occupancies">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_occupancies()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.get_orbit_factors">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_orbit_factors()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.get_sampled_structures">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_sampled_structures()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.get_species_counts">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_species_counts()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.get_sublattice_compositions">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_sublattice_compositions()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.get_sublattice_species_counts">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_sublattice_species_counts()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.get_trace_value">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.get_trace_value()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.mean_composition">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.mean_composition()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.mean_energy">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.mean_energy()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.mean_enthalpy">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.mean_enthalpy()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.mean_feature_vector">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.mean_feature_vector()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.mean_sublattice_composition">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.mean_sublattice_composition()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.mean_trace_value">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.mean_trace_value()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.natural_parameters
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.num_samples">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.num_samples
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.sampling_efficiency">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.sampling_efficiency()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.save_sampled_trace">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.save_sampled_trace()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.shape">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.shape
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.sublattice_composition_variance">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.sublattice_composition_variance()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.sublattices
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.to_hdf5">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.to_hdf5()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.total_mc_steps">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.total_mc_steps
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.trace_value_variance">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.trace_value_variance()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#moca.sampler.SampleContainer.traced_values">
       <code class="docutils literal notranslate">
        <span class="pre">
         SampleContainer.traced_values
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  

<div class="tocsection editthispage">
    <a href="https://github.com/CederGroupHub/smol/edit/main/docs/src/api_reference/autogen/moca.sampler.rst">
        <i class="fa-solid fa-pencil"></i> Edit this page
    </a>
</div>

</div>

<div class="toc-item">
  
</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2022-2023, Ceder Group.<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">
        PyData Sphinx Theme
    </a>
    0.12.0.
</p>
  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 6.1.3.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>