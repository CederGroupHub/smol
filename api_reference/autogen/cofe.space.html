
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>cofe.space package &#8212; smol 0.0.7 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/smol.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/require.js"></script>
    <script src="../../_static/custom.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/logo.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../getting_started.html">
  Getting Started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../user_guide.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../index.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../citing.html">
  Citing
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../developer_guide/index.html">
  Developing
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/CederGroupHub/smol/blob/master/CHANGES.md">Changes<i class="fas fa-external-link-alt"></i></a>
    </li>
    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/CederGroupHub/smol/issues">Issues<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        0.0.7  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables api_reference/autogen/cofe.space and {'json_url': 'https://pydata-sphinx-theme.readthedocs.io/en/latest/_static/switcher.json', 'url_template': 'https://pydata-sphinx-theme.readthedocs.io/en/v{version}/', 'version_match': '0.0.7'}.
-->

<script type="text/javascript">
// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "api_reference/autogen/cofe.space.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("https://pydata-sphinx-theme.readthedocs.io/en/latest/_static/switcher.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "api_reference/autogen/cofe.space.html";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            // Add dataset values for the version and name in case people want
            // to apply CSS styling based on this information.
            node.dataset["versionName"] = entry.name;
            node.dataset["version"] = entry.version;

            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's 0.0.7 variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "0.0.7") {
                node.classList.add("active");
                let btn = document.getElementById("version_switcher_button");
                btn.innerText = btn.dataset["activeVersionName"] = entry.name;
                btn.dataset["activeVersion"] = entry.version;
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/CederGroupHub/smol" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="cofe.extern.html">
   cofe.extern package
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   cofe.space package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cofe.wrangling.html">
   cofe.wrangling package
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submodules">
   Submodules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-cofe.space.basis">
   cofe.space.basis module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-cofe.space.cluster">
   cofe.space.cluster module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-cofe.space.clusterspace">
   cofe.space.clusterspace module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-cofe.space.constants">
   cofe.space.constants module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-cofe.space.domain">
   cofe.space.domain module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-cofe.space.orbit">
   cofe.space.orbit module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-cofe.space">
   Module contents
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/CederGroupHub/smol/edit/main/docs/src/api_reference/autogen/cofe.space.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="cofe-space-package">
<h1>cofe.space package<a class="headerlink" href="#cofe-space-package" title="Permalink to this headline">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">#</a></h2>
</section>
<section id="module-cofe.space.basis">
<span id="cofe-space-basis-module"></span><h2>cofe.space.basis module<a class="headerlink" href="#module-cofe.space.basis" title="Permalink to this headline">#</a></h2>
<p>Definitions for basis functions over a site function space.</p>
<p>The product of single site functions make up a cluster/orbit function used to
obtain correlation vectors. The domain of a site function is a site space,
which is defined by the allowed species at the site and their measures, i.e.
the concentration of the species in the random structure.</p>
<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.basis.BasisIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BasisIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.BasisIterator" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Iterator</span></code></p>
<p>Abstract basis iterator class.</p>
<p>A basis iterator iterates through all non-constant site basis functions,
i.e. for basis <span class="math notranslate nohighlight">\(\phi_0 = 1, \phi_1, ..., \phi_{n-1}\)</span>,
the iterator will iterate through <span class="math notranslate nohighlight">\(\phi_1, ..., \phi_{n-1}\)</span></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.basis.BasisIterator.flavor">
<span class="sig-name descname"><span class="pre">flavor</span></span><a class="headerlink" href="#cofe.space.basis.BasisIterator.flavor" title="Permalink to this definition">#</a></dt>
<dd><p>Name specifying the type of basis that is generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<p>Initialize a BasisIterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>species</strong> (<em>tuple</em>) – tuple of allowed species in site spaces</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">flavor</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'abstract'</span></em><a class="headerlink" href="#id0" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.basis.ChebyshevIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ChebyshevIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.ChebyshevIterator" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cofe.space.basis.NumpyPolyIterator" title="cofe.space.basis.NumpyPolyIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">cofe.space.basis.NumpyPolyIterator</span></code></a></p>
<p>Chebyshev polynomial basis set iterator.</p>
<p>Initialize a NumpyPolyIterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>species</strong> (<em>tuple</em>) – tuple of allowed species in site spaces</p></li>
<li><p><strong>low</strong> (<em>float</em>) – optional
lower limit of interval for encoding</p></li>
<li><p><strong>high</strong> (<em>float</em>) – optional
higher limit of interval for encoding</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.basis.ChebyshevIterator.flavor">
<span class="sig-name descname"><span class="pre">flavor</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'chebyshev'</span></em><a class="headerlink" href="#cofe.space.basis.ChebyshevIterator.flavor" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.basis.ChebyshevIterator.polyval">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">polyval</span></span><a class="headerlink" href="#cofe.space.basis.ChebyshevIterator.polyval" title="Permalink to this definition">#</a></dt>
<dd><p>Return numpy Chebyshev polynomial eval.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.basis.DiscreteBasis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DiscreteBasis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">site_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_functions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.DiscreteBasis" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>Abstract class to represent a basis set over a discrete finite domain.</p>
<p>In our case the domain is a site space which can take on values of the
allowed species.</p>
<p>Initialize a StandardBasis.</p>
<p>Currently also accepts an OrderedDict but if you find yourself
creating one like so for use in production and not debugging, know that
it will break MSONable methods in classes that use these, and at any
point, compatibility with OrderedDicts could be removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>site_space</strong> (<em>OrderedDict</em><em> or </em><a class="reference internal" href="#cofe.space.domain.SiteSpace" title="cofe.space.domain.SiteSpace"><em>SiteSpace</em></a>) – Dict representing site space (Specie, measure) or a SiteSpace
object.</p></li>
<li><p><strong>basis_functions</strong> (<a class="reference internal" href="#cofe.space.basis.BasisIterator" title="cofe.space.basis.BasisIterator"><em>BasisIterator</em></a>) – a BasisIterator for the nonconstant basis functions. Must take
the values of species in the site space as input.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.basis.DiscreteBasis.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#cofe.space.basis.DiscreteBasis.as_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Get MSONable dict representation of a DiscreteBasis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.basis.DiscreteBasis.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.DiscreteBasis.from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Create a DiscreteBasis from dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>d</strong> (<em>dict</em>) – MSONable dict representation</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A subclass of DiscreteBasis</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#cofe.space.basis.DiscreteBasis" title="cofe.space.basis.DiscreteBasis">DiscreteBasis</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.basis.DiscreteBasis.function_array">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">function_array</span></span><a class="headerlink" href="#cofe.space.basis.DiscreteBasis.function_array" title="Permalink to this definition">#</a></dt>
<dd><p>Get function array with site functions as rows.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.basis.DiscreteBasis.is_orthogonal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_orthogonal</span></span><a class="headerlink" href="#cofe.space.basis.DiscreteBasis.is_orthogonal" title="Permalink to this definition">#</a></dt>
<dd><p>Test if the basis is orthogonal.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.basis.DiscreteBasis.is_orthonormal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_orthonormal</span></span><a class="headerlink" href="#cofe.space.basis.DiscreteBasis.is_orthonormal" title="Permalink to this definition">#</a></dt>
<dd><p>Test if the basis is orthonormal.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.basis.DiscreteBasis.measure_array">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">measure_array</span></span><a class="headerlink" href="#cofe.space.basis.DiscreteBasis.measure_array" title="Permalink to this definition">#</a></dt>
<dd><p>Get diagonal array with site species measures.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.basis.DiscreteBasis.measure_vector">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">measure_vector</span></span><a class="headerlink" href="#cofe.space.basis.DiscreteBasis.measure_vector" title="Permalink to this definition">#</a></dt>
<dd><p>Get vector of site species measures.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.basis.DiscreteBasis.site_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">site_space</span></span><a class="headerlink" href="#cofe.space.basis.DiscreteBasis.site_space" title="Permalink to this definition">#</a></dt>
<dd><p>Get dict of the site probability space.</p>
<p>The site space refers to the probability space represented by the
allowed species and their respective probabilities (concentration)
over which the site functions are defined.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.basis.DiscreteBasis.species">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">species</span></span><a class="headerlink" href="#cofe.space.basis.DiscreteBasis.species" title="Permalink to this definition">#</a></dt>
<dd><p>Get list of allowed site species.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.basis.IndicatorBasis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IndicatorBasis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">site_space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.IndicatorBasis" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cofe.space.basis.DiscreteBasis" title="cofe.space.basis.DiscreteBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">cofe.space.basis.DiscreteBasis</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>Class that represents a full indicator basis for a site space.</p>
<p>This class represents the “trivial” indicator basis, wihch includes an
indicator function for every species in the site space, and does NOT
include a contant function.
NOT to be confused with a cluster indicator basis used for a Cluster
Expansion (that is represented in smol by a StandardBasis with an
IndicatorIterator).</p>
<p>&#64;lbluque takes full responsibility for the confusing terminology…</p>
<p>Initialize an indicator basis for given site space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>site_space</strong> (<em>OrderedDict</em><em> or </em><a class="reference internal" href="#cofe.space.domain.SiteSpace" title="cofe.space.domain.SiteSpace"><em>SiteSpace</em></a>) – dict representing site space (Specie, measure) or a SiteSpace
object.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.basis.IndicatorBasis.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.IndicatorBasis.from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Create a SiteSpace from dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>d</strong> (<em>dict</em>) – MSONable dict representation</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>StandardBasis</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.basis.IndicatorIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IndicatorIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.IndicatorIterator" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cofe.space.basis.BasisIterator" title="cofe.space.basis.BasisIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">cofe.space.basis.BasisIterator</span></code></a></p>
<p>Iterator for cluster indicator site basis functions.</p>
<p>The basis generated as defined is not orthogonal for any number of species.</p>
<p>Initialize a BasisIterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>species</strong> (<em>tuple</em>) – tuple of allowed species in site spaces</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.basis.IndicatorIterator.flavor">
<span class="sig-name descname"><span class="pre">flavor</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'indicator'</span></em><a class="headerlink" href="#cofe.space.basis.IndicatorIterator.flavor" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.basis.LegendreIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LegendreIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.LegendreIterator" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cofe.space.basis.NumpyPolyIterator" title="cofe.space.basis.NumpyPolyIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">cofe.space.basis.NumpyPolyIterator</span></code></a></p>
<p>Legendre polynomial basis set iterator.</p>
<p>Initialize a NumpyPolyIterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>species</strong> (<em>tuple</em>) – tuple of allowed species in site spaces</p></li>
<li><p><strong>low</strong> (<em>float</em>) – optional
lower limit of interval for encoding</p></li>
<li><p><strong>high</strong> (<em>float</em>) – optional
higher limit of interval for encoding</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.basis.LegendreIterator.flavor">
<span class="sig-name descname"><span class="pre">flavor</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'legendre'</span></em><a class="headerlink" href="#cofe.space.basis.LegendreIterator.flavor" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.basis.LegendreIterator.polyval">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">polyval</span></span><a class="headerlink" href="#cofe.space.basis.LegendreIterator.polyval" title="Permalink to this definition">#</a></dt>
<dd><p>Return numpy Legendre polynomial eval.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.basis.NumpyPolyIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NumpyPolyIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.NumpyPolyIterator" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cofe.space.basis.BasisIterator" title="cofe.space.basis.BasisIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">cofe.space.basis.BasisIterator</span></code></a></p>
<p>Class to quickly implement polynomial basis sets included in numpy.</p>
<p>Initialize a NumpyPolyIterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>species</strong> (<em>tuple</em>) – tuple of allowed species in site spaces</p></li>
<li><p><strong>low</strong> (<em>float</em>) – optional
lower limit of interval for encoding</p></li>
<li><p><strong>high</strong> (<em>float</em>) – optional
higher limit of interval for encoding</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.basis.NumpyPolyIterator.flavor">
<span class="sig-name descname"><span class="pre">flavor</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'numpy-poly'</span></em><a class="headerlink" href="#cofe.space.basis.NumpyPolyIterator.flavor" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.basis.NumpyPolyIterator.polyval">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">polyval</span></span><a class="headerlink" href="#cofe.space.basis.NumpyPolyIterator.polyval" title="Permalink to this definition">#</a></dt>
<dd><p>Return a numpy polyval function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.basis.PolynomialIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PolynomialIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.PolynomialIterator" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cofe.space.basis.NumpyPolyIterator" title="cofe.space.basis.NumpyPolyIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">cofe.space.basis.NumpyPolyIterator</span></code></a></p>
<p>A standard polynomial basis set iterator.</p>
<p>Initialize a NumpyPolyIterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>species</strong> (<em>tuple</em>) – tuple of allowed species in site spaces</p></li>
<li><p><strong>low</strong> (<em>float</em>) – optional
lower limit of interval for encoding</p></li>
<li><p><strong>high</strong> (<em>float</em>) – optional
higher limit of interval for encoding</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.basis.PolynomialIterator.flavor">
<span class="sig-name descname"><span class="pre">flavor</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'polynomial'</span></em><a class="headerlink" href="#cofe.space.basis.PolynomialIterator.flavor" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.basis.PolynomialIterator.polyval">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">polyval</span></span><a class="headerlink" href="#cofe.space.basis.PolynomialIterator.polyval" title="Permalink to this definition">#</a></dt>
<dd><p>Return numpy polynomial eval.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.basis.SinusoidIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SinusoidIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.SinusoidIterator" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cofe.space.basis.BasisIterator" title="cofe.space.basis.BasisIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">cofe.space.basis.BasisIterator</span></code></a></p>
<p>Iterator for sinusoid (trig basis) as proposed by A. van de Walle.</p>
<ol class="upperalpha simple">
<li><p>van de Walle, Calphad. 33, 266–278 (2009).</p></li>
</ol>
<p>This basis is properly orthogonal for any number of allowed species out of
the box, but it is not orthonormal for allowed species &gt; 2.</p>
<p>Initialize a SinusoidIterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>species</strong> (<em>tuple</em>) – tuple of allowed species in site spaces</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.basis.SinusoidIterator.flavor">
<span class="sig-name descname"><span class="pre">flavor</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sinusoid'</span></em><a class="headerlink" href="#cofe.space.basis.SinusoidIterator.flavor" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.basis.StandardBasis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">StandardBasis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">site_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_functions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.StandardBasis" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cofe.space.basis.DiscreteBasis" title="cofe.space.basis.DiscreteBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">cofe.space.basis.DiscreteBasis</span></code></a></p>
<p>Class that represents the basis for a site function space.</p>
<p>Note that all StandardBasis in theory have the first basis function
<span class="math notranslate nohighlight">\(\phi_0 = 1\)</span>, but this should not be defined since it is handled
implicitly when computing bit_combos using total no. species - 1 in the
Orbit class. As such a StandardBasis as implemented here represents a
Standard and/or Fourier site basis (the standard basis using indicator
functions is not a Fourier basis but can be used as a”cluster site
basis”).</p>
<p>The particular basis set is set by giving an iterable of basis functions.
See BasisIterator classes for details.</p>
<p>Initialize a StandardBasis.</p>
<p>Currently also accepts an OrderedDict but if you find yourself creating
one like so for use in production and not debugging, know that it will
break MSONable methods in classes that use these, and at any
point, compatibility with OrderedDicts could be removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>site_space</strong> (<em>OrderedDict</em><em> or </em><a class="reference internal" href="#cofe.space.domain.SiteSpace" title="cofe.space.domain.SiteSpace"><em>SiteSpace</em></a>) – Dict representing site space (Specie, measure) or a SiteSpace
object.</p></li>
<li><p><strong>basis_functions</strong> (<a class="reference internal" href="#cofe.space.basis.BasisIterator" title="cofe.space.basis.BasisIterator"><em>BasisIterator</em></a>) – a BasisIterator for the nonconstant basis functions. Must take
the values of species in the site space as input.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.basis.StandardBasis.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#cofe.space.basis.StandardBasis.as_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Get MSONable dict representation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.basis.StandardBasis.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.StandardBasis.from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Create a StandardBasis from dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>d</strong> (<em>dict</em>) – MSONable dict representation</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>StandardBasis</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.basis.StandardBasis.function_array">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">function_array</span></span><a class="headerlink" href="#cofe.space.basis.StandardBasis.function_array" title="Permalink to this definition">#</a></dt>
<dd><p>Get array with the non-constant site functions as rows.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.basis.StandardBasis.orthonormalization_array">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">orthonormalization_array</span></span><a class="headerlink" href="#cofe.space.basis.StandardBasis.orthonormalization_array" title="Permalink to this definition">#</a></dt>
<dd><p>Get R array from QR factorization.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.basis.StandardBasis.orthonormalize">
<span class="sig-name descname"><span class="pre">orthonormalize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.StandardBasis.orthonormalize" title="Permalink to this definition">#</a></dt>
<dd><p>Orthonormalizes basis function set based on initial basis set.</p>
<p>Functions are orthonormal w.r.t the measure given.
(Basis functions are also orthogonal to phi_0 = 1).</p>
<p>Modified GS-QR factorization of function array. (Here we are using
row vectors as opposed to the correct way of doing QR using columns.)
Due to how the func_arr is saved (rows are vectors/functions) this
allows us to not sprinkle so many transposes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.basis.StandardBasis.rotate">
<span class="sig-name descname"><span class="pre">rotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.StandardBasis.rotate" title="Permalink to this definition">#</a></dt>
<dd><p>Rotate basis functions about subspace spanned by two vectors.</p>
<p>This operation will rotate the two selected basis vectors about a
subspace spanned by them. This implies a rotation orthogonal to
all other basis vectors. This will keep any underlying orthogonality.</p>
<p>WARNING: this is only implemented for uniform site space measures, not
for non-uniform measures.</p>
<p>SECOND WARNING: I haven’t really thought through what happens if basis
vectors are not orthogonal to the constant (i.e. indicator basis); use
at your own peril with non-orthogonal basis sets.</p>
<p>THIRD WARNING: When rotating a binary space basis this will only
multiply by -1, regardless of the indices or angle provided. Think
about what it means to rotate in this case…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angle</strong> (<em>float</em>) – angle to rotate in radians</p></li>
<li><p><strong>index1</strong> (<em>int</em>) – index of first basis vector in function_array</p></li>
<li><p><strong>index2</strong> (<em>int</em>) – index of second basis vector in function_array</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cofe.space.basis.basis_factory">
<span class="sig-name descname"><span class="pre">basis_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basis_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.basis_factory" title="Permalink to this definition">#</a></dt>
<dd><p>Create a site basis for the given basis name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basis_name</strong> (<em>str</em>) – name of the basis.</p></li>
<li><p><strong>site_space</strong> (<em>Sequence</em><em> or </em><em>OrderedDict</em>) – SiteSpace over which the basis set is defined.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>StandardBasis</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cofe.space.basis.cos_f">
<span class="sig-name descname"><span class="pre">cos_f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.cos_f" title="Permalink to this definition">#</a></dt>
<dd><p>Return basis function for odd indices.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cofe.space.basis.encode_domain">
<span class="sig-name descname"><span class="pre">encode_domain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoding</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.encode_domain" title="Permalink to this definition">#</a></dt>
<dd><p>Decorate a function with an encoding for its domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>encoding</strong> (<em>dict</em>) – dictionary for encoding.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cofe.space.basis.indicator">
<span class="sig-name descname"><span class="pre">indicator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.indicator" title="Permalink to this definition">#</a></dt>
<dd><p>Singleton indicator function for elementary events.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cofe.space.basis.sin_f">
<span class="sig-name descname"><span class="pre">sin_f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.sin_f" title="Permalink to this definition">#</a></dt>
<dd><p>Return basis function for even indices.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cofe.space.basis.sinusoid_factory">
<span class="sig-name descname"><span class="pre">sinusoid_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis.sinusoid_factory" title="Permalink to this definition">#</a></dt>
<dd><p>Sine or cosine based on AVdW sinusoid site basis.</p>
</dd></dl>

</section>
<section id="module-cofe.space.cluster">
<span id="cofe-space-cluster-module"></span><h2>cofe.space.cluster module<a class="headerlink" href="#module-cofe.space.cluster" title="Permalink to this headline">#</a></h2>
<p>Implementation of the Cluster class.</p>
<p>Represents a group of sites of a given lattice. These are the building blocks
for a cluster basis of functions over configurational space.</p>
<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.cluster.Cluster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">site_spaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.cluster.Cluster" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.core.structure.SiteCollection</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>An undecorated (no occupancies) cluster.</p>
<p>Represented simply by a list of sites, its centroid, and the underlying
lattice.</p>
<p>You probably never need to instantiate this class directly. Look at
ClusterSubspace to create orbits and clusters necessary for a CE.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.cluster.Cluster.frac_coords">
<span class="sig-name descname"><span class="pre">frac_coords</span></span><a class="headerlink" href="#cofe.space.cluster.Cluster.frac_coords" title="Permalink to this definition">#</a></dt>
<dd><p>fractional coordinates of each site.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.cluster.Cluster.lattice">
<span class="sig-name descname"><span class="pre">lattice</span></span><a class="headerlink" href="#cofe.space.cluster.Cluster.lattice" title="Permalink to this definition">#</a></dt>
<dd><p>Underlying lattice of cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Lattice</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.cluster.Cluster.centroid">
<span class="sig-name descname"><span class="pre">centroid</span></span><a class="headerlink" href="#cofe.space.cluster.Cluster.centroid" title="Permalink to this definition">#</a></dt>
<dd><p>Geometric centroid of included sites.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.cluster.Cluster.id">
<span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#cofe.space.cluster.Cluster.id" title="Permalink to this definition">#</a></dt>
<dd><p>ID of cluster.
Used to identify the Cluster in a given ClusterSubspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>Initialize Cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>site_spaces</strong> (<em>list of SiteSpace</em>) – list of site spaces for the cluster</p></li>
<li><p><strong>frac_coords</strong> (<em>Sequence</em>) – Sequence of frac coords for the site spaces</p></li>
<li><p><strong>lattice</strong> (<em>Lattice</em>) – pymatgen Lattice object</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.cluster.Cluster.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.cluster.Cluster.as_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Get json-serialization dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>MSONable dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.cluster.Cluster.assign_ids">
<span class="sig-name descname"><span class="pre">assign_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.cluster.Cluster.assign_ids" title="Permalink to this definition">#</a></dt>
<dd><p>Recursively assign IDs to clusters after initialization.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">centroid</span></span><a class="headerlink" href="#id1" title="Permalink to this definition">#</a></dt>
<dd><p>Return the centroid of cluster.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.cluster.Cluster.diameter">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diameter</span></span><a class="headerlink" href="#cofe.space.cluster.Cluster.diameter" title="Permalink to this definition">#</a></dt>
<dd><p>Get maximum distance between any 2 sites in the cluster.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">frac_coords</span></span><a class="headerlink" href="#id2" title="Permalink to this definition">#</a></dt>
<dd><p>Return the fractional coordinates of cluster w.r.t the underlying lattice.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.cluster.Cluster.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.cluster.Cluster.from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Create a Cluster from serialized dict.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.cluster.Cluster.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.cluster.Cluster.from_file" title="Permalink to this definition">#</a></dt>
<dd><p>Read a cluster from a file. Supported formats are json and yaml only.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – The filename to read from.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Cluster</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.cluster.Cluster.from_sites">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_sites</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sites</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.cluster.Cluster.from_sites" title="Permalink to this definition">#</a></dt>
<dd><p>Create a cluster from a list of sites and lattice object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.cluster.Cluster.from_str">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_string</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.cluster.Cluster.from_str" title="Permalink to this definition">#</a></dt>
<dd><p>Read a cluster from a string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_string</strong> (<em>str</em>) – String to parse.</p></li>
<li><p><strong>fmt</strong> (<em>str</em>) – Format to output to. Defaults to JSON unless filename
is provided. If fmt is specifies, it overrides whatever the
filename is. Options include “yaml”, “json”. Non-case sensitive.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Cluster</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.cluster.Cluster.get_distance">
<span class="sig-name descname"><span class="pre">get_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#cofe.space.cluster.Cluster.get_distance" title="Permalink to this definition">#</a></dt>
<dd><p>Return distance between sites at index i and j.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – Index of first site</p></li>
<li><p><strong>j</strong> – Index of second site</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Distance between sites at index i and index j.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id3">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lattice</span></span><a class="headerlink" href="#id3" title="Permalink to this definition">#</a></dt>
<dd><p>Return the underlying lattice.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.cluster.Cluster.radius">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">radius</span></span><a class="headerlink" href="#cofe.space.cluster.Cluster.radius" title="Permalink to this definition">#</a></dt>
<dd><p>Get half the maximum distance between any 2 sites in the cluster.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.cluster.Cluster.sites">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sites</span></span><a class="headerlink" href="#cofe.space.cluster.Cluster.sites" title="Permalink to this definition">#</a></dt>
<dd><p>Return the list of sites.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.cluster.Cluster.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.cluster.Cluster.to" title="Permalink to this definition">#</a></dt>
<dd><p>Output the cluster  to a file or string.</p>
<p>this is basically a watered down version of pymatgen.Molecule.to</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fmt</strong> (<em>str</em>) – <p>Format to output to. Defaults to JSON unless filename
is provided. If fmt is specifies, it overrides whatever the
filename is. Options include “yaml” and “json” only.</p>
<blockquote>
<div><p>Non-case sensitive.</p>
</div></blockquote>
</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – If provided, output will be written to a file. If
fmt is not specified, the format is determined from the
filename. Defaults is None, i.e. string output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(str) if filename is None. None otherwise.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-cofe.space.clusterspace">
<span id="cofe-space-clusterspace-module"></span><h2>cofe.space.clusterspace module<a class="headerlink" href="#module-cofe.space.clusterspace" title="Permalink to this headline">#</a></h2>
<p>Implementation of ClusterSubspace and related PottsSubspace classes.</p>
<p>The ClusterSubspace class is the workhorse for generating the objects and
information necessary for a cluster expansion.</p>
<p>The PottsSubspace class is an (experimental) class that is similar, but
diverges from the CE mathematic formalism.</p>
<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ClusterSubspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expansion_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symops</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell_matcher</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_matcher</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">matcher_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>ClusterSubspace represents a subspace of functions of configuration.</p>
<p>A <a class="reference internal" href="#cofe.space.clusterspace.ClusterSubspace" title="cofe.space.clusterspace.ClusterSubspace"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterSubspace</span></code></a> is the main work horse used in constructing a
cluster expansion. It is necessary to define the terms to be included in a
cluster expansion. A cluster subspace holds a finite set of orbits that
contain symmetrically equivalent clusters. The orbits also contain the set
of orbit basis functions (also known as correlation functions) that
represent the terms in the cluster expansion. Taken together the set of all
orbit functions for all orbits included span a subspace of the total
function space over the configurational space of a given crystal structure
system.</p>
<p>The <a class="reference internal" href="#cofe.space.clusterspace.ClusterSubspace" title="cofe.space.clusterspace.ClusterSubspace"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterSubspace</span></code></a> also has methods to match fitting structures
and determine site mappings for supercells of different sizes in order to
compute correlation vectors (i.e. evaluate the orbit functions for a given
structure).</p>
<p>You probably want to generate from <code class="code docutils literal notranslate"><span class="pre">ClusterSubspace.from_cutoffs</span></code>,
which will auto-generate the orbits from diameter cutoffs.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.symops">
<span class="sig-name descname"><span class="pre">symops</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.symops" title="Permalink to this definition">#</a></dt>
<dd><p>Symmetry operations of structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of SymmOp</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.num_corr_functions">
<span class="sig-name descname"><span class="pre">num_corr_functions</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.num_corr_functions" title="Permalink to this definition">#</a></dt>
<dd><p>Total number of correlation functions (orbit basis functions)
included in the subspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.num_orbits">
<span class="sig-name descname"><span class="pre">num_orbits</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.num_orbits" title="Permalink to this definition">#</a></dt>
<dd><p>Total number of crystallographic orbits included in the subspace.
This includes the empty orbit.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.num_clusters">
<span class="sig-name descname"><span class="pre">num_clusters</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.num_clusters" title="Permalink to this definition">#</a></dt>
<dd><p>Total number of clusters in the primitive cell that are included
in the subspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>Initialize a ClusterSubspace.</p>
<p>You rarely will need to create a ClusterSubspace using the main
constructor.
Look at the class method <code class="code docutils literal notranslate"><span class="pre">from_cutoffs</span></code> for the “better” way to
instantiate a ClusterSubspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – Structure to define the cluster space. Typically the primitive
cell. Includes all species regardless of partial occupation.</p></li>
<li><p><strong>expansion_structure</strong> (<em>Structure</em>) – Structure including only sites that will be included in the
Cluster space (i.e. only those with partial occupancy)</p></li>
<li><p><strong>symops</strong> (<em>list of Symmop</em>) – list of Symmops for the given structure.</p></li>
<li><p><strong>orbits</strong> (<em>dict</em>) – {size: list of Orbits}
Dictionary with size (number of sites) as keys and list of
Orbits as values.</p></li>
<li><p><strong>supercell_matcher</strong> (<em>StructureMatcher</em>) – optional
StructureMatcher used to find supercell matrices
relating the prim structure to other structures. If you pass
this directly you should know how to set the matcher up,
otherwise matching your relaxed structures can fail, alot.</p></li>
<li><p><strong>site_matcher</strong> (<em>StructureMatcher</em>) – optional
StructureMatcher used to find site mappings
relating the sites of a given structure to an appropriate
supercell of the prim structure . If you pass this directly you
should know how to set the matcher up, otherwise matching your
relaxed structures can fail, alot.</p></li>
<li><p><strong>matcher_kwargs</strong> – ltol, stol, angle_tol, supercell_size: parameters to pass
through to the StructureMatchers. Structures that don’t match
to the primitive cell under these tolerances won’t be included
in the expansion. Easiest option for supercell_size is usually
to use a species that has a constant amount per formula unit.
See pymatgen documentation of <code class="xref py py-class docutils literal notranslate"><span class="pre">StructureMatcher</span></code> for
more details.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.add_external_term">
<span class="sig-name descname"><span class="pre">add_external_term</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">term</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.add_external_term" title="Permalink to this definition">#</a></dt>
<dd><p>Add an external term to the ClusterSubspace.</p>
<p>Adds an external term (e.g. an Ewald term) to the cluster expansion
terms. External term classes must be MSONable and implement a method
to obtain a “correlation”. See smol.cofe.extern for notebooks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>term</strong> (<em>ExternalTerm</em>) – An instance of an external term. Currently only EwaldTerm is
implemented.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.as_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Json-serialization dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>MSONable dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.basis_orthogonal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">basis_orthogonal</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.basis_orthogonal" title="Permalink to this definition">#</a></dt>
<dd><p>Check if the orbit basis is orthogonal.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.basis_orthonormal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">basis_orthonormal</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.basis_orthonormal" title="Permalink to this definition">#</a></dt>
<dd><p>Check if the orbit basis is orthonormal.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.basis_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">basis_type</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.basis_type" title="Permalink to this definition">#</a></dt>
<dd><p>Get the type of site basis set used.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.change_site_bases">
<span class="sig-name descname"><span class="pre">change_site_bases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orthonormal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.change_site_bases" title="Permalink to this definition">#</a></dt>
<dd><p>Change the type of site basis used in the site basis functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_basis</strong> (<em>str</em>) – name of new basis for all site bases</p></li>
<li><p><strong>orthonormal</strong> (<em>bool</em>) – option to orthonormalize all new site basis sets</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.copy" title="Permalink to this definition">#</a></dt>
<dd><p>Deep copy of instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.corr_from_structure">
<span class="sig-name descname"><span class="pre">corr_from_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scmatrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.corr_from_structure" title="Permalink to this definition">#</a></dt>
<dd><p>Get correlation vector for structure.</p>
<p>Returns the correlation vector for a given structure. To do this, the
correct supercell matrix of the prim needs to be found to then
determine the mappings between sites to create the occupancy
string and also determine the orbit mappings to evaluate the
corresponding cluster functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – Structure to compute correlation from</p></li>
<li><p><strong>normalized</strong> (<em>bool</em>) – return the correlation vector normalized by the prim cell size.
In theory correlation vectors are always normalized, but
getting them without normalization allows to compute the
“extensive” values.</p></li>
<li><p><strong>scmatrix</strong> (<em>ndarray</em>) – optional
supercell matrix relating the prim structure to the given
structure. Passing this if it has already been matched will
make things much quicker. You are responsible that the
supercell matrix is correct.</p></li>
<li><p><strong>site_mapping</strong> (<em>list</em>) – optional
Site mapping as obtained by
<code class="code docutils literal notranslate"><span class="pre">StructureMatcher.get_mapping</span></code>
such that the elements of site_mapping represent the indices
of the matching sites to the prim structure. If you pass this
option, you are fully responsible that the mappings are correct!</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>correlation vector for given structure</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.cutoffs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cutoffs</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.cutoffs" title="Permalink to this definition">#</a></dt>
<dd><p>Return dict of orbit cluster cutoffs.</p>
<p>These are “tight” cutoffs, as in the maximum diameter for each cluster
size, which is &lt;= the input to from_cutoffs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.expansion_structure">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">expansion_structure</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.expansion_structure" title="Permalink to this definition">#</a></dt>
<dd><p>Get the primitive expansion structure (excludes inactive sites).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.external_terms">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">external_terms</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.external_terms" title="Permalink to this definition">#</a></dt>
<dd><p>Get external terms to be fitted together with the correlations.</p>
<p>External terms are those represented by pair interaction Hamiltonians
(i.e. Ewald electrostatics).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.from_cutoffs">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_cutoffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'indicator'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orthonormal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_concentration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell_matcher</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_matcher</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">matcher_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.from_cutoffs" title="Permalink to this definition">#</a></dt>
<dd><p>Create a ClusterSubspace from diameter cutoffs.</p>
<p>Creates a <a class="reference internal" href="#cofe.space.clusterspace.ClusterSubspace" title="cofe.space.clusterspace.ClusterSubspace"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterSubspace</span></code></a> with orbits of the given size and
diameter smaller than or equal to the given value. The diameter of an
orbit is the maximum distance between any two sites of a cluster of
that orbit.</p>
<p>This is the best (and the only easy) way to create a
<a class="reference internal" href="#cofe.space.clusterspace.ClusterSubspace" title="cofe.space.clusterspace.ClusterSubspace"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterSubspace</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – disordered structure to build a cluster expansion for.
Typically the primitive cell</p></li>
<li><p><strong>cutoffs</strong> (<em>dict</em>) – dict of {cluster_size: diameter cutoff}. Cutoffs should be
strictly decreasing. Typically something like {2:5, 3:4}.
The empty orbit is always included. Singlets are by default
included, with the exception below.
To obtain a subspace with only an empty and singlet terms use
an empty dict {}, or {1: 1}. Adding a cutoff term for point
terms, i.e. {1: 0} is useful to exclude point terms. Any other
value for the cutoff will simply be ignored.</p></li>
<li><p><strong>basis</strong> (<em>str</em>) – a string specifying the site basis functions</p></li>
<li><p><strong>orthonormal</strong> (<em>bool</em>) – whether to enforce an orthonormal basis. From the current
available bases only the indicator basis is not orthogonal out
of the box</p></li>
<li><p><strong>use_concentration</strong> (<em>bool</em>) – if True, the concentrations in the prim structure sites will be
used to orthormalize site bases. This gives gives a cluster
subspace centered about the prim composition.</p></li>
<li><p><strong>supercell_matcher</strong> (<em>StructureMatcher</em>) – optional
StructureMatcher used to find supercell matrices
relating the prim structure to other structures. If you pass
this directly you should know how to set the matcher up,
otherwise matching your relaxed structures will fail, alot.</p></li>
<li><p><strong>site_matcher</strong> (<em>StructureMatcher</em>) – optional
StructureMatcher used to find site mappings
relating the sites of a given structure to an appropriate
supercell of the prim structure . If you pass this directly you
should know how to set the matcher up, otherwise matching your
relaxed structures will fail, alot.</p></li>
<li><p><strong>matcher_kwargs</strong> – ltol, stol, angle_tol, supercell_size: parameters to pass
through to the StructureMatchers. Structures that don’t match
to the primitive cell under these tolerances won’t be included
in the expansion. Easiest option for supercell_size is usually
to use a species that has a constant amount per formula unit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ClusterSubspace</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Create ClusterSubspace from an MSONable dict.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.function_hierarchy">
<span class="sig-name descname"><span class="pre">function_hierarchy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.function_hierarchy" title="Permalink to this definition">#</a></dt>
<dd><p>Get the correlation function hierarchy.</p>
<p>The function hierarchy is the relationship between specific correlation
functions and “sub” correlation functions (i.e. a correlation function is
a “sub” correlation factor or included in higher degree correlation function if
it is a factor of a higher degree correlation function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> (<em>int</em>) – optional
how many levels down to look for suborbits. If all suborbits
are needed make level large enough or set to None.</p></li>
<li><p><strong>min_size</strong> (<em>int</em>) – optional
minimum size of clusters in sub orbits to include</p></li>
<li><p><strong>invert</strong> (<em>bool</em>) – optional
Default is invert=False which gives the high to low bit combo
hierarchy. Invert= True will invert the hierarchy into low to
high</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>each element of the inner lists is the bit id for
all correlation functions corresponding to the corr function at the given
outer list index.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.function_inds_by_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">function_inds_by_size</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.function_inds_by_size" title="Permalink to this definition">#</a></dt>
<dd><p>Get correlation function indices by cluster sizes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.function_inds_from_cutoffs">
<span class="sig-name descname"><span class="pre">function_inds_from_cutoffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">upper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.function_inds_from_cutoffs" title="Permalink to this definition">#</a></dt>
<dd><p>Get indices of correlation functions by cluster cutoffs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>upper</strong> (<em>float</em><em> or </em><em>dict</em>) – upper diameter for clusters to include. If a single float
is given then that cutoff is used for all orbit sizes.
Otherwise a dict can be used to specify the cutoff for the
orbit cluster sizes,
i.e. {2: cutoff_pairs, 3: cutoff_trips, …}</p></li>
<li><p><strong>lower</strong> (<em>float</em>) – optional
lower diameter for clusters to include. If a single float
is given then that cutoff is used for all orbit sizes.
Otherwise a dict can be used to specify the cutoff for the
orbit cluster sizes,
i.e. {2: cutoff_pairs, 3: cutoff_trips, …}</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of correlation function indices for clusters within cutoffs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.function_orbit_ids">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">function_orbit_ids</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.function_orbit_ids" title="Permalink to this definition">#</a></dt>
<dd><p>Get Orbit IDs corresponding to each correlation function.</p>
<p>If the ClusterSubspace includes external terms, these are not included
in the list since they are not associated with any orbit.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.function_ordering_multiplicities">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">function_ordering_multiplicities</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.function_ordering_multiplicities" title="Permalink to this definition">#</a></dt>
<dd><p>Get array of ordering multiplicity of each correlation function.</p>
<p>The length of the array returned is the total number of correlation
functions in the subspace for all orbits. The ordering multiplicity of
a correlation function is the number of symmetrically equivalent bit
orderings (function-labeled orbit configurations) that result in the
product of the same single site functions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.function_total_multiplicities">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">function_total_multiplicities</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.function_total_multiplicities" title="Permalink to this definition">#</a></dt>
<dd><p>Get array of total multiplicity of each correlation function.</p>
<p>The length of the array returned is the total number of correlation
functions in the subspace for all orbits. The total multiplicity of a
correlation function is the number of symmetrically equivalent bit
orderings (or function-labeled orbit configurations) that result in the
product of the same single site functions times the (crystallographic)
multiplicity of the orbit.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.gen_orbit_list">
<span class="sig-name descname"><span class="pre">gen_orbit_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scmatrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.gen_orbit_list" title="Permalink to this definition">#</a></dt>
<dd><p>Generate list of data to compute correlation vectors.</p>
<p>List includes orbit bit ids, flat correlation tensors and their indices,
and array of cluster indices for supercell corresponding to given
supercell matrix.</p>
<p>This is a helper function for the correlation vector computation and most
often called internally.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scmatrix</strong> (<em>ndarray</em>) – supercell matrix.</p>
</dd>
</dl>
<dl class="simple">
<dt>Returns: list of tuples</dt><dd><p>[(orbit bit ids, tensor  indices, flat corr tensors, cluster indices)]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.get_aliased_orbits">
<span class="sig-name descname"><span class="pre">get_aliased_orbits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sc_matrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.get_aliased_orbits" title="Permalink to this definition">#</a></dt>
<dd><p>Get the aliased orbits for a given supercell shape.</p>
<p>Detect the orbits that will be aliased due to translational symmetry imposed by
the supercell lattice. Orbits i and j are aliased when a geometric cluster in
orbit i is identically mapped to another geometric cluster in orbit j.
It can be shown through a group theoretical argument that any cluster in orbit i
then must be identical to a corresponding cluster in orbit j.</p>
<p>The implication of aliasing is that correlation functions of these orbits will
evaluate to the same value, leading to feature matrix rank deficiency and
potentially unphysical ECI.</p>
<p>This method will detect most cases of orbit degeneracy, but not some edge cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sc_matrix</strong> – (array):
array relating a supercell with the primitive matrix</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(orbit_id i, orbit_id j, …) list of tuples containing the orbits
that are aliased.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.get_sub_function_ids">
<span class="sig-name descname"><span class="pre">get_sub_function_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.get_sub_function_ids" title="Permalink to this definition">#</a></dt>
<dd><p>Get the bit combo ids of all sub correlation functions.</p>
<p>A sub correlation function of a given correlation function means that
the sub correlation function is a factor of the correlation function
(with the additional requirement of acting over the sites in sub
clusters of the clusters over which the given corr function acts on).</p>
<p>In other words, think of it as an orbit of function-labeled subclusters
of a given orbit of function-labeled clusters…a mouthful…</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_id</strong> (<em>int</em>) – id of orbit to get sub orbit id for</p></li>
<li><p><strong>level</strong> (<em>int</em>) – optional
how many levels down to look for suborbits. If all suborbits
are needed make level large enough or set to None.</p></li>
<li><p><strong>min_size</strong> (<em>int</em>) – optional
minimum size of clusters in sub orbits to include</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list containing ids of sub correlation functions</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of ints</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.get_sub_orbits">
<span class="sig-name descname"><span class="pre">get_sub_orbits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbit_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.get_sub_orbits" title="Permalink to this definition">#</a></dt>
<dd><p>Get sub orbits of the orbit for the corresponding orbit_id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orbit_id</strong> (<em>int</em>) – id of orbit to get sub orbit id for</p></li>
<li><p><strong>level</strong> (<em>int</em>) – optional
how many levels down to look for suborbits. If all suborbits
are needed make level large enough or set to None.</p></li>
<li><p><strong>min_size</strong> (<em>int</em>) – optional
minimum size of clusters in sub orbits to include</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list containing ids of suborbits</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of ints</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.num_functions_per_orbit">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_functions_per_orbit</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.num_functions_per_orbit" title="Permalink to this definition">#</a></dt>
<dd><p>Get the number of correlation functions for each orbit.</p>
<p>The list returned has length equal to the total number of orbits,
and each entry is the total number of correlation functions
associated with that orbit.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.num_prims_from_matrix">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_prims_from_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scmatrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.num_prims_from_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Get number of prim structures in a supercell for a given matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.occupancy_from_structure">
<span class="sig-name descname"><span class="pre">occupancy_from_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scmatrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.occupancy_from_structure" title="Permalink to this definition">#</a></dt>
<dd><p>Occupancy string for a given structure.</p>
<p>Returns a list of occupancies of each site in the structure in the
appropriate order set implicitly by the supercell matrix that is found.</p>
<p>This function is used as input to compute correlation vectors for the
given structure.</p>
<p>This function is also useful to obtain an initial occupancy for a Monte
Carlo simulation. (Make sure that the same supercell matrix is being
used here as in the instance of the processor class for the simulation.
Although it is recommended to use the similar function in Processor
classes.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – structure to obtain a occupancy string for</p></li>
<li><p><strong>scmatrix</strong> (<em>array</em>) – optional
supercell matrix relating the given structure and the
primitive structure. If you pass the supercell, you fully are
responsible that it is the correct one! This prevents running
the _scmatcher (supercell structure matcher)</p></li>
<li><p><strong>site_mapping</strong> (<em>list</em>) – optional
site mapping as obtained by StructureMatcher.get_mapping
such that the elements of site_mapping represent the indices
of the matching sites to the prim structure. If you pass this
option, you are fully responsible that the mappings are correct!
This prevents running _site_matcher to get the mappings.</p></li>
<li><p><strong>encode</strong> (<em>bool</em>) – optional
if True, the occupancy string will have the index of the species
in the expansion structure site spaces, rather than the
species itself.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>occupancy string for structure.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.orbit_hierarchy">
<span class="sig-name descname"><span class="pre">orbit_hierarchy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.orbit_hierarchy" title="Permalink to this definition">#</a></dt>
<dd><p>Get orbit hierarchy by IDs.</p>
<p>The orbit hierarchy represents in inclusion relationships between orbits and
their suborbits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> (<em>int</em>) – optional
how many levels down to look for suborbits. If all suborbits
are needed make level large enough or set to None.</p></li>
<li><p><strong>min_size</strong> (<em>int</em>) – optional
minimum size of clusters in sub orbits to include</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>each element of the inner lists is the orbit id for
all suborbits corresponding to the orbit at the given outer list
index.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.orbit_multiplicities">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">orbit_multiplicities</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.orbit_multiplicities" title="Permalink to this definition">#</a></dt>
<dd><p>Get the crystallographic multiplicities for each orbit.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.orbits">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">orbits</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.orbits" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of all orbits sorted by size.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.orbits_by_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">orbits_by_size</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.orbits_by_size" title="Permalink to this definition">#</a></dt>
<dd><p>Get dictionary of orbits with key being the orbit size.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.orbits_from_cutoffs">
<span class="sig-name descname"><span class="pre">orbits_from_cutoffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">upper</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.orbits_from_cutoffs" title="Permalink to this definition">#</a></dt>
<dd><p>Get orbits with clusters within given diameter cutoffs (inclusive).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>upper</strong> (<em>float</em><em> or </em><em>dict</em>) – upper diameter for clusters to include. If a single float
is given then that cutoff is used for all orbit sizes.
Otherwise a dict can be used to specify the cutoff for the
orbit cluster sizes,
i.e. {2: pair_cutoff, 3: triplet_cutoff, …}</p></li>
<li><p><strong>lower</strong> (<em>float</em>) – optional
lower diameter for clusters to include. If a single float
is given then that cutoff is used for all orbit sizes.
Otherwise a dict can be used to specify the cutoff for the
orbit cluster sizes,
i.e. {2: pair_cutoff, 3: triplet_cutoff, …}</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of Orbits</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.refine_structure">
<span class="sig-name descname"><span class="pre">refine_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scmatrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.refine_structure" title="Permalink to this definition">#</a></dt>
<dd><p>Refine a (relaxed) structure.</p>
<p>Refine a (relaxed) structure to a perfect supercell structure of the
the prim structure (aka the corresponding “unrelaxed” structure).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – structure to refine to a perfect multiple of the prim</p></li>
<li><p><strong>scmatrix</strong> (<em>ndarray</em>) – optional
supercell matrix relating the prim structure to the given
structure. Passing this if it has already been matched will
make things much quicker. You are responsible for correctness.</p></li>
<li><p><strong>site_mapping</strong> (<em>list</em>) – optional
site mapping as obtained by StructureMatcher.get_mapping
such that the elements of site_mapping represent the indices
of the matching sites to the prim structure. Again you are
responsible.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the refined structure</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Structure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.remove_corr_functions">
<span class="sig-name descname"><span class="pre">remove_corr_functions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_ids</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.remove_corr_functions" title="Permalink to this definition">#</a></dt>
<dd><p>Remove correlation functions by their ID’s.</p>
<p>This allows more granular removal of terms involved in fitting/evaluating a
cluster expansion. Similar to remove_orbits this is useful to prune a cluster
expansion and actually allows to remove a single term (ie one with small
associated coefficient/ECI).</p>
<p>This procedure is perfectly well posed mathematically. The resultant
CE is still a valid function of configurations with all the necessary
symmetries from the underlying structure. It is also practically justified
if we allow “in group” orbit eci sparsity…which everyone in the field
does anyway. In terms of physical/chemical interpretation it is not
obvious what it means to remove certain combinations of an n-body
interaction term, and not the whole term itself…so tread lighlty with your
model interpretations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>corr_ids</strong> (<em>list</em>) – list of correlation function ids to remove</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.remove_orbits">
<span class="sig-name descname"><span class="pre">remove_orbits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbit_ids</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.remove_orbits" title="Permalink to this definition">#</a></dt>
<dd><p>Remove whole orbits by their ids.</p>
<p>Removes orbits from cluster spaces. It is helpful to print a
ClusterSubspace or ClusterExpansion to obtain orbit ids. After removing
orbits, orbit ID’s and orbit bit ID’s are re-assigned.</p>
<p>This is useful to prune a ClusterExpansion by removing orbits with
small associated coefficients or ECI. Note that this will remove a full
orbit, which for the case of sites with only two species is the same as
removing a single correlation vector element (only one ECI). For cases
with sites having more than 2 species allowed per site there is more
than one orbit functions (for all the possible bit orderings or function-
labeled orbit configurations) and removing an orbit will remove more than
one element in the correlation vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>orbit_ids</strong> (<em>list</em>) – list of orbit ids to be removed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.scmatrix_from_structure">
<span class="sig-name descname"><span class="pre">scmatrix_from_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.scmatrix_from_structure" title="Permalink to this definition">#</a></dt>
<dd><p>Get supercell matrix from a given structure.</p>
<p>Obtain the supercell structure matrix to convert the prim structure
to a supercell equivalent to given structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>structure</strong> (<em>Structure</em>) – a pymatgen Structure.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>matrix relating given structure and prim structure.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.structure">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">structure</span></span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.structure" title="Permalink to this definition">#</a></dt>
<dd><p>Get the underlying primitive structure including inactive sites.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.structure_site_mapping">
<span class="sig-name descname"><span class="pre">structure_site_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">supercell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.structure_site_mapping" title="Permalink to this definition">#</a></dt>
<dd><p>Get structure site mapping.</p>
<p>Returns the mapping between sites in the given structure and a prim
supercell of the corresponding size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>supercell</strong> (<em>Structure</em>) – supercell of prim structure with same size as other structure.</p></li>
<li><p><strong>structure</strong> (<em>Structure</em>) – Structure to obtain site mappings to supercell of prim</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>site mappings of structure to supercell</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.ClusterSubspace.supercell_orbit_mappings">
<span class="sig-name descname"><span class="pre">supercell_orbit_mappings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scmatrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.ClusterSubspace.supercell_orbit_mappings" title="Permalink to this definition">#</a></dt>
<dd><p>Get orbit mappings for a structure from supercell of prim.</p>
<p>Return the orbit mappings for a specific supercell of the prim
structure represented by the given matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scmatrix</strong> (<em>array</em>) – array relating a supercell with the primitive matrix</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(orbit, indices) list of tuples with orbits and the
site indices for all equivalent orbits in a supercell obtained
from the given matrix.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.clusterspace.PottsSubspace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PottsSubspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expansion_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symops</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">without_last_cluster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell_matcher</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_matcher</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">matcher_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.PottsSubspace" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cofe.space.clusterspace.ClusterSubspace" title="cofe.space.clusterspace.ClusterSubspace"><code class="xref py py-class docutils literal notranslate"><span class="pre">cofe.space.clusterspace.ClusterSubspace</span></code></a></p>
<p>PottsSubspace represents a subspace of functions using only indicator functions.</p>
<p>A PottsSubspace is a related model to a standard ClusterSubspace used to build
a standard cluster expansion. The only difference is that the single site functions
for any orbit are only made up of indicator functions (and there is no constant
function). As such it is more closely related to a generalized Ising model or better
yet an extension of the q-state Potts Model (hence the name).</p>
<p>The orbit functions in a PottsSubspace represent the concentrations of all possible
decorations (species occupancies) of clusters in the given orbit. Similar to a
ClusterSubspace with site indicator basis functions. But in contrast, the Potts
subspace includes the concentration of all possible decorations (minus 1).</p>
<p>Although quite similar to a ClusterSubspace, there is no mathematical
formalism guaranteeing that the orbit basis functions generated in a
PottsSubspace are a linear independent set spanning configuration space.
Actually if all orbits up to any size (or infinite size) are included,
the corresponding orbit function set is an overcomplete/ highly redundant.</p>
<p>A PottsSubspace can be created directly with a ClusterSubspace object
by using the constructor and providing the appropriately constructed orbits,
but that is a bit more painful that just using the class method here.</p>
<p>Initialize a PottsSubspace.</p>
<p>You rarely will need to create a ClusterSubspace using the main
constructor.
Look at the class method <code class="code docutils literal notranslate"><span class="pre">from_cutoffs</span></code> for the “better” way to
instantiate a ClusterSubspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – Structure to define the cluster space. Typically the primitive
cell. Includes all species regardless of partial occupation.</p></li>
<li><p><strong>expansion_structure</strong> (<em>Structure</em>) – Structure including only sites that will be included in the
Cluster space. (only those with partial occupancy)</p></li>
<li><p><strong>symops</strong> (<em>list of Symmop</em>) – list of Symmops for the given structure.</p></li>
<li><p><strong>orbits</strong> (<em>dict</em>) – {size: list of Orbits}
Dictionary with size (number of sites) as keys and list of
Orbits as values.</p></li>
<li><p><strong>without_last_cluster</strong> (<em>bool</em>) – optional
whether last cluster labeling is removed from each orbit.</p></li>
<li><p><strong>supercell_matcher</strong> (<em>StructureMatcher</em>) – (optional)
StructureMatcher used to find supercell matrices
relating the prim structure to other structures. If you pass
this directly you should know how to set the matcher up,
otherwise matching your relaxed structures can fail, alot.</p></li>
<li><p><strong>site_matcher</strong> (<em>StructureMatcher</em>) – (optional)
StructureMatcher used to find site mappings
relating the sites of a given structure to an appropriate
supercell of the prim structure . If you pass this directly you
should know how to set the matcher up, otherwise matching your
relaxed structures can fail, alot.</p></li>
<li><p><strong>matcher_kwargs</strong> – ltol, stol, angle_tol, supercell_size: parameters to pass
through to the StructureMatchers. Structures that don’t match
to the primitive cell under these tolerances won’t be included
in the expansion. Easiest option for supercell_size is usually
to use a species that has a constant amount per formula unit.
See pymatgen documentation of <code class="xref py py-class docutils literal notranslate"><span class="pre">StructureMatcher</span></code> for
more details.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.PottsSubspace.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.PottsSubspace.as_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Json-serialization dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>MSONable dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.PottsSubspace.from_cutoffs">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_cutoffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_last_cluster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell_matcher</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_matcher</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">matcher_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.PottsSubspace.from_cutoffs" title="Permalink to this definition">#</a></dt>
<dd><p>Create a PottsSubspace from diameter cutoffs.</p>
<p>Creates a <a class="reference internal" href="#cofe.space.clusterspace.PottsSubspace" title="cofe.space.clusterspace.PottsSubspace"><code class="xref py py-class docutils literal notranslate"><span class="pre">PottsSubspace</span></code></a> with orbits of the given size and
diameter smaller than or equal to the given value. The diameter of an
orbit is the maximum distance between any two sites of a cluster of
that orbit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – disordered structure to build a cluster expansion for.
Typically the primitive cell</p></li>
<li><p><strong>cutoffs</strong> (<em>dict</em>) – dict of {cluster_size: diameter cutoff}. Cutoffs should be
strictly decreasing. Typically something like {2:5, 3:4}.
The empty orbit is always included. Singlets are by default
included, with the exception below.
To obtain a subspace with only an empty and singlet terms use
an empty dict {}, or {1: 1}. Adding a cutoff term for point
terms, i.e. {1: None} is useful to exclude point terms, any other
value for the cutoff will simply be ignored.</p></li>
<li><p><strong>remove_last_cluster</strong> (<em>bool</em>) – optional
if True, will remove the last cluster labeling (decoration)
from each orbit. Since sum of corr for all labelings = 1,
removing the last is similar to working in concentration space.</p></li>
<li><p><strong>supercell_matcher</strong> (<em>StructureMatcher</em>) – (optional)
StructureMatcher used to find supercell matrices
relating the prim structure to other structures. If you pass
this directly you should know how to set the matcher up,
otherwise matching your relaxed structures will fail, alot.</p></li>
<li><p><strong>site_matcher</strong> (<em>StructureMatcher</em>) – (optional)
StructureMatcher used to find site mappings
relating the sites of a given structure to an appropriate
supercell of the prim structure . If you pass this directly you
should know how to set the matcher up, otherwise matching your
relaxed structures will fail, alot.</p></li>
<li><p><strong>matcher_kwargs</strong> – ltol, stol, angle_tol, supercell_size: parameters to pass
through to the StructureMatchers. Structures that don’t match
to the primitive cell under these tolerances won’t be included
in the expansion. Easiest option for supercell_size is usually
to use a species that has a constant amount per formula unit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PottsSubSpace</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.PottsSubspace.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.PottsSubspace.from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Create ClusterSubspace from an MSONable dict.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.PottsSubspace.get_function_decoration">
<span class="sig-name descname"><span class="pre">get_function_decoration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.PottsSubspace.get_function_decoration" title="Permalink to this definition">#</a></dt>
<dd><p>Get the decoration/labeling of a specific orbit function.</p>
<p>When using an indicator site basis there is 1 to 1 equivalence between
correlation functions and species decorations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em>) – index of orbit function in correlation vector</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of tuples of symmetrically equivalent
Species/Elements.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.clusterspace.PottsSubspace.get_orbit_decorations">
<span class="sig-name descname"><span class="pre">get_orbit_decorations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbit_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.PottsSubspace.get_orbit_decorations" title="Permalink to this definition">#</a></dt>
<dd><p>Get all decorations/labellings of species in an orbit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>orbit_id</strong> (<em>int</em>) – ID of orbit</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of lists of symmetrically equivalent
Species/Elements.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cofe.space.clusterspace.get_complete_mapping">
<span class="sig-name descname"><span class="pre">get_complete_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mapping</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.get_complete_mapping" title="Permalink to this definition">#</a></dt>
<dd><p>Get a complete mapping from a 1 level mapping.</p>
<p>If we allow transferability between mapping linkages, there would be
a full mapping containing all linkages at all connectivity level.
Using this function, you can get a full mapping from an incomplete
mapping.</p>
<p>NOTE: Since complete hierarchy is not very useful for actual CE fit, we
will not include it as an attribute of ClusterSubspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mapping</strong> (<em>list of lists</em>) – List of sublists, each contains integer indices, indicating
a foward mapping from the current sublist index to the indices
in the sublist.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Full mapping table containing forward mapping, but with
all connectivity levels. Same format as input</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of lists</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cofe.space.clusterspace.invert_mapping">
<span class="sig-name descname"><span class="pre">invert_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mapping</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.clusterspace.invert_mapping" title="Permalink to this definition">#</a></dt>
<dd><p>Invert a mapping table from forward to backward, vice versa.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mapping</strong> (<em>list of lists</em>) – List of sublists, each contains integer indices, indicating
a foward mapping from the current sublist index to the indices
in the sublist.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Inverted mapping table containing backward mapping.
Same format as input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>lists of lists</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cofe.space.constants">
<span id="cofe-space-constants-module"></span><h2>cofe.space.constants module<a class="headerlink" href="#module-cofe.space.constants" title="Permalink to this headline">#</a></h2>
<p>Definitions of global constants used in cofe.space module.</p>
</section>
<section id="module-cofe.space.domain">
<span id="cofe-space-domain-module"></span><h2>cofe.space.domain module<a class="headerlink" href="#module-cofe.space.domain" title="Permalink to this headline">#</a></h2>
<p>Implementation of SiteSpace and functions to get spaces and allowed species.</p>
<p>Implementation functions to generate lists of site spaces and allowed species
for a given disordered strucuture.</p>
<p>A site space is made up of the allowed species and their concentrations
including special species such as vacancies. A site spaces makes up the domain
of a site function and many site spaces make up the space of configurations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.domain.SiteSpace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SiteSpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">composition</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.domain.SiteSpace" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Mapping</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Hashable</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>Represents a site space.</p>
<p>A site spaces is a set of allowed species at a site and their corresponding
measure (composition in the disordered state).</p>
<p>This class is somewhat similar to pymatgen Composition. However a SiteSpace
must always have a total composition = 1 since vacancies are explicitly
included as species. A sorted order of the included species is also kept to
ensure a consistent encoding when creating basis functions. Vacancies are
always the last species. Key errors are raised for species not in the
site space.</p>
<p>Initialize a site space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>composition</strong> (<em>Composition</em>) – Composition object that specifies the site space.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.domain.SiteSpace.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#cofe.space.domain.SiteSpace.as_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Get MSONable dict representation.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.domain.SiteSpace.codes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">codes</span></span><a class="headerlink" href="#cofe.space.domain.SiteSpace.codes" title="Permalink to this definition">#</a></dt>
<dd><p>Return range of species.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.domain.SiteSpace.composition">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">composition</span></span><a class="headerlink" href="#cofe.space.domain.SiteSpace.composition" title="Permalink to this definition">#</a></dt>
<dd><p>Return the underlying composition.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.domain.SiteSpace.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.domain.SiteSpace.from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Create a SiteSpace from dict representation.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.domain.Vacancy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Vacancy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'A'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oxidation_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.domain.Vacancy" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.core.periodic_table.DummySpecie</span></code></p>
<p>Wrapper class around DummySpecie to treat vacancies as their own species.</p>
<p>Initialize a Vacancy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>symbol</strong> (<em>str</em>) – an assigned symbol for the vacancy. Strict
rules are applied to the choice of the symbol. The vacancy
symbol cannot have any part of first two letters that will
constitute an Element symbol. Otherwise, a composition may
be parsed wrongly. E.g., “X” is fine, but “Vac” is not
because Vac contains V, a valid Element.</p></li>
<li><p><strong>oxidation_state</strong> (<em>float</em>) – oxidation state for Vacancy. More like
the charge of a point defect. Defaults to zero.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cofe.space.domain.get_allowed_species">
<span class="sig-name descname"><span class="pre">get_allowed_species</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.domain.get_allowed_species" title="Permalink to this definition">#</a></dt>
<dd><p>Get the allowed species for each site in a disordered structure.</p>
<p>This will get all the allowed species for each site in a pymatgen structure.
If the site composition does not add to 1, a Vacancy will be appended to
the allowed species at that site.</p>
<p>Same as in a site space, the order of the allowed species at each site is
important because that implicitly represents the code that will be used
when evaluating site basis functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>structure</strong> (<em>Structure</em>) – Structure to determine site spaces from. At least some sites should
be disordered, otherwise there is no point in using this.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of allowed Species for each site</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of Specie</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cofe.space.domain.get_site_spaces">
<span class="sig-name descname"><span class="pre">get_site_spaces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_measure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.domain.get_site_spaces" title="Permalink to this definition">#</a></dt>
<dd><p>Get site spaces for each site in a disordered structure.</p>
<p>Method to obtain the single site spaces for the sites in a structure.
The single site spaces are represented by the allowed species for each site
and the measure/concentration for disordered sites. The order is important so
the species need to be sorted, since that implicitly sets the code/index
used to evaluate basis functions.</p>
<p>Vacancies are included in sites where the site element composition does not
sum to 1 (i.e. the total occupation is not 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – Structure to determine site spaces from. At least some sites should
be disordered, otherwise there is no point in using this.</p></li>
<li><p><strong>include_measure</strong> (<em>bool</em>) – optional
if True, will take the site compositions as the site space measure,
otherwise a uniform measure is assumed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Allowed species and their corresponding measure.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#cofe.space.domain.SiteSpace" title="cofe.space.domain.SiteSpace">SiteSpace</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cofe.space.domain.get_species">
<span class="sig-name descname"><span class="pre">get_species</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.domain.get_species" title="Permalink to this definition">#</a></dt>
<dd><p>Get specie object.</p>
<p>Wraps pymatgen.core.periodic_table.get_el_sp to be able to catch and
return Vacancies when needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obj</strong> (<em>Element/Specie/str/int</em>) – an arbitrary object.  Supported objects
are actual Element/Specie objects, integers (representing atomic
numbers) or strings (element symbols or species strings).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Specie, Element or Vacancy, with a bias for the maximum number of
properties that can be determined.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError if obj cannot be converted into an Element</strong><strong> or </strong><strong>Specie.</strong> – </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cofe.space.orbit">
<span id="cofe-space-orbit-module"></span><h2>cofe.space.orbit module<a class="headerlink" href="#module-cofe.space.orbit" title="Permalink to this headline">#</a></h2>
<p>Implementation of an Orbit.</p>
<p>A set of symmetrically equivalent (with respect to the given random structure
symmetry) clusters.</p>
<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Orbit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_bases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_symops</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.orbit.Orbit" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>Orbit set of symmetrically equivalent clusters.</p>
<p>An Orbit represents a set of clusters that are symmetrically equivalent
in the random structure. The class also includes the possible orderings on
the clusters in the orbit. The different orderings represent the single
site function indices to generate all possible orbit functions (correlation
functions) for the given orbit.</p>
<p>An orbit usually includes translational and structure symmetry of the
underlying lattice. But this is not a hard requirement, and any set of
symmetry operations can be passed to the constructor. Regardless, an orbit
should at a minimum have translational symmetry.</p>
<p>You probably never need to instantiate this class directly. Look at
ClusterSubspace to create orbits and clusters necessary for a CE.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.bits">
<span class="sig-name descname"><span class="pre">bits</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.bits" title="Permalink to this definition">#</a></dt>
<dd><p>List of lists describing the possible non-constant site function
indices at each site of a cluster in the orbit.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.site_bases">
<span class="sig-name descname"><span class="pre">site_bases</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.site_bases" title="Permalink to this definition">#</a></dt>
<dd><p>List of the SiteBasis for each site.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of DiscreteBasis</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.structure_symops">
<span class="sig-name descname"><span class="pre">structure_symops</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.structure_symops" title="Permalink to this definition">#</a></dt>
<dd><p>List of underlying structure symmetry operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of Symmops</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.lattice">
<span class="sig-name descname"><span class="pre">lattice</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.lattice" title="Permalink to this definition">#</a></dt>
<dd><p>Underlying Structure’s lattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Lattice</p>
</dd>
</dl>
</dd></dl>

<p>Initialize an Orbit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster_coords</strong> (<em>list</em><em> or </em><em>ndarray</em>) – list of frac coords for the sites in base cluster.</p></li>
<li><p><strong>lattice</strong> (<em>pymatgen.Lattice</em>) – a Lattice object for the given sites</p></li>
<li><p><strong>bits</strong> (<em>list of list</em>) – list describing the possible site function indices for
each site in cluster. Should be the number of possible
occupancies minus one. For a 3 site cluster, each of which
can have one of Li, TM, or Vac, bits are [[0, 1], [0, 1], [0, 1]]
This is ensures the expansion is not “over-complete” by
implicitly enforcing that all sites have a site basis function
phi_0 = 1.</p></li>
<li><p><strong>site_bases</strong> (<em>list of DiscreteBasis</em>) – list of SiteBasis objects for each site in the given sites.</p></li>
<li><p><strong>structure_symops</strong> (<em>list of SymmOp</em>) – list of symmetry operations for the base structure</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.orbit.Orbit.as_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Get Json-serialization dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>MSONable dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.assign_ids">
<span class="sig-name descname"><span class="pre">assign_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbit_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbit_bit_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_cluster_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.orbit.Orbit.assign_ids" title="Permalink to this definition">#</a></dt>
<dd><p>Assign unique orbit and cluster ID’s.</p>
<p>This should be called iteratively for a list of orbits to get a proper
set of unique ID’s for the orbits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orbit_id</strong> (<em>int</em>) – orbit id</p></li>
<li><p><strong>orbit_bit_id</strong> (<em>int</em>) – starting bit ordering id</p></li>
<li><p><strong>start_cluster_id</strong> (<em>int</em>) – starting cluster id</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>next orbit id, next bit ordering id, next cluster id</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(int, int, int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.basis_arrays">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">basis_arrays</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.basis_arrays" title="Permalink to this definition">#</a></dt>
<dd><p>Get a tuple of all site function arrays for each site in orbit.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.basis_orthogonal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">basis_orthogonal</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.basis_orthogonal" title="Permalink to this definition">#</a></dt>
<dd><p>Test if the Orbit bases are orthogonal.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.basis_orthonormal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">basis_orthonormal</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.basis_orthonormal" title="Permalink to this definition">#</a></dt>
<dd><p>Test if the orbit bases are orthonormal.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.basis_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">basis_type</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.basis_type" title="Permalink to this definition">#</a></dt>
<dd><p>Return the name of basis set used.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.bit_combo_multiplicities">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bit_combo_multiplicities</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.bit_combo_multiplicities" title="Permalink to this definition">#</a></dt>
<dd><p>Get the multiplicities of the symmetrically distinct bit ordering.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.bit_combos">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bit_combos</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.bit_combos" title="Permalink to this definition">#</a></dt>
<dd><p>Get tuple of contracted multi-indeces for site function ordering.</p>
<p>tuple of ndarrays, each array is a set of symmetrically equivalent bit
orderings represented by each row. Bit combos represent non-constant site
function orderings.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.cluster_permutations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cluster_permutations</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.cluster_permutations" title="Permalink to this definition">#</a></dt>
<dd><p>Get the symmetrical site permutations that map a cluster to itself.</p>
<p>A permutation is a mapping such that for a give symop in cluster_symops
Symop.operate(sites) = sites[mapping] (after translation back to unit
cell)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.cluster_symops">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cluster_symops</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.cluster_symops" title="Permalink to this definition">#</a></dt>
<dd><p>Get symmetry operations that map a cluster to its periodic image.</p>
<p>Each element is a pymatgen.core.operations.Symop.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.clusters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">clusters</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.clusters" title="Permalink to this definition">#</a></dt>
<dd><p>Get symmetrically equivalent clusters.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.correlation_tensors">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">correlation_tensors</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.correlation_tensors" title="Permalink to this definition">#</a></dt>
<dd><p>Get the array of correlation functions for all possible configs.</p>
<p>Array of stacked correlation arrays for each symetrically distinct
set of bit combos, i.e a correlation function.</p>
<p>The correlations array is a multidimensional array with each dimension
corresponding to each site space.</p>
<p>First dimension is for bit_combos, and the remaining dimensions correspond
to site spaces.</p>
<p>i.e. correlation_tensors[0, 1, 0, 2] gives the value of the
correlation function for bit_combo 0 evaluated for a cluster with
occupancy [1, 0, 2]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.flat_correlation_tensors">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flat_correlation_tensors</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.flat_correlation_tensors" title="Permalink to this definition">#</a></dt>
<dd><p>Get correlation_tensors flattened to 2D for fast cython.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.flat_tensor_indices">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flat_tensor_indices</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.flat_tensor_indices" title="Permalink to this definition">#</a></dt>
<dd><p>Index multipliers to read data easier from flat corr tensors.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.orbit.Orbit.from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Create Orbit from serialized MSONable dict.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.is_sub_orbit">
<span class="sig-name descname"><span class="pre">is_sub_orbit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.orbit.Orbit.is_sub_orbit" title="Permalink to this definition">#</a></dt>
<dd><p>Check if given orbits clusters are subclusters.</p>
<p>Note this does not consider bit_combos</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>orbit</strong> (<a class="reference internal" href="#cofe.space.orbit.Orbit" title="cofe.space.orbit.Orbit"><em>Orbit</em></a>) – Orbit object to check if its clusters are subclusters</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if the clusters of given orbit are subclusters.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.multiplicity">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">multiplicity</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.multiplicity" title="Permalink to this definition">#</a></dt>
<dd><p>Get number of clusters in orbit per normilizing unit cell.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.remove_bit_combo">
<span class="sig-name descname"><span class="pre">remove_bit_combo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bits</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.orbit.Orbit.remove_bit_combo" title="Permalink to this definition">#</a></dt>
<dd><p>Remove bit_combos from orbit.</p>
<p>Only a single set of bits in the bit combo (symmetrically equivalent bit
orderings) needs to be passed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.remove_bit_combos_by_inds">
<span class="sig-name descname"><span class="pre">remove_bit_combos_by_inds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.orbit.Orbit.remove_bit_combos_by_inds" title="Permalink to this definition">#</a></dt>
<dd><p>Remove bit combos by their indices in the bit_combo list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.reset_bases">
<span class="sig-name descname"><span class="pre">reset_bases</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.orbit.Orbit.reset_bases" title="Permalink to this definition">#</a></dt>
<dd><p>Reset cached basis function array and correlation tensors.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.rotation_array">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rotation_array</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.rotation_array" title="Permalink to this definition">#</a></dt>
<dd><p>Get the rotation array.</p>
<p>The rotation array is of size len(bit combos) x len(bit combos)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.site_spaces">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">site_spaces</span></span><a class="headerlink" href="#cofe.space.orbit.Orbit.site_spaces" title="Permalink to this definition">#</a></dt>
<dd><p>Get the site spaces for the site basis associated with each site.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.sub_orbit_mappings">
<span class="sig-name descname"><span class="pre">sub_orbit_mappings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.orbit.Orbit.sub_orbit_mappings" title="Permalink to this definition">#</a></dt>
<dd><p>Return a mapping of cluster sites in the orbit to cluster sites in sub orbit.</p>
<p>If the given orbit is not a sub-orbit will return an empty list.
Note this works for mapping between sites, sites spaces, and basis
functions associated with each site.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>orbit</strong> (<a class="reference internal" href="#cofe.space.orbit.Orbit" title="cofe.space.orbit.Orbit"><em>Orbit</em></a>) – A sub orbit to return mapping of sites</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of indices such that
self.base_cluster.sites[indices] = orbit.base_cluster.sites</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.orbit.Orbit.transform_site_bases">
<span class="sig-name descname"><span class="pre">transform_site_bases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basis_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orthonormal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.orbit.Orbit.transform_site_bases" title="Permalink to this definition">#</a></dt>
<dd><p>Transform the Orbits site bases into new basis set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basis_name</strong> (<em>str</em>) – name of new basis for all site bases</p></li>
<li><p><strong>orthonormal</strong> (<em>bool</em>) – option to orthonormalize all new site bases</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-cofe.space">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-cofe.space" title="Permalink to this headline">#</a></h2>
<p>Classes to define subspaces of functions over crystalline configurations.</p>
<p>Contains classes and functions necessary to represent the configurational space
of a crystalline system and the space of functions over it.</p>
<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.Cluster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">site_spaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Cluster" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.core.structure.SiteCollection</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>An undecorated (no occupancies) cluster.</p>
<p>Represented simply by a list of sites, its centroid, and the underlying
lattice.</p>
<p>You probably never need to instantiate this class directly. Look at
ClusterSubspace to create orbits and clusters necessary for a CE.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.Cluster.frac_coords">
<span class="sig-name descname"><span class="pre">frac_coords</span></span><a class="headerlink" href="#cofe.space.Cluster.frac_coords" title="Permalink to this definition">#</a></dt>
<dd><p>fractional coordinates of each site.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.Cluster.lattice">
<span class="sig-name descname"><span class="pre">lattice</span></span><a class="headerlink" href="#cofe.space.Cluster.lattice" title="Permalink to this definition">#</a></dt>
<dd><p>Underlying lattice of cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Lattice</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.Cluster.centroid">
<span class="sig-name descname"><span class="pre">centroid</span></span><a class="headerlink" href="#cofe.space.Cluster.centroid" title="Permalink to this definition">#</a></dt>
<dd><p>Geometric centroid of included sites.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.Cluster.id">
<span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#cofe.space.Cluster.id" title="Permalink to this definition">#</a></dt>
<dd><p>ID of cluster.
Used to identify the Cluster in a given ClusterSubspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>Initialize Cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>site_spaces</strong> (<em>list of SiteSpace</em>) – list of site spaces for the cluster</p></li>
<li><p><strong>frac_coords</strong> (<em>Sequence</em>) – Sequence of frac coords for the site spaces</p></li>
<li><p><strong>lattice</strong> (<em>Lattice</em>) – pymatgen Lattice object</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.Cluster.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Cluster.as_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Get json-serialization dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>MSONable dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.Cluster.assign_ids">
<span class="sig-name descname"><span class="pre">assign_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Cluster.assign_ids" title="Permalink to this definition">#</a></dt>
<dd><p>Recursively assign IDs to clusters after initialization.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id4">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">centroid</span></span><a class="headerlink" href="#id4" title="Permalink to this definition">#</a></dt>
<dd><p>Return the centroid of cluster.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Cluster.diameter">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diameter</span></span><a class="headerlink" href="#cofe.space.Cluster.diameter" title="Permalink to this definition">#</a></dt>
<dd><p>Get maximum distance between any 2 sites in the cluster.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id5">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">frac_coords</span></span><a class="headerlink" href="#id5" title="Permalink to this definition">#</a></dt>
<dd><p>Return the fractional coordinates of cluster w.r.t the underlying lattice.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.Cluster.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Cluster.from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Create a Cluster from serialized dict.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.Cluster.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Cluster.from_file" title="Permalink to this definition">#</a></dt>
<dd><p>Read a cluster from a file. Supported formats are json and yaml only.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – The filename to read from.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Cluster</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.Cluster.from_sites">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_sites</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sites</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Cluster.from_sites" title="Permalink to this definition">#</a></dt>
<dd><p>Create a cluster from a list of sites and lattice object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.Cluster.from_str">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_string</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Cluster.from_str" title="Permalink to this definition">#</a></dt>
<dd><p>Read a cluster from a string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_string</strong> (<em>str</em>) – String to parse.</p></li>
<li><p><strong>fmt</strong> (<em>str</em>) – Format to output to. Defaults to JSON unless filename
is provided. If fmt is specifies, it overrides whatever the
filename is. Options include “yaml”, “json”. Non-case sensitive.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Cluster</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.Cluster.get_distance">
<span class="sig-name descname"><span class="pre">get_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#cofe.space.Cluster.get_distance" title="Permalink to this definition">#</a></dt>
<dd><p>Return distance between sites at index i and j.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – Index of first site</p></li>
<li><p><strong>j</strong> – Index of second site</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Distance between sites at index i and index j.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id6">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lattice</span></span><a class="headerlink" href="#id6" title="Permalink to this definition">#</a></dt>
<dd><p>Return the underlying lattice.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Cluster.radius">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">radius</span></span><a class="headerlink" href="#cofe.space.Cluster.radius" title="Permalink to this definition">#</a></dt>
<dd><p>Get half the maximum distance between any 2 sites in the cluster.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Cluster.sites">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sites</span></span><a class="headerlink" href="#cofe.space.Cluster.sites" title="Permalink to this definition">#</a></dt>
<dd><p>Return the list of sites.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.Cluster.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Cluster.to" title="Permalink to this definition">#</a></dt>
<dd><p>Output the cluster  to a file or string.</p>
<p>this is basically a watered down version of pymatgen.Molecule.to</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fmt</strong> (<em>str</em>) – <p>Format to output to. Defaults to JSON unless filename
is provided. If fmt is specifies, it overrides whatever the
filename is. Options include “yaml” and “json” only.</p>
<blockquote>
<div><p>Non-case sensitive.</p>
</div></blockquote>
</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – If provided, output will be written to a file. If
fmt is not specified, the format is determined from the
filename. Defaults is None, i.e. string output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(str) if filename is None. None otherwise.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.Orbit">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Orbit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_bases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_symops</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Orbit" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>Orbit set of symmetrically equivalent clusters.</p>
<p>An Orbit represents a set of clusters that are symmetrically equivalent
in the random structure. The class also includes the possible orderings on
the clusters in the orbit. The different orderings represent the single
site function indices to generate all possible orbit functions (correlation
functions) for the given orbit.</p>
<p>An orbit usually includes translational and structure symmetry of the
underlying lattice. But this is not a hard requirement, and any set of
symmetry operations can be passed to the constructor. Regardless, an orbit
should at a minimum have translational symmetry.</p>
<p>You probably never need to instantiate this class directly. Look at
ClusterSubspace to create orbits and clusters necessary for a CE.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.Orbit.bits">
<span class="sig-name descname"><span class="pre">bits</span></span><a class="headerlink" href="#cofe.space.Orbit.bits" title="Permalink to this definition">#</a></dt>
<dd><p>List of lists describing the possible non-constant site function
indices at each site of a cluster in the orbit.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.Orbit.site_bases">
<span class="sig-name descname"><span class="pre">site_bases</span></span><a class="headerlink" href="#cofe.space.Orbit.site_bases" title="Permalink to this definition">#</a></dt>
<dd><p>List of the SiteBasis for each site.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of DiscreteBasis</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.Orbit.structure_symops">
<span class="sig-name descname"><span class="pre">structure_symops</span></span><a class="headerlink" href="#cofe.space.Orbit.structure_symops" title="Permalink to this definition">#</a></dt>
<dd><p>List of underlying structure symmetry operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of Symmops</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cofe.space.Orbit.lattice">
<span class="sig-name descname"><span class="pre">lattice</span></span><a class="headerlink" href="#cofe.space.Orbit.lattice" title="Permalink to this definition">#</a></dt>
<dd><p>Underlying Structure’s lattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Lattice</p>
</dd>
</dl>
</dd></dl>

<p>Initialize an Orbit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster_coords</strong> (<em>list</em><em> or </em><em>ndarray</em>) – list of frac coords for the sites in base cluster.</p></li>
<li><p><strong>lattice</strong> (<em>pymatgen.Lattice</em>) – a Lattice object for the given sites</p></li>
<li><p><strong>bits</strong> (<em>list of list</em>) – list describing the possible site function indices for
each site in cluster. Should be the number of possible
occupancies minus one. For a 3 site cluster, each of which
can have one of Li, TM, or Vac, bits are [[0, 1], [0, 1], [0, 1]]
This is ensures the expansion is not “over-complete” by
implicitly enforcing that all sites have a site basis function
phi_0 = 1.</p></li>
<li><p><strong>site_bases</strong> (<em>list of DiscreteBasis</em>) – list of SiteBasis objects for each site in the given sites.</p></li>
<li><p><strong>structure_symops</strong> (<em>list of SymmOp</em>) – list of symmetry operations for the base structure</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.Orbit.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Orbit.as_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Get Json-serialization dict representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>MSONable dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.Orbit.assign_ids">
<span class="sig-name descname"><span class="pre">assign_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbit_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbit_bit_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_cluster_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Orbit.assign_ids" title="Permalink to this definition">#</a></dt>
<dd><p>Assign unique orbit and cluster ID’s.</p>
<p>This should be called iteratively for a list of orbits to get a proper
set of unique ID’s for the orbits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orbit_id</strong> (<em>int</em>) – orbit id</p></li>
<li><p><strong>orbit_bit_id</strong> (<em>int</em>) – starting bit ordering id</p></li>
<li><p><strong>start_cluster_id</strong> (<em>int</em>) – starting cluster id</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>next orbit id, next bit ordering id, next cluster id</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(int, int, int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Orbit.basis_arrays">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">basis_arrays</span></span><a class="headerlink" href="#cofe.space.Orbit.basis_arrays" title="Permalink to this definition">#</a></dt>
<dd><p>Get a tuple of all site function arrays for each site in orbit.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Orbit.basis_orthogonal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">basis_orthogonal</span></span><a class="headerlink" href="#cofe.space.Orbit.basis_orthogonal" title="Permalink to this definition">#</a></dt>
<dd><p>Test if the Orbit bases are orthogonal.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Orbit.basis_orthonormal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">basis_orthonormal</span></span><a class="headerlink" href="#cofe.space.Orbit.basis_orthonormal" title="Permalink to this definition">#</a></dt>
<dd><p>Test if the orbit bases are orthonormal.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Orbit.basis_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">basis_type</span></span><a class="headerlink" href="#cofe.space.Orbit.basis_type" title="Permalink to this definition">#</a></dt>
<dd><p>Return the name of basis set used.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Orbit.bit_combo_multiplicities">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bit_combo_multiplicities</span></span><a class="headerlink" href="#cofe.space.Orbit.bit_combo_multiplicities" title="Permalink to this definition">#</a></dt>
<dd><p>Get the multiplicities of the symmetrically distinct bit ordering.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Orbit.bit_combos">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bit_combos</span></span><a class="headerlink" href="#cofe.space.Orbit.bit_combos" title="Permalink to this definition">#</a></dt>
<dd><p>Get tuple of contracted multi-indeces for site function ordering.</p>
<p>tuple of ndarrays, each array is a set of symmetrically equivalent bit
orderings represented by each row. Bit combos represent non-constant site
function orderings.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Orbit.cluster_permutations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cluster_permutations</span></span><a class="headerlink" href="#cofe.space.Orbit.cluster_permutations" title="Permalink to this definition">#</a></dt>
<dd><p>Get the symmetrical site permutations that map a cluster to itself.</p>
<p>A permutation is a mapping such that for a give symop in cluster_symops
Symop.operate(sites) = sites[mapping] (after translation back to unit
cell)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Orbit.cluster_symops">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cluster_symops</span></span><a class="headerlink" href="#cofe.space.Orbit.cluster_symops" title="Permalink to this definition">#</a></dt>
<dd><p>Get symmetry operations that map a cluster to its periodic image.</p>
<p>Each element is a pymatgen.core.operations.Symop.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Orbit.clusters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">clusters</span></span><a class="headerlink" href="#cofe.space.Orbit.clusters" title="Permalink to this definition">#</a></dt>
<dd><p>Get symmetrically equivalent clusters.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Orbit.correlation_tensors">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">correlation_tensors</span></span><a class="headerlink" href="#cofe.space.Orbit.correlation_tensors" title="Permalink to this definition">#</a></dt>
<dd><p>Get the array of correlation functions for all possible configs.</p>
<p>Array of stacked correlation arrays for each symetrically distinct
set of bit combos, i.e a correlation function.</p>
<p>The correlations array is a multidimensional array with each dimension
corresponding to each site space.</p>
<p>First dimension is for bit_combos, and the remaining dimensions correspond
to site spaces.</p>
<p>i.e. correlation_tensors[0, 1, 0, 2] gives the value of the
correlation function for bit_combo 0 evaluated for a cluster with
occupancy [1, 0, 2]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Orbit.flat_correlation_tensors">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flat_correlation_tensors</span></span><a class="headerlink" href="#cofe.space.Orbit.flat_correlation_tensors" title="Permalink to this definition">#</a></dt>
<dd><p>Get correlation_tensors flattened to 2D for fast cython.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Orbit.flat_tensor_indices">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flat_tensor_indices</span></span><a class="headerlink" href="#cofe.space.Orbit.flat_tensor_indices" title="Permalink to this definition">#</a></dt>
<dd><p>Index multipliers to read data easier from flat corr tensors.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.Orbit.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Orbit.from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Create Orbit from serialized MSONable dict.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.Orbit.is_sub_orbit">
<span class="sig-name descname"><span class="pre">is_sub_orbit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Orbit.is_sub_orbit" title="Permalink to this definition">#</a></dt>
<dd><p>Check if given orbits clusters are subclusters.</p>
<p>Note this does not consider bit_combos</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>orbit</strong> (<a class="reference internal" href="#cofe.space.Orbit" title="cofe.space.Orbit"><em>Orbit</em></a>) – Orbit object to check if its clusters are subclusters</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if the clusters of given orbit are subclusters.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Orbit.multiplicity">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">multiplicity</span></span><a class="headerlink" href="#cofe.space.Orbit.multiplicity" title="Permalink to this definition">#</a></dt>
<dd><p>Get number of clusters in orbit per normilizing unit cell.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.Orbit.remove_bit_combo">
<span class="sig-name descname"><span class="pre">remove_bit_combo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bits</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Orbit.remove_bit_combo" title="Permalink to this definition">#</a></dt>
<dd><p>Remove bit_combos from orbit.</p>
<p>Only a single set of bits in the bit combo (symmetrically equivalent bit
orderings) needs to be passed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.Orbit.remove_bit_combos_by_inds">
<span class="sig-name descname"><span class="pre">remove_bit_combos_by_inds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Orbit.remove_bit_combos_by_inds" title="Permalink to this definition">#</a></dt>
<dd><p>Remove bit combos by their indices in the bit_combo list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.Orbit.reset_bases">
<span class="sig-name descname"><span class="pre">reset_bases</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Orbit.reset_bases" title="Permalink to this definition">#</a></dt>
<dd><p>Reset cached basis function array and correlation tensors.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Orbit.rotation_array">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rotation_array</span></span><a class="headerlink" href="#cofe.space.Orbit.rotation_array" title="Permalink to this definition">#</a></dt>
<dd><p>Get the rotation array.</p>
<p>The rotation array is of size len(bit combos) x len(bit combos)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cofe.space.Orbit.site_spaces">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">site_spaces</span></span><a class="headerlink" href="#cofe.space.Orbit.site_spaces" title="Permalink to this definition">#</a></dt>
<dd><p>Get the site spaces for the site basis associated with each site.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.Orbit.sub_orbit_mappings">
<span class="sig-name descname"><span class="pre">sub_orbit_mappings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Orbit.sub_orbit_mappings" title="Permalink to this definition">#</a></dt>
<dd><p>Return a mapping of cluster sites in the orbit to cluster sites in sub orbit.</p>
<p>If the given orbit is not a sub-orbit will return an empty list.
Note this works for mapping between sites, sites spaces, and basis
functions associated with each site.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>orbit</strong> (<a class="reference internal" href="#cofe.space.Orbit" title="cofe.space.Orbit"><em>Orbit</em></a>) – A sub orbit to return mapping of sites</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of indices such that
self.base_cluster.sites[indices] = orbit.base_cluster.sites</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cofe.space.Orbit.transform_site_bases">
<span class="sig-name descname"><span class="pre">transform_site_bases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basis_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orthonormal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Orbit.transform_site_bases" title="Permalink to this definition">#</a></dt>
<dd><p>Transform the Orbits site bases into new basis set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basis_name</strong> (<em>str</em>) – name of new basis for all site bases</p></li>
<li><p><strong>orthonormal</strong> (<em>bool</em>) – option to orthonormalize all new site bases</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cofe.space.Vacancy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Vacancy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'A'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oxidation_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.Vacancy" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pymatgen.core.periodic_table.DummySpecie</span></code></p>
<p>Wrapper class around DummySpecie to treat vacancies as their own species.</p>
<p>Initialize a Vacancy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>symbol</strong> (<em>str</em>) – an assigned symbol for the vacancy. Strict
rules are applied to the choice of the symbol. The vacancy
symbol cannot have any part of first two letters that will
constitute an Element symbol. Otherwise, a composition may
be parsed wrongly. E.g., “X” is fine, but “Vac” is not
because Vac contains V, a valid Element.</p></li>
<li><p><strong>oxidation_state</strong> (<em>float</em>) – oxidation state for Vacancy. More like
the charge of a point defect. Defaults to zero.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cofe.space.basis_factory">
<span class="sig-name descname"><span class="pre">basis_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basis_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.basis_factory" title="Permalink to this definition">#</a></dt>
<dd><p>Create a site basis for the given basis name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basis_name</strong> (<em>str</em>) – name of the basis.</p></li>
<li><p><strong>site_space</strong> (<em>Sequence</em><em> or </em><em>OrderedDict</em>) – SiteSpace over which the basis set is defined.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>StandardBasis</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cofe.space.get_allowed_species">
<span class="sig-name descname"><span class="pre">get_allowed_species</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.get_allowed_species" title="Permalink to this definition">#</a></dt>
<dd><p>Get the allowed species for each site in a disordered structure.</p>
<p>This will get all the allowed species for each site in a pymatgen structure.
If the site composition does not add to 1, a Vacancy will be appended to
the allowed species at that site.</p>
<p>Same as in a site space, the order of the allowed species at each site is
important because that implicitly represents the code that will be used
when evaluating site basis functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>structure</strong> (<em>Structure</em>) – Structure to determine site spaces from. At least some sites should
be disordered, otherwise there is no point in using this.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of allowed Species for each site</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of Specie</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cofe.space.get_site_spaces">
<span class="sig-name descname"><span class="pre">get_site_spaces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_measure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.get_site_spaces" title="Permalink to this definition">#</a></dt>
<dd><p>Get site spaces for each site in a disordered structure.</p>
<p>Method to obtain the single site spaces for the sites in a structure.
The single site spaces are represented by the allowed species for each site
and the measure/concentration for disordered sites. The order is important so
the species need to be sorted, since that implicitly sets the code/index
used to evaluate basis functions.</p>
<p>Vacancies are included in sites where the site element composition does not
sum to 1 (i.e. the total occupation is not 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – Structure to determine site spaces from. At least some sites should
be disordered, otherwise there is no point in using this.</p></li>
<li><p><strong>include_measure</strong> (<em>bool</em>) – optional
if True, will take the site compositions as the site space measure,
otherwise a uniform measure is assumed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Allowed species and their corresponding measure.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#cofe.space.domain.SiteSpace" title="cofe.space.domain.SiteSpace">SiteSpace</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cofe.space.get_species">
<span class="sig-name descname"><span class="pre">get_species</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cofe.space.get_species" title="Permalink to this definition">#</a></dt>
<dd><p>Get specie object.</p>
<p>Wraps pymatgen.core.periodic_table.get_el_sp to be able to catch and
return Vacancies when needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obj</strong> (<em>Element/Specie/str/int</em>) – an arbitrary object.  Supported objects
are actual Element/Specie objects, integers (representing atomic
numbers) or strings (element symbols or species strings).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Specie, Element or Vacancy, with a bias for the maximum number of
properties that can be determined.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError if obj cannot be converted into an Element</strong><strong> or </strong><strong>Specie.</strong> – </p>
</dd>
</dl>
</dd></dl>

</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022-2022, Ceder Group.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>